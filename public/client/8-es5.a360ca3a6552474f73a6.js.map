{"version":3,"sources":["webpack:///src/common/core/ui/confirm-modal/confirm-modal.component.ts","webpack:///src/common/core/ui/confirm-modal/confirm-modal.component.html","webpack:///src/common/file-preview/preview-url-transformer.ts","webpack:///node_modules/rxjs/internal/util/isIterable.js","webpack:///src/app/shared/models/Reply.ts","webpack:///src/app/conversation/draft.service.ts","webpack:///node_modules/rxjs/internal/scheduled/scheduleObservable.js","webpack:///node_modules/rxjs/internal/scheduled/scheduleArray.js","webpack:///src/app/ticketing/assign-ticket-dropdown/assign-ticket-dropdown.component.ts","webpack:///src/app/ticketing/assign-ticket-dropdown/assign-ticket-dropdown.component.html","webpack:///src/app/conversation/conversation-replies/conversation-replies.component.ts","webpack:///src/app/conversation/conversation-replies/conversation-replies.component.html","webpack:///src/app/conversation/conversation-modal/conversation-modal.component.ts","webpack:///src/app/conversation/conversation-modal/conversation-modal.component.html","webpack:///src/common/uploads/formatted-file-size.pipe.ts","webpack:///node_modules/rxjs/internal/util/subscribeTo.js","webpack:///src/app/shared/models/Tag.ts","webpack:///src/common/file-preview/preview-files.service.ts","webpack:///src/app/ticketing/canned-replies/crupdate-canned-reply-modal/crupdate-canned-reply-modal.component.ts","webpack:///src/app/ticketing/canned-replies/crupdate-canned-reply-modal/crupdate-canned-reply-modal.component.html","webpack:///src/app/shared/file-preview-overlay/file-preview-toolbar/file-preview-toolbar.component.html","webpack:///src/app/shared/file-preview-overlay/file-preview-toolbar/file-preview-toolbar.component.ts","webpack:///src/app/shared/file-mime.service.ts","webpack:///src/app/shared/file-preview-overlay/file-preview-overlay.component.ts","webpack:///src/app/shared/file-preview-overlay/file-preview-overlay.component.html","webpack:///src/app/shared/reply-attachment-list/reply-attachment-list.component.html","webpack:///src/app/shared/reply-attachment-list/reply-attachment-list.component.ts","webpack:///src/common/auth/find-user-modal/find-user-modal.component.ts","webpack:///src/common/auth/find-user-modal/find-user-modal.component.html","webpack:///node_modules/rxjs/internal/util/isPromise.js","webpack:///node_modules/rxjs/internal/util/pipe.js","webpack:///src/app/conversation/conversation.component.html","webpack:///src/app/conversation/conversation.component.ts","webpack:///node_modules/@angular/material/__ivy_ngcc__/fesm2015/chips.js","webpack:///src/common/file-preview/file-preview.module.ts","webpack:///src/app/customer-mailbox/customer-tickets-list/customer-tickets-list.component.html","webpack:///src/app/customer-mailbox/customer-tickets-list/customer-tickets-list.component.ts","webpack:///src/app/ticketing/suggested-articles-drawer/suggested-articles-drawer.component.html","webpack:///src/app/ticketing/suggested-articles-drawer/suggested-articles-drawer.component.ts","webpack:///src/app/ticketing/new-ticket/new-ticket.component.html","webpack:///src/app/ticketing/new-ticket/new-ticket.component.ts","webpack:///src/app/customer-mailbox/customer-mailbox.component.html","webpack:///src/app/customer-mailbox/customer-mailbox.component.ts","webpack:///src/app/customer-mailbox/customer-conversation/customer-conversation.component.html","webpack:///src/app/customer-mailbox/customer-conversation/customer-conversation.component.ts","webpack:///src/app/customer-mailbox/customer-mailbox.routing.ts","webpack:///src/app/customer-mailbox/customer-mailbox.module.ts","webpack:///src/app/conversation/conversation-resolve.service.ts","webpack:///src/common/uploads/utils/read-uploaded-folders.ts","webpack:///src/common/uploads/directives/upload-dropzone.directive.ts","webpack:///src/app/conversation/conversation.module.ts","webpack:///src/common/uploads/directives/upload-button.directive.ts","webpack:///node_modules/rxjs/internal/scheduled/scheduled.js","webpack:///src/app/ticketing/add-tag-dropdown/add-tag-dropdown.component.ts","webpack:///src/app/ticketing/add-tag-dropdown/add-tag-dropdown.component.html","webpack:///node_modules/rxjs/internal/Subscriber.js","webpack:///node_modules/rxjs/internal/util/isObject.js","webpack:///src/common/uploads/uploads.module.ts","webpack:///node_modules/rxjs/internal/Observer.js","webpack:///src/app/conversation/conversation-sidebar/conversation-sidebar.component.ts","webpack:///src/app/conversation/conversation-sidebar/conversation-sidebar.component.html","webpack:///node_modules/rxjs/internal/util/isInteropObservable.js","webpack:///node_modules/rxjs/internal/observable/of.js","webpack:///src/app/shared/tag.service.ts","webpack:///src/app/shared/reply-attachment-list/reply-attachment-list.module.ts","webpack:///src/app/conversation/conversation-replies.service.ts","webpack:///src/common/text-editor/editors/tinymce-text-editor.service.ts","webpack:///src/common/text-editor/validation/text-editor-image-validator.ts","webpack:///src/common/text-editor/text-editor.component.html","webpack:///src/common/text-editor/text-editor.component.ts","webpack:///node_modules/rxjs/internal/util/UnsubscriptionError.js","webpack:///node_modules/rxjs/internal/scheduled/scheduleIterable.js","webpack:///node_modules/rxjs/internal/util/hostReportError.js","webpack:///node_modules/rxjs/internal/util/subscribeToArray.js","webpack:///src/app/ticketing/canned-replies/dropdown/canned-replies-dropdown.component.ts","webpack:///src/app/ticketing/canned-replies/dropdown/canned-replies-dropdown.component.html","webpack:///node_modules/rxjs/internal/Observable.js","webpack:///node_modules/rxjs/internal/operators/mergeMap.js","webpack:///node_modules/rxjs/internal/symbol/iterator.js","webpack:///node_modules/rxjs/internal/InnerSubscriber.js","webpack:///src/app/ticketing/canned-replies/canned-replies.service.ts","webpack:///src/common/file-preview/base-file-preview.ts","webpack:///src/common/shared/data-table/data/paginated-data-table-source.ts","webpack:///src/common/core/utils/array-to-object.ts","webpack:///node_modules/rxjs/internal/util/toSubscriber.js","webpack:///node_modules/rxjs/internal/OuterSubscriber.js","webpack:///node_modules/perfect-scrollbar/dist/perfect-scrollbar.esm.js","webpack:///src/common/core/ui/custom-scrollbar/supports-native-scrollbar-styling.ts","webpack:///src/common/core/ui/custom-scrollbar/custom-scrollbar.directive.ts","webpack:///node_modules/rxjs/internal/util/subscribeToPromise.js","webpack:///src/common/file-preview/default-preview/default-preview.component.ts","webpack:///src/common/file-preview/default-preview/default-preview.component.html","webpack:///src/app/ticketing/update-reply-modal/update-reply-modal.component.ts","webpack:///src/app/ticketing/update-reply-modal/update-reply-modal.component.html","webpack:///src/app/ticketing/ticket-attachments.service.ts","webpack:///src/app/conversation/conversation-header/conversation-header.component.html","webpack:///src/app/conversation/conversation-header/conversation-header.component.ts","webpack:///node_modules/rxjs/internal/util/subscribeToResult.js","webpack:///src/app/shared/models/CannedReply.ts","webpack:///src/app/conversation/after-reply-action.service.ts","webpack:///node_modules/rxjs/internal/observable/from.js","webpack:///src/common/core/ui/custom-scrollbar/custom-scrollbar.module.ts","webpack:///src/app/customer-mailbox/new-ticket-categories-resolve.ts","webpack:///src/common/core/ui/format-pipes/formatted-date.pipe.ts","webpack:///src/common/file-preview/current-preview-file.ts","webpack:///src/app/shared/router-history.service.ts","webpack:///src/app/conversation/conversation-toolbar/conversation-toolbar.component.ts","webpack:///src/app/conversation/conversation-toolbar/conversation-toolbar.component.html","webpack:///src/common/core/ui/format-pipes/format-pipes.module.ts","webpack:///src/app/conversation/confirm-reply-delete-modal/confirm-reply-delete-modal.component.ts","webpack:///src/app/conversation/confirm-reply-delete-modal/confirm-reply-delete-modal.component.html","webpack:///node_modules/rxjs/internal/util/isArray.js","webpack:///node_modules/rxjs/internal/config.js","webpack:///node_modules/rxjs/internal/scheduled/schedulePromise.js","webpack:///node_modules/rxjs/internal/util/isScheduler.js","webpack:///src/common/file-preview/preview-container/preview-container.component.html","webpack:///src/common/file-preview/preview-container/preview-container.component.ts","webpack:///node_modules/rxjs/internal/util/subscribeToObservable.js","webpack:///node_modules/rxjs/internal/symbol/rxSubscriber.js","webpack:///src/common/core/ui/infinite-scroll/infinite.scroll.ts","webpack:///src/app/shared/conversation-infinite-scroll.directive.ts","webpack:///node_modules/rxjs/internal/util/subscribeToIterable.js","webpack:///node_modules/rxjs/internal/util/isFunction.js","webpack:///node_modules/rxjs/internal/operators/map.js","webpack:///src/app/conversation/conversation-text-editor/conversation-text-editor.component.ts","webpack:///src/app/conversation/conversation-text-editor/conversation-text-editor.component.html","webpack:///src/app/ticketing/add-note-modal/add-note-modal.component.ts","webpack:///src/app/ticketing/add-note-modal/add-note-modal.component.html","webpack:///node_modules/rxjs/_esm2015/internal/operators/throttle.js","webpack:///node_modules/rxjs/_esm2015/internal/operators/throttleTime.js","webpack:///src/common/uploads/upload-progress-bar/upload-progress-bar.component.ts","webpack:///src/common/uploads/upload-progress-bar/upload-progress-bar.component.html","webpack:///src/app/shared/models/Ticket.ts","webpack:///src/common/uploads/utils/download-file-from-url.ts","webpack:///src/common/file-preview/text-preview/text-preview.component.html","webpack:///src/common/file-preview/text-preview/text-preview.component.ts","webpack:///src/common/file-preview/audio-preview/audio-preview.component.html","webpack:///src/common/file-preview/audio-preview/audio-preview.component.ts","webpack:///src/common/file-preview/video-preview/video-preview.component.html","webpack:///src/common/file-preview/video-preview/video-preview.component.ts","webpack:///src/common/file-preview/image-preview/image-preview.component.ts","webpack:///src/common/file-preview/pdf-preview/pdf-preview.component.ts","webpack:///src/common/file-preview/image-preview/image-preview.component.html","webpack:///src/common/file-preview/pdf-preview/pdf-preview.component.html","webpack:///src/common/file-preview/google-docs-viewer/google-docs-viewer.component.html","webpack:///src/common/file-preview/google-docs-viewer/google-docs-viewer.component.ts","webpack:///src/common/file-preview/available-previews.ts","webpack:///node_modules/rxjs/internal/util/noop.js","webpack:///src/app/conversation/conversation.service.ts","webpack:///node_modules/rxjs/internal/util/isArrayLike.js","webpack:///src/app/conversation/conversation-replies/show-original-reply-modal/show-original-reply-modal.component.ts","webpack:///src/app/conversation/conversation-replies/show-original-reply-modal/show-original-reply-modal.component.html","webpack:///node_modules/rxjs/internal/util/canReportError.js","webpack:///node_modules/rxjs/internal/Subscription.js","webpack:///node_modules/rxjs/internal/symbol/observable.js","webpack:///node_modules/rxjs/internal/observable/fromArray.js"],"names":["ConfirmModalComponent","dialogRef","data","i18n","settings","this","close","title","t","body","bodyBold","ok","cancel","confirm","PREVIEW_URL_TRANSFORMER","factory","entry","url","providedIn","iterator_1","exports","isIterable","input","iterator","Reply","params","name","type","Draft","ticketUploads","tickets","uploadQueue","toast","reset","model","draft","contents","id","ticketId","length","uploads","files","start","pipe","scan","acc","value","fileEntry","last","subscribe","entries","save","detach","i","get","findIndex","upl","splice","isEmpty","request","saveDraft","getPayload","catchError","of","share","response","set","deleteDraft","Object","assign","map","upload","Observable_1","Subscription_1","observable_1","scheduleObservable","scheduler","Observable","subscriber","sub","Subscription","add","schedule","observable","next","error","err","complete","scheduleArray","closed","AssignTicketDropdownComponent","users","currentUser","agents","assigned","trigger","menuOpened","fetchAgents","openMenu","closeMenu","userId","ticketIds","ticket","assigned_to","open","emit","getAll","permission","per_page","filter","user","assignTicketsTo","ConversationRepliesComponent","modal","conversation","backendEvents","subscription","ticketReplyCreated","reply","ticket_id","replies","unsubscribe","panelClass","afterClosed","newReply","replace","show","confirmed","delete","setDraft","openEditor","remove","className","getOriginalEmailForReply","original","u","updateReply","ConversationModalComponent","tags","router","hydrate","closeAll","navigate","getStatus","merge","activeTicketId","refresh","init","openTicket","FormattedFileSizePipe","precision","bytes","isNaN","parseFloat","String","isFinite","subscribeToArray_1","subscribeToPromise_1","subscribeToIterable_1","subscribeToObservable_1","isArrayLike_1","isPromise_1","isObject_1","subscribeTo","result","subscribeToObservable","isArrayLike","subscribeToArray","isPromise","subscribeToPromise","subscribeToIterable","isObject","TypeError","Tag","PreviewFilesService","availablePreviews","injector","portal","meta","previewUriTransformer","download","asObservable","haveNext","updateMeta","updatePortal","havePrevious","dir","newPointer","oldPointer","pointer","total","current","getCurrent","createInjector","activeFile","injectionTokens","WeakMap","transformer","CrupdateCannedReplyModalComponent","cannedReplies","attachments","errors","cannedReply","textEditor","destroyEditor","payload","update","create","errorResponse","messages","getContents","shared","attachment","setContents","slice","uploadFiles","previewFiles","FilePreviewToolbarComponent","FileMime","FilePreviewOverlayComponent","showLogo","disableDownload","showCloseButton","el","overlayRef","ticketEntry","setPreviewUriTransformer","urlTransformer","bind","bindToDownload","previewContainer","nativeElement","addEventListener","e","target","closest","downloadSub","getAllEntries","downloadFile","hashes","hash","join","getBaseUrl","closeOverlay","iconsMap","text","audio","video","document","image","mime","split","getFileType","$event","stopPropagation","ReplyAttachmentListComponent","overlay","cancelButtonVisible","detached","ent","position","origin","FindUserModalComponent","searchFormControl","loading$","users$","valueChanges","query","searchUsers","then","noop_1","pipeFromArray","fns","reduce","prev","fn","noop","_i","arguments","ConversationComponent","route","hideBackButton","hideSidebar","focus","_c0","_MatChipMixinBase","_elementRef","MatChipAvatar","ɵfac","ɵdir","selectors","hostAttrs","MatChipTrailingIcon","MatChip","_ngZone","platform","globalRippleOptions","animationMode","_changeDetectorRef","super","_hasFocus","chipListSelectable","_chipListMultiple","_selected","_selectable","_removable","_onFocus","_onBlur","selectionChange","destroyed","removed","_addHostClassName","_chipRipple","setupTriggerEvents","rippleConfig","_animationsDisabled","element","hasAttribute","tagName","toLowerCase","classList","chip","_removeTriggerEvents","_dispatchSelectionChange","_markForCheck","isUserInput","selected","removable","event","disabled","preventDefault","keyCode","selectable","toggleSelected","onStable","run","source","markForCheck","disableRipple","coercedValue","c","_value","textContent","toString","contentQueries","rf","ctx","dirIndex","_t","MatChipRemove","avatar","first","trailingIcon","removeIcon","hostVars","hostBindings","_handleClick","_handleKeydown","_blur","ariaSelected","inputs","color","outputs","exportAs","features","_parentChip","parentChip","MAT_CHIPS_DEFAULT_OPTIONS","_MatChipListMixinBase","_defaultErrorStateMatcher","_parentForm","_parentFormGroup","ngControl","nextUniqueId","MatChipListChange","MatChipList","_dir","controlType","_lastDestroyedChipIndex","_destroyed","_uid","_tabIndex","_userTabIndex","_onTouched","_onChange","_multiple","_compareWith","o1","o2","_required","_disabled","ariaOrientation","change","valueChange","valueAccessor","_keyManager","chips","withWrap","withVerticalOrientation","withHorizontalOrientation","tabOut","_allowFocusEscape","changes","Promise","resolve","_syncChipsState","_resetChips","_initializeSelection","_updateTabIndex","_updateFocusForDestroyedChips","stateChanges","_selectionModel","multiple","undefined","updateErrorState","_dropSubscriptions","inputElement","_chipInput","ids","_ariaDescribedby","_setSelectionByValue","isDisabled","_originatesFromChip","options","focused","setFirstItemActive","_focusInput","_isInputEmpty","setLastItemActive","contains","onKeydown","newChipIndex","Math","min","setActiveItem","index","nodeName","_clearSelection","forEach","deselect","Array","isArray","currentValue","_selectValue","_sortValues","correspondingChip","find","selectViaInteraction","select","skip","clear","fallbackValue","valueToEmit","_hasFocusedChip","setTimeout","_markAsTouched","_listenToChipsFocus","_listenToChipsSelection","_listenToChipsRemoved","_chipFocusSubscription","_chipBlurSubscription","_chipSelectionSubscription","_chipRemoveSubscription","chipSelectionChanges","isSelected","_propagateChanges","chipFocusChanges","chipIndex","toArray","indexOf","_isValidIndex","updateActiveItem","chipBlurChanges","chipRemoveChanges","currentElement","parentElement","some","empty","writeValue","placeholder","_placeholder","ɵcmp","_keydown","role","required","errorState","compareWith","tabIndex","errorStateMatcher","provide","useExisting","ngContentSelectors","decls","vars","consts","template","styles","encapsulation","changeDetection","nextUniqueId$1","MatChipInput","_defaultOptions","_addOnBlur","separatorKeyCodes","chipEnd","_inputElement","_chipList","_emitChipEnd","addOnBlur","_isSeparatorKey","separators","has","registerInput","_focus","_onInput","invalid","chipList","ɵ0","MatChipsModule","ɵmod","ɵinj","providers","useValue","FilePreviewModule","useClass","CustomerTicketsListComponent","paginator","form","snapshot","queryParams","status","dataSource","uri","dataPaginator","matPaginator","matSort","console","log","reload","disconnect","tag","SuggestedArticlesDrawerComponent","helpCenter","urls","searchLogger","inputValue","searchQuery","articles","searching","debounceTime","distinctUntilChanged","switchMap","searchArticles","pagination","setSearchResults","findArticles","categories","updateSession","clickedArticle","NewTicketComponent","errors$","BehaviorSubject","attachments$","ticketCategories","ticketModel","content$","ReplaySubject","all$","getJson","category","subject","getAllCompleted","finalize","updateSessionAndStore","createdTicket","customerTicketList","newAttachments","cat","CustomerMailboxComponent","CustomerConversationComponent","getStatusTags","changeTicketStatus","afterReplyAction","navigateToCustomerTicketsList","setStatus","routing","forChild","path","component","canActivate","children","permissions","CustomerMailboxModule","TicketResolve","state","mergeMap","readDirRecursive","createReader","readEntries","key","childEntry","isDirectory","push","transformFileEntry","file","fullPath","UploadDropzoneDirective","disableDropzoneClick","disableDropzone","uploadConfig","filesDropped","handleDragEnter","handleDragOver","handleDragLeave","handleDrop","clickButton","handleClick","removeClassesFromDropzone","emitUploadEvent","dropzoneDisabled","dataTransfer","dropEffect","newEl","elementFromPoint","clientX","clientY","items","from","item","kind","webkitGetAsEntry","concat","hasFiles","types","ConversationModule","UploadButtonDirective","config","filesSelected","scheduleObservable_1","schedulePromise_1","scheduleArray_1","scheduleIterable_1","isInteropObservable_1","isIterable_1","scheduled","isInteropObservable","schedulePromise","scheduleIterable","AddTagDropdownComponent","tagService","tagAdded","tagQuery","searchedOnce","trackByFn","bindTagQueryInput","searchForTags","perPage","menuClosed","clearSearchField","addTag","setValue","search","extendStatics","__extends","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","prototype","isFunction_1","Observer_1","rxSubscriber_1","config_1","hostReportError_1","Subscriber","_super","destinationOrNext","_this","call","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","destination","SafeSubscriber","rxSubscriber","_next","_error","_complete","_unsubscribeAndRecycle","_parentOrParents","_parentSubscriber","observerOrNext","context","isFunction","_context","useDeprecatedSynchronousErrorHandling","__tryOrSetError","__tryOrUnsub","hostReportError","wrappedComplete","parent","Error","_unsubscribe","x","UploadsModule","ConversationSidebarComponent","previousTicketsVisible","activeTicket","loadUserData","mergedTicket","otherTickets","requester","getTickets","user_id","getCategory","purchase_codes","categoryName","bestMatch","code","item_name","envatoPurchase","beforeClosed","getUserTicketsExceptCurrent","setEnvatoPurchase","isScheduler_1","fromArray_1","args","isScheduler","pop","fromArray","TagService","http","baseUri","getWithCache","post","put","notType","ReplyAttachmentListModule","ConversationReplies","currentPage","lastPage","isLoading","existing","unshift","oldReply","replyId","getTicketReplies","current_page","last_page","TinymceTextEditor","TextEditorImageValidator","zone","lazyLoader","breakpoints","makeBootstrapPromise","editorIsReady","tinymceInstance","setContent","undoManager","waitForEditor","hasUndo","hasRedo","queryCommandState","execCommand","getContent","transact","selection","setCursorLocation","nodeChanged","collapse","insertContents","bootstrapPromise","loadTinymce","initTinymce","loadAsset","textAreaEl","plugins","branding","browser_spellcheck","max_height","maxHeight","min_height","minHeight","autoresize_on_init","paste_as_text","elementpath","statusbar","menubar","convert_urls","forced_root_block","element_format","body_class","content_style","content_css","default_link_target","link_assume_external_targets","target_list","link_title","image_dimensions","image_description","setup","editor","on","onChange","shortcuts","onCtrlEnter","init_instance_callback","bootstrapPromiseResolve","isMobile$","toolbar","extended_valid_elements","getAssetUrl","height","editorEl","offsetHeight","tinymce","DEFAULT_MAX_SIZE_MB","validations","maxSize","convertToBytes","TextEditorComponent","renderer","overlayPanel","imageValidator","sourceAreaControl","activeEditor","showAdvancedControls","basic","onFileUpload","bootTextEditor","command","BeColorPickerModule","components","panel","valueChanged","contentAreaContainer","setStyle","sourceTextArea","source_view","fileList","Image","validator","httpParams","diskPrefix","inlineUploadPrefix","insertImage","attrs","href","setConfig","visualTextArea","UnsubscriptionError","UnsubscriptionErrorImpl","message","return","done","array","len","CannedRepliesDropdownComponent","cannedRepliesService","onReplySelect","loadedResultsAtLeastOnce","getCannedReplies","fullMatch","groupMatch","force","getReplies","canReportError_1","toSubscriber_1","pipe_1","getPromiseCtor","promiseCtor","_isScalar","_subscribe","lift","operator","sink","toSubscriber","_trySubscribe","canReportError","warn","reject","operations","toPromise","subscribeToResult_1","OuterSubscriber_1","InnerSubscriber_1","map_1","from_1","project","resultSelector","concurrent","Number","POSITIVE_INFINITY","a","ii","MergeMapOperator","observer","MergeMapSubscriber","hasCompleted","buffer","active","_tryNext","_innerSub","ish","innerSubscriber","InnerSubscriber","innerSubscription","subscribeToResult","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","notifyComplete","shift","OuterSubscriber","getSymbolIterator","Symbol","$$iterator","notifyError","CannedRepliesService","httpClient","BaseFilePreview","sanitizer","filePreviewWrapper","bypassSecurityTrustResourceUrl","getSrc","responseType","initiated","pagination$","userParamsChange$","selectedRows","searchControl","filterForm","nextPageLoader$","virtualSort$","paginationParams","activeFilters$","filters","f","column","control","defaultValue","addControl","applyFiltersFromQueryParams","dontUpdateQueryParams","hasValue","allRowsSelected","deselectAllItems","row","getCurrentPage","page","resetSort","resetMatPaginator","updateConfig","sortChange","initialized","pageChange","searchChange","filterChange","keys","combineLatest","transformParams","paginate","initialData","pageIndex","pageSize","appendData","currentData","patchValue","originalParams","previous","orderBy","orderDir","direction","keysToRemove","staticParams","sort","disableClear","_changePageSize","firstPage","destroy","currentQueryParams","queryValues","controls","filterName","queryValue","paginatedOnce$","val","take","noResults$","noResults","paginationResponse","Subscriber_1","nextOrObserver","apply","getComputedStyle","obj","style","div","createElement","elMatches","Element","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","parentNode","removeChild","queryChildren","selector","child","cls","scrollingClassTimeout","y","addScrollingClass","clearTimeout","removeScrollingClass","isAlive","scrollingThreshold","EventElement","handlers","prototypeAccessors","configurable","eventName","handler","unbind","this$1","removeEventListener","unbindAll","every","defineProperties","EventManager","eventElements","createEvent","window","CustomEvent","evt","initCustomEvent","processScrollDiff","axis","diff","useScrollingClass","forceFireReachEvent","fields","ref","contentHeight","containerHeight","scrollTop","up","down","reach","dispatchEvent","toInt","parseInt","eventElement","ee","once","onceHandler","env","isWebKit","documentElement","supportsTouch","navigator","maxTouchPoints","DocumentTouch","supportsIePointer","msMaxTouchPoints","isChrome","test","userAgent","updateGeometry","roundedScrollTop","floor","rect","getBoundingClientRect","containerWidth","ceil","width","contentWidth","scrollWidth","scrollHeight","scrollbarXRail","appendChild","scrollbarYRail","suppressScrollX","scrollXMarginOffset","scrollbarXActive","railXWidth","railXMarginWidth","railXRatio","scrollbarXWidth","getThumbSize","scrollbarXLeft","negativeScrollAdjustment","scrollLeft","suppressScrollY","scrollYMarginOffset","scrollbarYActive","railYHeight","railYMarginHeight","railYRatio","scrollbarYHeight","scrollbarYTop","xRailOffset","left","isRtl","isScrollbarXUsingBottom","bottom","scrollbarXBottom","top","scrollbarXTop","yRailOffset","isScrollbarYUsingRight","right","scrollbarYRight","scrollbarYOuterWidth","scrollbarYLeft","scrollbarX","railBorderXWidth","scrollbarY","railBorderYWidth","thumbSize","minScrollbarLength","max","maxScrollbarLength","bindMouseScrollHandler","pageY","startingScrollTop","startingMousePageY","scrollBy","mouseMoveHandler","touches","mouseUpHandler","ownerDocument","bindMoves","touchMode","positionTop","pageYOffset","positionLeft","pageX","pageXOffset","keyboard","isDefaultPrevented","defaultPrevented","activeElement","contentDocument","shadowRoot","deltaX","deltaY","which","metaKey","altKey","shiftKey","wheelPropagation","wheel","mousewheelHandler","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","querySelector","cursor","overflowY","match","maxScrollTop","clientHeight","overflowX","maxScrollLeft","clientWidth","shouldPrevent","useBothWheelAxes","wheelSpeed","isTop","isBottom","isLeft","isRight","offsetWidth","abs","ctrlKey","onwheel","onmousewheel","touch","startOffset","startTime","speed","easingLoop","touchStart","touchMove","touchEnd","PointerEvent","MSPointerEvent","applyTouchMove","differenceX","differenceY","getTouch","targetTouches","shouldHandle","pointerType","buttons","MSPOINTER_TYPE_MOUSE","Date","getTime","clearInterval","currentOffset","currentTime","timeGap","magnitudeX","magnitudeY","scrollY","swipeEasing","setInterval","isInitialized","PerfectScrollbar","userSettings","originalScrollLeft","blur","isNegativeScroll","setAttribute","railXStyle","borderLeftWidth","borderRightWidth","display","marginLeft","marginRight","railYStyle","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","marginTop","marginBottom","handlerName","lastScrollTop","lastScrollLeft","onScroll","removePsClasses","SUPPORTS_NATIVE_SCROLLBAR_STYLING","appVersion","overflow","innerHTML","CustomScrollbarDirective","ngZone","mutationObserverFactory","supportsNativeStyling","subscriptions","minLength","suppressX","native","debouncer","Subject","addClass","shouldUseNative","scrollbar","bindToContentChange","runOutsideAngular","mutations","observe","childList","subtree","promise","DefaultPreviewComponent","UpdateReplyModalComponent","TicketAttachmentsService","conversationId","draftId","uploadId","ConversationHeaderComponent","mailboxTags","tagToRemove","removeTag","subscribeTo_1","outerSubscriber","CannedReply","AfterReplyAction","localStorage","defaultAction","navigateToNextActiveTicket","navigateToAgentTicketsList","tagId","getActiveTagId","getLatestActiveTicket","scheduled_1","CustomScrollbarModule","NewTicketCategoriesResolve","navigateByUrl","FormattedDatePipe","_locale","format","angularPipe","timezone","locale","transform","CURRENT_PREVIEW_FILE","RouterHistory","history","limit","getPrevious","parts","parseQueryParams","rawString","URLSearchParams","events","addHistoryItem","urlAfterRedirects","ConversationToolbarComponent","modals","browserEvents","routerHistory","initKeybinds","performAfterReplyAction","note","addNewNote","refreshMailboxTags","back","relativeTo","globalKeyDown$","handled","anyDialogOpen","userIsTyping","closeAllMenus","navigateToTicketsList","assignTicketDropdown","showNoteModal","addTagDropdown","ticketStatusTrigger","menuOpen","handleTicketStatusChangeKeybind","getTagByIdOrName","FormatPipesModule","ConfirmReplyDeleteModalComponent","getDisplayType","_enable_super_gross_mode_that_will_cause_bad_things","stack","PreviewContainerComponent","comp","instance","obs","random","$$rxSubscriber","InfiniteScroll","threshold","scrollSub","fromEvent","getScrollContainer","capture","passive","canLoadMore","offset","innerHeight","loadMoreItems","ConversationInfiniteScrollDirective","loadMore","iterable","thisArg","MapOperator","MapSubscriber","count","ConversationTextEditorComponent","hcUrls","selectedStatus","setSelectedStatus","setEditor","submitReply","closeEditor","hasPermission","articleDropdown","article","insertLink","saveDraftAndAddToReplies","maybeDeleteDraft","AddNoteModalComponent","ticketService","loading","addNote","defaultThrottleConfig","leading","trailing","ThrottleTimeOperator","duration","_hasTrailingValue","_trailingValue","throttled","dispatchNext","arg","clearThrottle","UploadProgressBarComponent","cd","hidden","totalProgress","animationFrame","progress","count$","pending","AGENT_PERMISSION","Ticket","downloadFileFromUrl","link","click","TextPreviewComponent","fileTooLarge$","file_size","loadFileContents","content","AudioPreviewComponent","invalidMedia","canPlayVideo","player","src","play","canPlayType","playerEl","VideoPreviewComponent","ImagePreviewComponent","PdfPreviewComponent","GoogleDocsViewerComponent","showDefaultPreview$","showDefaultPreview","iframe","onload","timeoutRef","stopLoading","getIframeSrc","catch","location","previewUrl","preview_token","getGoogleDocsUrl","encodeURIComponent","DefaultPreviews","AVAILABLE_PREVIEWS","pdf","spreadsheet","powerPoint","word","Conversation","replySaving","editorIsOpen","afterInit","newTag","saveReply","perform","setTicketId","ShowOriginalReplyModalComponent","headerNames","originalEmail","headers","isArray_1","UnsubscriptionError_1","flattenUnsubscriptionErrors","errs","_subscriptions","teardown","EMPTY","tmp","subscriptionIndex"],"mappings":"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","file":"x","sourcesContent":["import {ChangeDetectionStrategy, Component, Inject, OnInit} from '@angular/core';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {Translations} from '../../translations/translations.service';\r\nimport {Settings} from '../../config/settings.service';\r\n\r\nexport interface ConfirmModalData {\r\n    title: string;\r\n    body: string;\r\n    bodyBold?: string;\r\n    ok?: string;\r\n    cancel?: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'confirm-modal',\r\n    templateUrl: './confirm-modal.component.html',\r\n    styleUrls: ['./confirm-modal.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ConfirmModalComponent implements OnInit {\r\n    constructor(\r\n        private dialogRef: MatDialogRef<ConfirmModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: ConfirmModalData,\r\n        private i18n: Translations,\r\n        public settings: Settings,\r\n    ) {}\r\n\r\n    public close() {\r\n        this.dialogRef.close(false);\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.data.title = this.i18n.t(this.data.title);\r\n        this.data.body = this.i18n.t(this.data.body);\r\n        if (this.data.bodyBold) this.data.bodyBold = this.i18n.t(this.data.bodyBold);\r\n        this.data.ok = this.data.ok ? this.i18n.t(this.data.ok) : this.i18n.t('Confirm');\r\n        this.data.cancel = this.data.cancel ? this.i18n.t(this.data.cancel) : this.i18n.t('Cancel');\r\n    }\r\n\r\n    public confirm() {\r\n        this.dialogRef.close(true);\r\n    }\r\n}","<div class=\"modal-header\">\r\n    <h2 class=\"modal-title\" mat-dialog-title>{{data.title}}</h2>\r\n    <button type=\"button\" (click)=\"close()\" class=\"close-button no-style\" tabindex=\"-1\">\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<div class=\"mat-dialog-contents\" mat-dialog-content>\r\n    <p>{{data.body}}</p>\r\n    <p class=\"bold\" *ngIf=\"data.bodyBold\">{{data.bodyBold}}</p>\r\n</div>\r\n\r\n<div class=\"buttons right mat-dialog-actions\" mat-dialog-actions>\r\n    <button (click)=\"close()\" type=\"button\" mat-button class=\"button cancel cancel-button\">{{data.cancel}}</button>\r\n    <button type=\"submit\" mat-raised-button color=\"accent\" class=\"button primary submit-button\" cdkFocusInitial (click)=\"confirm()\">{{data.ok}}</button>\r\n</div>\r\n","import { InjectionToken } from '@angular/core';\r\nimport { FileEntry } from '@common/uploads/types/file-entry';\r\n\r\nexport type PreviewUrlTransformer = (entry: FileEntry) => string;\r\n\r\nexport const PREVIEW_URL_TRANSFORMER = new InjectionToken<PreviewUrlTransformer>('PREVIEW_URL_TRANSFORMER', {\r\n    factory: () => {\r\n        return entry => entry.url;\r\n    },\r\n    providedIn: 'root',\r\n});\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar iterator_1 = require(\"../symbol/iterator\");\nfunction isIterable(input) {\n    return input && typeof input[iterator_1.iterator] === 'function';\n}\nexports.isIterable = isIterable;\n//# sourceMappingURL=isIterable.js.map","import {Ticket} from './Ticket';\r\nimport {User} from './User';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\n\r\nexport class Reply {\r\n    id: number;\r\n    body: string;\r\n    user_id: number;\r\n    ticket_id: number;\r\n    uuid?: string;\r\n    type = 'replies';\r\n    created_at?: string;\r\n    updated_at?: string;\r\n    uploads?: FileEntry[];\r\n    ticket?: Ticket;\r\n    user?: User;\r\n\r\n    constructor(params: Object = {}) {\r\n        for (const name in params) {\r\n            this[name] = params[name];\r\n        }\r\n    }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {TicketAttachmentsService} from '../ticketing/ticket-attachments.service';\r\nimport {Reply} from '../shared/models/Reply';\r\nimport {DraftPayload, TicketsService} from '../ticketing/tickets.service';\r\nimport {Observable, of} from 'rxjs';\r\nimport {catchError, last, scan, share} from 'rxjs/operators';\r\nimport {UploadQueueService} from '@common/uploads/upload-queue/upload-queue.service';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\nimport {UploadFileResponse} from '@common/uploads/uploads-api.service';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class Draft {\r\n    private model: Reply;\r\n    private ticketId: number;\r\n\r\n    constructor(\r\n        private ticketUploads: TicketAttachmentsService,\r\n        private tickets: TicketsService,\r\n        private uploadQueue: UploadQueueService,\r\n        private toast: Toast,\r\n    ) {\r\n        this.reset();\r\n    }\r\n\r\n    public get() {\r\n        return this.model;\r\n    }\r\n\r\n    public set(draft: Reply) {\r\n        this.model = draft;\r\n    }\r\n\r\n    public setBody(contents: string) {\r\n        this.model.body = contents;\r\n    }\r\n\r\n    public setTicketId(id: number) {\r\n        this.ticketId = id;\r\n    }\r\n\r\n    public isEmpty(): boolean {\r\n        return this.model.body.length === 0 && this.model.uploads.length === 0;\r\n    }\r\n\r\n    public uploadFiles(files: UploadedFile[]) {\r\n        // TODO: refactor\r\n        this.uploadQueue.start(files)\r\n            .pipe(\r\n                scan((acc, value: UploadFileResponse) => [...acc, value.fileEntry], []),\r\n                last(),\r\n            )\r\n            .subscribe(entries => {\r\n                this.model.uploads = [...this.model.uploads, ...entries];\r\n                this.save();\r\n            });\r\n    }\r\n\r\n    public detachUpload(fileEntry: FileEntry) {\r\n        this.ticketUploads.detach(this.model.id, fileEntry.id).subscribe(() => {\r\n            const i = this.get().uploads.findIndex(upl => upl.id === fileEntry.id);\r\n            this.get().uploads.splice(i, 1);\r\n        });\r\n    }\r\n\r\n    public save(params: {body?: string} = {}): Observable<{data: Reply}> {\r\n        if (this.isEmpty()) return;\r\n\r\n        const request = this.tickets.saveDraft(\r\n            this.ticketId,\r\n            this.getPayload(params),\r\n            this.model.id,\r\n        ).pipe(\r\n            catchError(() => of({data: this.get()})),\r\n            share()\r\n        );\r\n\r\n        request.subscribe(response => {\r\n            this.set(response['data']);\r\n        });\r\n\r\n        return request;\r\n    }\r\n\r\n    public delete() {\r\n        if (this.model.id) {\r\n            this.tickets.deleteDraft(this.model.id).subscribe();\r\n        }\r\n\r\n        this.reset();\r\n    }\r\n\r\n    public getPayload(params = {}): DraftPayload {\r\n        return Object.assign({}, {\r\n            body: this.model.body || null,\r\n            uploads: this.model.uploads.map(upload => upload.id),\r\n        }, params);\r\n    }\r\n\r\n    public reset() {\r\n        this.set(new Reply({uploads: [], body: ''}));\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar Subscription_1 = require(\"../Subscription\");\nvar observable_1 = require(\"../symbol/observable\");\nfunction scheduleObservable(input, scheduler) {\n    return new Observable_1.Observable(function (subscriber) {\n        var sub = new Subscription_1.Subscription();\n        sub.add(scheduler.schedule(function () {\n            var observable = input[observable_1.observable]();\n            sub.add(observable.subscribe({\n                next: function (value) { sub.add(scheduler.schedule(function () { return subscriber.next(value); })); },\n                error: function (err) { sub.add(scheduler.schedule(function () { return subscriber.error(err); })); },\n                complete: function () { sub.add(scheduler.schedule(function () { return subscriber.complete(); })); },\n            }));\n        }));\n        return sub;\n    });\n}\nexports.scheduleObservable = scheduleObservable;\n//# sourceMappingURL=scheduleObservable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar Subscription_1 = require(\"../Subscription\");\nfunction scheduleArray(input, scheduler) {\n    return new Observable_1.Observable(function (subscriber) {\n        var sub = new Subscription_1.Subscription();\n        var i = 0;\n        sub.add(scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n                return;\n            }\n            subscriber.next(input[i++]);\n            if (!subscriber.closed) {\n                sub.add(this.schedule());\n            }\n        }));\n        return sub;\n    });\n}\nexports.scheduleArray = scheduleArray;\n//# sourceMappingURL=scheduleArray.js.map","import {\r\n    Component,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    ViewEncapsulation,\r\n    ViewChild,\r\n    OnInit\r\n} from '@angular/core';\r\nimport {TicketsService} from '../tickets.service';\r\nimport {User} from '../../shared/models/User';\r\nimport {AGENT_PERMISSION, Ticket} from '../../shared/models/Ticket';\r\nimport {Users} from '@common/auth/users.service';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport { MatMenuTrigger } from '@angular/material/menu';\r\nimport {take} from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'assign-ticket-dropdown',\r\n    templateUrl: './assign-ticket-dropdown.component.html',\r\n    styleUrls: ['./assign-ticket-dropdown.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class AssignTicketDropdownComponent implements OnInit {\r\n    @ViewChild(MatMenuTrigger, { static: true }) trigger: MatMenuTrigger;\r\n\r\n    public agents: User[] = [];\r\n\r\n    @Input() ticket: Ticket;\r\n    @Input() ticketIds: number[];\r\n\r\n    @Output() assigned = new EventEmitter();\r\n\r\n    constructor(\r\n        private users: Users,\r\n        public currentUser: CurrentUser,\r\n        private tickets: TicketsService,\r\n        private toast: Toast,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.trigger.menuOpened\r\n            .pipe(take(1))\r\n            .subscribe(() => {\r\n                this.fetchAgents();\r\n            });\r\n    }\r\n\r\n    public open() {\r\n        this.trigger.openMenu();\r\n    }\r\n\r\n    public close() {\r\n        this.trigger.closeMenu();\r\n    }\r\n\r\n    public assignTicketsTo(userId: number = null) {\r\n        const payload = this.ticketIds ? this.ticketIds : [this.ticket.id];\r\n\r\n        this.tickets.assign(payload, userId).subscribe(() => {\r\n            if (this.ticket) this.ticket.assigned_to = userId;\r\n            this.toast.open('Tickets assigned');\r\n            this.assigned.emit();\r\n        });\r\n    }\r\n\r\n    public fetchAgents() {\r\n        this.users.getAll({permission: AGENT_PERMISSION, per_page: 35}).subscribe((users: User[]) => {\r\n            // filter out currently logged in user as there's already a 'me' dropdown item\r\n            this.agents = users.filter(user => user.id !== this.currentUser.get('id'));\r\n        });\r\n    }\r\n}\r\n","<button class=\"no-style toolbar-item\" [matMenuTriggerFor]=\"assignTicketMenu\"><mat-icon svgIcon=\"user-custom\"></mat-icon></button>\r\n\r\n<mat-menu #assignTicketMenu=\"matMenu\" [overlapTrigger]=\"false\" class=\"assign-ticket-menu\">\r\n    <button mat-menu-item class=\"anyone-item\" (click)=\"assignTicketsTo()\" [class.active]=\"ticket && !ticket.assigned_to\" trans>Anyone</button>\r\n    <button mat-menu-item class=\"me-item\" (click)=\"assignTicketsTo(currentUser.get('id'))\" [class.active]=\"ticket && ticket.assigned_to === currentUser.get('id')\" trans>Me</button>\r\n    <button mat-menu-item class=\"agent-item\" *ngFor=\"let agent of agents\" (click)=\"assignTicketsTo(agent.id)\" [class.active]=\"ticket && ticket.assigned_to == agent.id\">{{agent.email}}</button>\r\n</mat-menu>","import {Component, OnInit, ViewEncapsulation, Input, AfterViewInit, OnDestroy} from '@angular/core';\r\nimport {Conversation} from '../conversation.service';\r\nimport {ConversationTextEditorComponent} from '../conversation-text-editor/conversation-text-editor.component';\r\nimport {ShowOriginalReplyModalComponent} from './show-original-reply-modal/show-original-reply-modal.component';\r\nimport {Reply} from '../../shared/models/Reply';\r\nimport {TicketsService} from '../../ticketing/tickets.service';\r\nimport {UpdateReplyModalComponent} from '../../ticketing/update-reply-modal/update-reply-modal.component';\r\nimport {EchoService} from '../../shared/broadcasting/echo.service';\r\nimport {ConfirmReplyDeleteModalComponent} from '../confirm-reply-delete-modal/confirm-reply-delete-modal.component';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {Modal} from '@common/core/ui/dialogs/modal.service';\r\n\r\nimport * as Prism from 'prismjs';\r\nimport 'prismjs/components/prism-markup';\r\nimport 'prismjs/components/prism-markup-templating';\r\nimport 'prismjs/components/prism-php';\r\nimport 'prismjs/components/prism-typescript';\r\nimport 'prismjs/components/prism-javascript';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\nimport {Subscription} from 'rxjs';\r\n\r\n@Component({\r\n    selector: 'conversation-replies',\r\n    templateUrl: './conversation-replies.component.html',\r\n    styleUrls: ['./conversation-replies.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationRepliesComponent implements OnInit, AfterViewInit, OnDestroy {\r\n    @Input() textEditor: ConversationTextEditorComponent;\r\n    public subscription: Subscription;\r\n\r\n    constructor(\r\n        private modal: Modal,\r\n        public currentUser: CurrentUser,\r\n        private tickets: TicketsService,\r\n        public conversation: Conversation,\r\n        private backendEvents: EchoService,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        // make sure only replies to this ticket are added via backend events\r\n        this.subscription = this.backendEvents.ticketReplyCreated.subscribe((reply: Reply) => {\r\n            if (this.conversation.get().id !== reply.ticket_id) return;\r\n            reply['animated'] = true;\r\n            this.conversation.replies.add(reply);\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.subscription && this.subscription.unsubscribe();\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        if (Prism) Prism.highlightAll();\r\n    }\r\n\r\n    /**\r\n     * Update existing reply.\r\n     */\r\n    public update(reply: Reply) {\r\n        this.modal.open(UpdateReplyModalComponent, {reply}, {panelClass: 'update-reply-modal-container'})\r\n            .afterClosed()\r\n            .subscribe((newReply: Reply) => {\r\n                if ( ! newReply) return;\r\n                this.conversation.replies.replace(newReply);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Delete specified reply if user confirms this action.\r\n     */\r\n    public maybeDeleteReply(reply: Reply) {\r\n        this.modal.show(ConfirmReplyDeleteModalComponent, {reply})\r\n            .afterClosed()\r\n            .subscribe(confirmed => {\r\n                if ( ! confirmed) return;\r\n                this.conversation.replies.delete(reply);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Open specified draft in text editor.\r\n     */\r\n    public editDraft(draft: Reply) {\r\n        this.conversation.setDraft(draft);\r\n        this.conversation.openEditor();\r\n        this.conversation.replies.remove(draft.id);\r\n    }\r\n\r\n    /**\r\n     * Show original email that this reply was created from.\r\n     * (if it was created from email)\r\n     */\r\n    public showOriginalEmail(reply: Reply) {\r\n        const className = 'show-original-reply-modal-container';\r\n        this.tickets.getOriginalEmailForReply(reply.id).subscribe(response => {\r\n            this.modal.open(ShowOriginalReplyModalComponent, {original: response.data}, {panelClass: className});\r\n        }, () => {\r\n            this.modal.open(ShowOriginalReplyModalComponent, null, {panelClass: className});\r\n        });\r\n    }\r\n\r\n    public removeAttachment(reply: Reply, entry: FileEntry) {\r\n        reply.uploads = reply.uploads.filter(u => u.id !== entry.id);\r\n        this.tickets.updateReply(reply.id, {uploads: reply.uploads})\r\n            .subscribe(() => {}, () => {});\r\n    }\r\n}\r\n","<div class=\"thread\">\r\n    <ng-template ngFor let-reply let-last=\"last\" [ngForOf]=\"conversation.replies.get()\">\r\n        <div class=\"reply animated\" [class.bounce]=\"reply['animated']\" ngClass=\"{{reply.type}}\" [class.my-reply]=\"reply.user_id == currentUser.get('id')\" *ngIf=\"currentUser.hasPermission('replies.view') || reply.type !== 'notes'\">\r\n            <img class=\"user-avatar\" *ngIf=\"reply.user.avatar\" src=\"{{reply.user.avatar}}\" alt=\"{{reply.user.email}}\">\r\n            <div class=\"reply-body\">\r\n                <div class=\"message-header\">\r\n                    <div class=\"customer\">\r\n                        <span class=\"customer-name\">\r\n                            <span *ngIf=\"currentUser.get('id') == reply.user.id\" trans>You</span>\r\n                            <span *ngIf=\"currentUser.get('id') != reply.user.id\">{{reply.user.display_name}}</span>\r\n                        </span>\r\n                        &ngsp;\r\n                        <span class=\"text-gray action-text\" *ngIf=\"!last && reply.type === 'replies'\" trans>replied</span>\r\n                        <span class=\"text-gray action-text\" *ngIf=\"last && reply.type === 'replies'\" trans>started the conversation</span>\r\n                        <span class=\"text-gray action-text\" *ngIf=\"reply.type == 'notes'\" trans>left a note</span>\r\n                        <span class=\"text-gray action-text\" *ngIf=\"reply.type == 'drafts'\" trans>created a draft</span>\r\n\r\n                        <span class=\"draft-actions\" *ngIf=\"reply.type === 'drafts'\">\r\n                            <button type=\"button\" class=\"no-style edit-draft-button\" (click)=\"editDraft(reply)\" trans>Edit</button>\r\n                            <button type=\"button\" class=\"no-style delete-draft-button\" (click)=\"maybeDeleteReply(reply)\" trans>Discard</button>\r\n                        </span>\r\n                    </div>\r\n                    <div class=\"meta\">\r\n                        <span class=\"date\">{{reply['created_at_formatted']}}</span>\r\n\r\n                        <ng-container *ngIf=\"currentUser.hasPermission('replies.update') && reply.type !== 'drafts'\">\r\n                            <button mat-icon-button [matMenuTriggerFor]=\"replyActionsMenu\">\r\n                                <mat-icon svgIcon=\"more-vert\"></mat-icon>\r\n                            </button>\r\n                        </ng-container>\r\n\r\n                        <mat-menu #replyActionsMenu=\"matMenu\" class=\"reply-actions-menu\">\r\n                            <div mat-menu-item class=\"update-reply-button\" (click)=\"update(reply)\" trans>Edit</div>\r\n                            <div mat-menu-item class=\"delete-reply-button\" (click)=\"maybeDeleteReply(reply)\" trans>Delete</div>\r\n                            <div mat-menu-item class=\"show-original-reply-button\" (click)=\"showOriginalEmail(reply)\" trans>Show Original</div>\r\n                        </mat-menu>\r\n                    </div>\r\n                </div>\r\n                <div class=\"message-body\" [innerHTML]=\"reply.body\"></div>\r\n                <reply-attachment-list [attachments]=\"reply.uploads\" (detached)=\"removeAttachment(reply, $event)\" *ngIf=\"reply.uploads.length\"></reply-attachment-list>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</div>\r\n","import {Component, Inject, ViewEncapsulation} from '@angular/core';\r\nimport {Conversation} from '../conversation.service';\r\nimport {TicketsService} from '../../ticketing/tickets.service';\r\nimport {Draft} from '../draft.service';\r\nimport {ConversationReplies} from '../conversation-replies.service';\r\nimport {AfterReplyAction} from '../after-reply-action.service';\r\nimport {MailboxTagsService} from '../../ticketing/mailbox-tags.service';\r\nimport {Modal} from '@common/core/ui/dialogs/modal.service';\r\nimport {ConfirmModalComponent} from '@common/core/ui/confirm-modal/confirm-modal.component';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport {Ticket} from '../../shared/models/Ticket';\r\nimport {Router} from '@angular/router';\r\n\r\ninterface ConversationModalData {\r\n    ticketId: number;\r\n    activeTicketId?: number;\r\n}\r\n\r\n@Component({\r\n    selector: 'conversation-modal',\r\n    templateUrl: './conversation-modal.component.html',\r\n    styleUrls: ['./conversation-modal.component.scss'],\r\n    providers: [TicketsService, Conversation, Draft, ConversationReplies, AfterReplyAction],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationModalComponent {\r\n\r\n    /**\r\n     * ID of ticket that is currently active behind this modal, if any.\r\n     */\r\n    public activeTicketId: number;\r\n\r\n    constructor(\r\n        private dialogRef: MatDialogRef<ConversationModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: ConversationModalData,\r\n        private tickets: TicketsService,\r\n        private modal: Modal,\r\n        public conversation: Conversation,\r\n        private tags: MailboxTagsService,\r\n        private router: Router,\r\n    ) {\r\n        this.hydrate();\r\n    }\r\n\r\n    public close(ticket?: Ticket) {\r\n        this.dialogRef.close(ticket);\r\n    }\r\n\r\n    public openTicket() {\r\n        this.modal.closeAll();\r\n        this.router.navigate(\r\n            ['/mailbox/tickets/tag', this.conversation.getStatus().id, 'ticket', this.conversation.get().id]\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Merge currently active ticket with ticket displayed in this modal.\r\n     */\r\n    public mergeTickets() {\r\n        this.modal.show(ConfirmModalComponent, {\r\n            title: 'Merge Tickets',\r\n            body: 'Are you sure you want merge this ticket with the original one behind the pop-ups?',\r\n            bodyBold: 'Merged tickets can not be unmerged.',\r\n            ok: 'Merge'\r\n        }).afterClosed().subscribe(confirmed => {\r\n            if ( ! confirmed) return;\r\n            this.tickets.merge(this.activeTicketId, this.conversation.get().id).subscribe(ticket => {\r\n                this.close(ticket);\r\n                this.tags.refresh();\r\n            });\r\n        });\r\n    }\r\n\r\n    private hydrate() {\r\n        this.activeTicketId = this.data.activeTicketId;\r\n\r\n        this.tickets.get(this.data.ticketId).subscribe(response => {\r\n            this.conversation.init(response.ticket);\r\n        });\r\n    }\r\n}\r\n","<mat-dialog-content>\r\n    <conversation [hideSidebar]=\"true\" [hideBackButton]=\"true\">\r\n        <button (click)=\"openTicket()\" class=\"no-style icon-button action\" toolbar-content>\r\n            <mat-icon svgIcon=\"open-in-browser-custom\"></mat-icon>\r\n        </button>\r\n    </conversation>\r\n    <button class=\"merge-button\" mat-raised-button color=\"accent\" (click)=\"mergeTickets()\" *ngIf=\"activeTicketId\" trans>Merge</button>\r\n</mat-dialog-content>","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { prettyBytes } from '../core/utils/pretty-bytes';\r\n\r\n@Pipe({\r\n    name: 'formattedFileSize',\r\n    pure: true,\r\n})\r\nexport class FormattedFileSizePipe implements PipeTransform {\r\n    transform(bytes: number = 0, precision?: number|string): string {\r\n        if (isNaN(parseFloat(String(bytes))) || ! isFinite(bytes)) return '-';\r\n        return prettyBytes(bytes, precision);\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscribeToArray_1 = require(\"./subscribeToArray\");\nvar subscribeToPromise_1 = require(\"./subscribeToPromise\");\nvar subscribeToIterable_1 = require(\"./subscribeToIterable\");\nvar subscribeToObservable_1 = require(\"./subscribeToObservable\");\nvar isArrayLike_1 = require(\"./isArrayLike\");\nvar isPromise_1 = require(\"./isPromise\");\nvar isObject_1 = require(\"./isObject\");\nvar iterator_1 = require(\"../symbol/iterator\");\nvar observable_1 = require(\"../symbol/observable\");\nexports.subscribeTo = function (result) {\n    if (!!result && typeof result[observable_1.observable] === 'function') {\n        return subscribeToObservable_1.subscribeToObservable(result);\n    }\n    else if (isArrayLike_1.isArrayLike(result)) {\n        return subscribeToArray_1.subscribeToArray(result);\n    }\n    else if (isPromise_1.isPromise(result)) {\n        return subscribeToPromise_1.subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[iterator_1.iterator] === 'function') {\n        return subscribeToIterable_1.subscribeToIterable(result);\n    }\n    else {\n        var value = isObject_1.isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map","import {Category} from './Category';\n\nexport class Tag {\n    id: number;\n    name: string;\n    display_name: string;\n    type = 'custom';\n    created_at?: string;\n    updated_at?: string;\n    tickets_count?: number;\n    categories?: Category[];\n\n    constructor(params: Object = {}) {\n        for (const name in params) {\n            this[name] = params[name];\n        }\n    }\n}\n","import {Inject, Injectable, Injector} from '@angular/core';\r\nimport {FileEntry} from '../uploads/types/file-entry';\r\nimport {BehaviorSubject, Observable, Subject} from 'rxjs';\r\nimport {AVAILABLE_PREVIEWS, DefaultPreviews} from './available-previews';\r\nimport {ComponentPortal, PortalInjector} from '@angular/cdk/portal';\r\nimport {CURRENT_PREVIEW_FILE} from './current-preview-file';\r\nimport {DefaultPreviewComponent} from './default-preview/default-preview.component';\r\nimport {filter} from 'rxjs/operators';\r\nimport {PREVIEW_URL_TRANSFORMER, PreviewUrlTransformer} from './preview-url-transformer';\r\n\r\ninterface PreviewFilesMeta {\r\n    entry?: FileEntry;\r\n    pointer?: number;\r\n    total?: number;\r\n    haveNext?: boolean;\r\n    havePrevious?: boolean;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class PreviewFilesService {\r\n    private files: FileEntry[] = [];\r\n    private portal = new BehaviorSubject(null);\r\n    private meta: BehaviorSubject<PreviewFilesMeta> = new BehaviorSubject({});\r\n    private previewUriTransformer: PreviewUrlTransformer|null = null;\r\n    public download = new Subject();\r\n\r\n    constructor(\r\n        @Inject(AVAILABLE_PREVIEWS) private availablePreviews: DefaultPreviews,\r\n        private injector: Injector,\r\n    ) {}\r\n\r\n    public pagination(): Observable<PreviewFilesMeta> {\r\n        return this.meta\r\n            .pipe(filter(data => data && !!data.entry));\r\n    }\r\n\r\n    public getCurrent(): FileEntry {\r\n        return this.meta.value.entry;\r\n    }\r\n\r\n    public getAllEntries() {\r\n        return this.files;\r\n    }\r\n\r\n    public getPortal(): Observable<ComponentPortal<any>> {\r\n        return this.portal.asObservable();\r\n    }\r\n\r\n    public showNext() {\r\n        if ( ! this.meta.value.haveNext) return;\r\n        this.updateMeta('next');\r\n        this.updatePortal();\r\n    }\r\n\r\n    public showPrevious() {\r\n        if ( ! this.meta.value.havePrevious) return;\r\n        this.updateMeta('previous');\r\n        this.updatePortal();\r\n    }\r\n\r\n    private updateMeta(dir?: 'next'|'previous'|number) {\r\n        let newPointer = 0;\r\n\r\n        if (typeof dir === 'string') {\r\n            const oldPointer = this.meta.value.pointer;\r\n            newPointer = dir === 'next' ? oldPointer + 1 : oldPointer - 1;\r\n        } else if (typeof dir === 'number') {\r\n            newPointer = dir;\r\n        }\r\n\r\n        this.meta.next({\r\n            pointer: newPointer,\r\n            entry: this.files[newPointer],\r\n            total: this.files.length,\r\n            haveNext: (newPointer + 1) < this.files.length,\r\n            havePrevious: (newPointer - 1) > -1,\r\n        });\r\n    }\r\n\r\n    private updatePortal() {\r\n        const current = this.getCurrent();\r\n        const comp = (current && this.availablePreviews[current.type]) || DefaultPreviewComponent;\r\n        this.portal.next(new ComponentPortal(comp, null, this.createInjector()));\r\n    }\r\n\r\n    public set(files: FileEntry[], activeFile?: number) {\r\n        if ( ! files || files.length === 0) return;\r\n        this.files = files.filter(entry => entry.type !== 'folder');\r\n        this.updateMeta(activeFile);\r\n        this.updatePortal();\r\n    }\r\n\r\n    private createInjector(): PortalInjector {\r\n        const injectionTokens = new WeakMap();\r\n\r\n        // set currently active preview file\r\n        injectionTokens.set(CURRENT_PREVIEW_FILE, this.getCurrent());\r\n\r\n        // override preview backend uri, if specified\r\n        if (this.previewUriTransformer) {\r\n            injectionTokens.set(PREVIEW_URL_TRANSFORMER, this.previewUriTransformer);\r\n        }\r\n\r\n        return new PortalInjector(this.injector, injectionTokens);\r\n    }\r\n\r\n    public destroy() {\r\n        this.meta.next({});\r\n        this.files = null;\r\n        this.portal.next(null);\r\n    }\r\n\r\n    /**\r\n     * Provide transformer function for preview file backend url.\r\n     * (for changing base uri, adding url params etc)\r\n     */\r\n    public setPreviewUriTransformer(transformer: PreviewUrlTransformer) {\r\n        this.previewUriTransformer = transformer;\r\n    }\r\n}\r\n","import {Component, Inject, ViewChild, ViewEncapsulation} from '@angular/core';\r\nimport {CannedRepliesService} from '../canned-replies.service';\r\nimport {CannedReply} from '../../../shared/models/CannedReply';\r\nimport {TextEditorComponent} from '@common/text-editor/text-editor.component';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {UploadQueueService} from '@common/uploads/upload-queue/upload-queue.service';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\nimport {of} from 'rxjs';\r\nimport {delay, take} from 'rxjs/operators';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\n\r\ninterface CrupdateCannedReplyModalData {\r\n    cannedReply?: CannedReply;\r\n    contents?: {body?: string, uploads?: FileEntry[]};\r\n}\r\n\r\ninterface CrupdateCannedReplyModalErrors {\r\n    name?: string;\r\n    body?: string;\r\n    uploads?: string;\r\n    shared?: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'crupdate-canned-reply-modal',\r\n    templateUrl: './crupdate-canned-reply-modal.component.html',\r\n    styleUrls: ['./crupdate-canned-reply-modal.component.scss'],\r\n    providers: [UploadQueueService],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class CrupdateCannedReplyModalComponent {\r\n    @ViewChild('textEditor', { static: true }) textEditor: TextEditorComponent;\r\n\r\n    public attachments: FileEntry[] = [];\r\n    public model: CannedReply = new CannedReply();\r\n    public errors: CrupdateCannedReplyModalErrors = {};\r\n\r\n    constructor(\r\n        private dialogRef: MatDialogRef<CrupdateCannedReplyModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: CrupdateCannedReplyModalData,\r\n        private cannedReplies: CannedRepliesService,\r\n        public uploadQueue: UploadQueueService,\r\n    ) {\r\n        of(null).pipe(delay(0), take(1))\r\n            .subscribe(() => this.hydrate());\r\n    }\r\n\r\n    public close(cannedReply?: CannedReply) {\r\n        this.dialogRef.close(cannedReply);\r\n        this.textEditor.destroyEditor();\r\n    }\r\n\r\n    public confirm() {\r\n        let request;\r\n        const payload = this.getPayload();\r\n\r\n        if (this.model.id) {\r\n            request = this.cannedReplies.update(this.model.id, payload);\r\n        } else {\r\n            request = this.cannedReplies.create(payload);\r\n        }\r\n\r\n        request.subscribe(response => {\r\n            this.close(response.data);\r\n        }, errorResponse => this.errors = errorResponse.messages);\r\n    }\r\n\r\n    private getPayload(): Object {\r\n        return {\r\n            name: this.model.name,\r\n            body: this.textEditor.getContents(),\r\n            shared: this.model.shared,\r\n            uploads: this.attachments.map(attachment => attachment.id),\r\n        };\r\n    }\r\n\r\n    private setContents(contents: {body?: string, uploads?: FileEntry[]} = {}) {\r\n        if (contents.body) {\r\n            this.textEditor.setContents(contents.body);\r\n        }\r\n\r\n        if (contents.uploads) {\r\n            this.attachments = contents.uploads.slice();\r\n        }\r\n    }\r\n\r\n    private hydrate() {\r\n        // init modal with specified body and uploads\r\n        if (this.data.contents) {\r\n            this.setContents(this.data.contents);\r\n        }\r\n\r\n        // init modal using existing canned reply\r\n        if (this.data.cannedReply) {\r\n            this.model = new CannedReply(this.data.cannedReply);\r\n            this.setContents({body: this.model.body, uploads: this.model.uploads});\r\n        }\r\n    }\r\n\r\n    public uploadFiles(files: UploadedFile[]) {\r\n        this.uploadQueue.start(files).subscribe(response => {\r\n            this.attachments = [...this.attachments, response.fileEntry];\r\n        });\r\n    }\r\n\r\n    public removeAttachment(entry: FileEntry) {\r\n        for (let i = 0; i < this.attachments.length; i++) {\r\n            if (this.attachments[i].id === entry.id) {\r\n                this.attachments.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n","<div class=\"modal-header\">\r\n    <h2 mat-dialog-title>\r\n        <span *ngIf=\"model.id\" trans>Update Canned Reply</span>\r\n        <span *ngIf=\"!model.id\" trans>New Canned Reply</span>\r\n    </h2>\r\n    <button type=\"button\" mat-icon-button (click)=\"close()\" class=\"close-button\" tabindex=\"-1\">\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<form ngNativeValidate (ngSubmit)=\"confirm()\">\r\n    <mat-dialog-content class=\"many-inputs\">\r\n        <div class=\"input-container\">\r\n            <label for=\"canned-reply-name\" trans>Name</label>\r\n            <input type=\"text\" id=\"canned-reply-name\" name=\"canned-reply-name\" [(ngModel)]=\"model.name\">\r\n            <div class=\"error\" *ngIf=\"errors.name\">{{errors.name}}</div>\r\n        </div>\r\n\r\n        <div class=\"input-container\">\r\n            <label for=\"shared\" trans>Shared</label>\r\n            <select id=\"shared\" name=\"shared\" [(ngModel)]=\"model.shared\">\r\n                <option [ngValue]=\"true\" trans>Yes</option>\r\n                <option [ngValue]=\"false\" trans>No</option>\r\n            </select>\r\n            <div class=\"error\" *ngIf=\"errors.shared\">{{errors.shared}}</div>\r\n        </div>\r\n\r\n        <div class=\"input-container\">\r\n            <label for=\"canned-body\" trans>Canned Reply Body</label>\r\n            <text-editor id=\"canned-body\" inlineUploadPrefix=\"ticket_images\" #textEditor (onFileUpload)=\"uploadFiles($event)\" [minHeight]=\"300\"></text-editor>\r\n            <upload-progress-bar></upload-progress-bar>\r\n\r\n            <div class=\"error\" *ngIf=\"errors.body\">{{errors.body}}</div>\r\n            <div class=\"error\" *ngIf=\"errors.uploads\">{{errors.uploads}}</div>\r\n\r\n            <reply-attachment-list [attachments]=\"attachments\" *ngIf=\"attachments.length\" (detached)=\"removeAttachment($event)\"></reply-attachment-list>\r\n        </div>\r\n    </mat-dialog-content>\r\n\r\n    <mat-dialog-actions>\r\n        <button (click)=\"close()\" mat-button type=\"button\" class=\"cancel-button\" trans>Cancel</button>\r\n        <button type=\"submit\" mat-raised-button color=\"accent\" class=\"submit-button\">\r\n            <span *ngIf=\"model.id\" trans>Update</span>\r\n            <span *ngIf=\"!model.id\" trans>Create</span>\r\n        </button>\r\n    </mat-dialog-actions>\r\n</form>\r\n","<button mat-icon-button class=\"back-button\" (click)=\"closed.emit(true)\" *ngIf=\"showCloseButton\">\r\n    <mat-icon svgIcon=\"arrow-back\"></mat-icon>\r\n</button>\r\n<ng-container *ngIf=\"previewFiles.pagination() | async as pagination\">\r\n    <div class=\"entry-name\">\r\n        {{pagination.entry.name}}\r\n    </div>\r\n\r\n    <ng-container *ngIf=\"previewFiles.pagination() | async as pagination\">\r\n        <div class=\"navigation\">\r\n            <button mat-icon-button class=\"previous\" [disabled]=\"!pagination.havePrevious\" (click)=\"previewFiles.showPrevious()\">\r\n                <mat-icon svgIcon=\"keyboard-arrow-left\"></mat-icon>\r\n            </button>\r\n\r\n            <span class=\"meta\">{{pagination.pointer + 1}} of {{pagination.total}}</span>\r\n\r\n            <button mat-icon-button class=\"next\" [disabled]=\"!pagination.haveNext\" (click)=\"previewFiles.showNext()\">\r\n                <mat-icon svgIcon=\"keyboard-arrow-right\"></mat-icon>\r\n            </button>\r\n        </div>\r\n    </ng-container>\r\n\r\n    <div class=\"actions\">\r\n        <button mat-icon-button (click)=\"downloadFiles()\" [disabled]=\"disableDownload\">\r\n            <mat-icon svgIcon=\"file-download\"></mat-icon>\r\n        </button>\r\n        <ng-content></ng-content>\r\n    </div>\r\n</ng-container>\r\n<a routerLink=\"/drive\" class=\"logo\" *ngIf=\"showLogo && settings.has('branding.logo_light')\">\r\n    <img *ngIf=\"showLogo && settings.get('branding.logo_light')\" [src]=\"settings.getBaseUrl(true) + settings.get('branding.logo_light')\">\r\n</a>","import { Component, ViewEncapsulation, ChangeDetectionStrategy, Input, Output, EventEmitter } from '@angular/core';\r\nimport {PreviewFilesService} from '@common/file-preview/preview-files.service';\r\nimport {Settings} from '@common/core/config/settings.service';\r\n\r\n@Component({\r\n    selector: 'file-preview-toolbar',\r\n    templateUrl: './file-preview-toolbar.component.html',\r\n    styleUrls: ['./file-preview-toolbar.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FilePreviewToolbarComponent {\r\n    @Input() showLogo = false;\r\n    @Input() disableDownload = false;\r\n    @Input() showCloseButton = false;\r\n\r\n    @Output() closed = new EventEmitter();\r\n\r\n    constructor(\r\n        public previewFiles: PreviewFilesService,\r\n        public settings: Settings,\r\n    ) {}\r\n\r\n    public downloadFiles() {\r\n        this.previewFiles.download.next();\r\n    }\r\n}\r\n","import {Injectable} from '@angular/core';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class FileMime {\r\n\r\n    /**\r\n     * Map of mime file type to material design icon name.\r\n     */\r\n    private iconsMap = {\r\n        text: 'insert-drive-file',\r\n        audio: 'volume-up',\r\n        video: 'videocam',\r\n        document: 'assignment',\r\n        image: 'image'\r\n    };\r\n\r\n    /**\r\n     * Return file type based on specified mime.\r\n     */\r\n    public getFileType(mime: string): string {\r\n        return mime.split('/')[0];\r\n    }\r\n\r\n    /**\r\n     * Return icon name based on specified mime.\r\n     */\r\n    public getIconName(mime: string): string {\r\n        const type = this.getFileType(mime);\r\n        return this.iconsMap[type] || this.iconsMap['text'];\r\n    }\r\n}\r\n","import {\r\n    AfterViewInit,\r\n    ChangeDetectionStrategy,\r\n    Component,\r\n    ElementRef,\r\n    Inject,\r\n    OnDestroy,\r\n    OnInit,\r\n    ViewChild,\r\n} from '@angular/core';\r\nimport {Subscription} from 'rxjs';\r\nimport {OverlayPanelRef} from '@common/core/ui/overlay-panel/overlay-panel-ref';\r\nimport {PreviewFilesService} from '@common/file-preview/preview-files.service';\r\nimport {OVERLAY_PANEL_DATA} from '@common/core/ui/overlay-panel/overlay-panel-data';\r\nimport {Settings} from '@common/core/config/settings.service';\r\nimport {downloadFileFromUrl} from '@common/uploads/utils/download-file-from-url';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\n\r\nexport interface FilePreviewOverlayData {\r\n    entries: FileEntry[];\r\n    ticketEntry?: boolean;\r\n}\r\n\r\n@Component({\r\n    selector: 'file-preview-overlay',\r\n    templateUrl: './file-preview-overlay.component.html',\r\n    styleUrls: ['./file-preview-overlay.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FilePreviewOverlayComponent implements OnInit, AfterViewInit, OnDestroy {\r\n    public entries: FileEntry[] = [];\r\n    @ViewChild('previewContainer', { read: ElementRef, static: true }) previewContainer: ElementRef;\r\n    @ViewChild('moreOptionsButton', { read: ElementRef, static: false }) optionsButton: ElementRef;\r\n    private downloadSub: Subscription;\r\n\r\n    constructor(\r\n        private el: ElementRef,\r\n        private overlayRef: OverlayPanelRef,\r\n        private previewFiles: PreviewFilesService,\r\n        private settings: Settings,\r\n        @Inject(OVERLAY_PANEL_DATA) public data: FilePreviewOverlayData\r\n    ) {\r\n        this.entries = data.entries;\r\n    }\r\n\r\n    ngOnInit() {\r\n        if (this.data.ticketEntry) {\r\n            this.previewFiles.setPreviewUriTransformer(this.urlTransformer.bind(this));\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        this.bindToDownload();\r\n\r\n        this.previewContainer.nativeElement.addEventListener('click', e => {\r\n            if ( ! e.target.closest('.preview-object')) {\r\n                this.overlayRef.close();\r\n            }\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.downloadSub.unsubscribe();\r\n    }\r\n\r\n    public closeOverlay() {\r\n        this.overlayRef.close();\r\n    }\r\n\r\n    private bindToDownload() {\r\n        this.downloadSub = this.previewFiles.download.subscribe(() => {\r\n            const entries = this.previewFiles.getAllEntries();\r\n            this.downloadFile(entries);\r\n        });\r\n    }\r\n\r\n    private downloadFile(entries: FileEntry[]) {\r\n        const hashes = entries.map(entry => entry.hash).join(',');\r\n        let url = `${this.settings.getBaseUrl()}secure/uploads/download?hashes=${hashes}`;\r\n        if (this.data.ticketEntry) url += '&ticketEntry=true';\r\n        downloadFileFromUrl(url);\r\n    }\r\n\r\n    public urlTransformer(entry: FileEntry) {\r\n        return `${entry.url}?ticketEntry=true`;\r\n    }\r\n}\r\n","<file-preview-toolbar [showCloseButton]=\"true\" (closed)=\"closeOverlay()\"></file-preview-toolbar>\r\n<preview-container [files]=\"entries\" #previewContainer></preview-container>","<div class=\"attachments-list-item\" *ngFor=\"let attachment of attachments\" (click)=\"showPreviewOverlay(attachment)\">\r\n    <mat-icon class=\"attachment-info type-icon\" [svgIcon]=\"mime.getIconName(attachment.mime)\" [ngClass]=\"mime.getIconName(attachment.mime)\"></mat-icon>\r\n    <div class=\"attachment-info name\">{{ attachment.name }}</div>\r\n    <div class=\"attachment-info size\">{{ attachment.file_size | formattedFileSize }}</div>\r\n    <button class=\"remove-attachment\"\r\n            type=\"button\"\r\n            mat-icon-button\r\n            *ngIf=\"cancelButtonVisible\"\r\n            (click)=\"detachEntry(attachment); $event.stopPropagation()\"\r\n    >\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n","import {ChangeDetectionStrategy, Component, EventEmitter, Input, Output, ViewEncapsulation} from '@angular/core';\r\nimport {FileMime} from '../file-mime.service';\r\nimport {OverlayPanel} from '@common/core/ui/overlay-panel/overlay-panel.service';\r\nimport {UploadQueueService} from '@common/uploads/upload-queue/upload-queue.service';\r\nimport {FilePreviewOverlayComponent} from '../file-preview-overlay/file-preview-overlay.component';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\n\r\n@Component({\r\n    selector: 'reply-attachment-list',\r\n    templateUrl: './reply-attachment-list.component.html',\r\n    styleUrls: ['./reply-attachment-list.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ReplyAttachmentListComponent {\r\n    @Input() attachments: FileEntry[];\r\n    @Input() cancelButtonVisible = true;\r\n\r\n    @Output() detached: EventEmitter<FileEntry> = new EventEmitter();\r\n\r\n    constructor(\r\n        public mime: FileMime,\r\n        private overlay: OverlayPanel,\r\n        public uploadQueue: UploadQueueService,\r\n    ) {\r\n    }\r\n\r\n    public detachEntry(entry: FileEntry) {\r\n        const i = this.attachments.findIndex(ent => ent.id === entry.id);\r\n        if (i > -1) {\r\n            this.attachments.splice(i, 1);\r\n            this.detached.emit(entry);\r\n        }\r\n    }\r\n\r\n    public showPreviewOverlay(attachment: FileEntry) {\r\n        this.overlay.open(FilePreviewOverlayComponent, {\r\n                position: 'center',\r\n                origin: 'global',\r\n                data: {entries: [attachment], ticketEntry: true}\r\n            },\r\n        );\r\n    }\r\n}\r\n","import {ChangeDetectionStrategy, Component, Inject, OnInit} from '@angular/core';\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\nimport {FormControl} from '@angular/forms';\nimport {catchError, debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {BehaviorSubject, Observable, of} from 'rxjs';\nimport {Users} from '../users.service';\nimport {User} from '../../core/types/models/User';\n\n@Component({\n    selector: 'find-user-modal',\n    templateUrl: './find-user-modal.component.html',\n    styleUrls: ['./find-user-modal.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class FindUserModalComponent implements OnInit {\n    public searchFormControl = new FormControl();\n    public loading$ = new BehaviorSubject(false);\n    public users$ = new BehaviorSubject<User[]>([]);\n\n    constructor(\n        private dialogRef: MatDialogRef<FindUserModalComponent>,\n        @Inject(MAT_DIALOG_DATA) public data: FindUserModalComponent,\n        private users: Users,\n    ) {}\n\n    ngOnInit() {\n        this.searchFormControl.valueChanges\n            .pipe(\n                debounceTime(250),\n                distinctUntilChanged(),\n                switchMap(query => this.searchUsers(query)),\n                catchError(() => of([])),\n            ).subscribe(users => {\n                this.users$.next(users);\n                this.loading$.next(false);\n            });\n    }\n\n    private searchUsers(query: string): Observable<User[]> {\n        this.loading$.next(true);\n        if ( ! query) {\n            return of([]);\n        }\n        return this.users.getAll({query});\n    }\n\n    public close(user?: User) {\n        this.dialogRef.close(user);\n    }\n}\n","<div class=\"modal-header\">\n    <h2 mat-dialog-title trans>Find User</h2>\n    <button type=\"button\" (click)=\"close()\" class=\"no-style close-button\" tabindex=\"-1\">\n        <mat-icon svgIcon=\"close\"></mat-icon>\n    </button>\n</div>\n\n<mat-dialog-content>\n    <div class=\"input-container search-input-container\">\n        <input type=\"text\" placeholder=\"Search for user by name or email...\" [formControl]=\"searchFormControl\">\n        <loading-indicator [isVisible]=\"loading$ | async\" class=\"small\"></loading-indicator>\n    </div>\n\n    <div class=\"users\">\n        <div class=\"user\" *ngFor=\"let user of users$ | async\" (click)=\"close(user)\">\n            <img [src]=\"user.avatar\">\n            <div class=\"meta overflow-hidden\">\n                <div class=\"name overflow-hidden\">{{user.display_name}}</div>\n                <div class=\"email overflow-hidden\">{{user.email}}</div>\n            </div>\n        </div>\n    </div>\n</mat-dialog-content>","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\nexports.isPromise = isPromise;\n//# sourceMappingURL=isPromise.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar noop_1 = require(\"./noop\");\nfunction pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexports.pipe = pipe;\nfunction pipeFromArray(fns) {\n    if (!fns) {\n        return noop_1.noop;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\nexports.pipeFromArray = pipeFromArray;\n//# sourceMappingURL=pipe.js.map","<ng-container>\r\n    <div class=\"conversation-container\">\r\n        <conversation-toolbar [hideBackButton]=\"hideBackButton\">\r\n            <ng-content select=\"[toolbar-content]\"></ng-content>\r\n        </conversation-toolbar>\r\n\r\n        <div class=\"ticket-container\" conversationInfiniteScroll>\r\n            <conversation-header></conversation-header>\r\n            <conversation-text-editor></conversation-text-editor>\r\n            <conversation-replies></conversation-replies>\r\n        </div>\r\n    </div>\r\n\r\n    <conversation-sidebar *ngIf=\"!hideSidebar\"></conversation-sidebar>\r\n</ng-container>\r\n\r\n<loading-indicator [isVisible]=\"conversation.replies.isLoading || conversation.isLoading\" class=\"overlay\"></loading-indicator>\r\n\r\n","import {Component, ElementRef, Input, OnInit, ViewEncapsulation} from '@angular/core';\r\nimport {Conversation} from './conversation.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {UploadsApiService} from '@common/uploads/uploads-api.service';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\n\r\n@Component({\r\n    selector: 'conversation',\r\n    templateUrl: './conversation.component.html',\r\n    styleUrls: ['./conversation.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationComponent implements OnInit {\r\n\r\n    /**\r\n     * If back button should be visible.\r\n     */\r\n    @Input() hideBackButton = false;\r\n\r\n    /**\r\n     * If conversation sidebar should be hidden.\r\n     */\r\n    @Input() hideSidebar = false;\r\n\r\n    constructor(\r\n        private route: ActivatedRoute,\r\n        public uploads: UploadsApiService,\r\n        public currentUser: CurrentUser,\r\n        public conversation: Conversation,\r\n        private el: ElementRef<HTMLElement>,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.route.data.subscribe(data => {\r\n            this.conversation.init(data.ticket);\r\n            this.el.nativeElement.focus();\r\n        });\r\n    }\r\n}\r\n","import { SPACE, BACKSPACE, DELETE, HOME, END, TAB, hasModifierKey, ENTER } from '@angular/cdk/keycodes';\nimport { Directive, EventEmitter, ElementRef, NgZone, Optional, Inject, ChangeDetectorRef, ContentChild, forwardRef, Input, Output, InjectionToken, Component, ViewEncapsulation, ChangeDetectionStrategy, Self, ContentChildren, NgModule } from '@angular/core';\nimport { mixinColor, mixinDisableRipple, mixinDisabled, RippleRenderer, MAT_RIPPLE_GLOBAL_OPTIONS, mixinErrorState, ErrorStateMatcher } from '@angular/material/core';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport { Platform } from '@angular/cdk/platform';\nimport { Subject, merge } from 'rxjs';\nimport { take, takeUntil, startWith } from 'rxjs/operators';\nimport { ANIMATION_MODULE_TYPE } from '@angular/platform-browser/animations';\nimport { FocusKeyManager } from '@angular/cdk/a11y';\nimport { Directionality } from '@angular/cdk/bidi';\nimport { SelectionModel } from '@angular/cdk/collections';\nimport { NgForm, FormGroupDirective, NgControl } from '@angular/forms';\nimport { MatFormFieldControl } from '@angular/material/form-field';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/material/chips/chip.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * Represents an event fired on an individual `mat-chip`.\n * @record\n */\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/cdk/platform';\nimport * as ɵngcc2 from '@angular/cdk/bidi';\nimport * as ɵngcc3 from '@angular/forms';\nimport * as ɵngcc4 from '@angular/material/core';\n\nconst _c0 = [\"*\"];\nfunction MatChipEvent() { }\nif (false) {\n    /**\n     * The chip the event was fired on.\n     * @type {?}\n     */\n    MatChipEvent.prototype.chip;\n}\n/**\n * Event object emitted by MatChip when selected or deselected.\n */\nclass MatChipSelectionChange {\n    /**\n     * @param {?} source\n     * @param {?} selected\n     * @param {?=} isUserInput\n     */\n    constructor(source, selected, isUserInput = false) {\n        this.source = source;\n        this.selected = selected;\n        this.isUserInput = isUserInput;\n    }\n}\nif (false) {\n    /**\n     * Reference to the chip that emitted the event.\n     * @type {?}\n     */\n    MatChipSelectionChange.prototype.source;\n    /**\n     * Whether the chip that emitted the event is selected.\n     * @type {?}\n     */\n    MatChipSelectionChange.prototype.selected;\n    /**\n     * Whether the selection change was a result of a user interaction.\n     * @type {?}\n     */\n    MatChipSelectionChange.prototype.isUserInput;\n}\n// Boilerplate for applying mixins to MatChip.\n/**\n * \\@docs-private\n */\nclass MatChipBase {\n    /**\n     * @param {?} _elementRef\n     */\n    constructor(_elementRef) {\n        this._elementRef = _elementRef;\n    }\n}\nif (false) {\n    /** @type {?} */\n    MatChipBase.prototype._elementRef;\n}\n/** @type {?} */\nconst _MatChipMixinBase = mixinColor(mixinDisableRipple(mixinDisabled(MatChipBase)), 'primary');\n/**\n * Dummy directive to add CSS class to chip avatar.\n * \\@docs-private\n */\nclass MatChipAvatar {\n}\nMatChipAvatar.ɵfac = function MatChipAvatar_Factory(t) { return new (t || MatChipAvatar)(); };\nMatChipAvatar.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MatChipAvatar, selectors: [[\"mat-chip-avatar\"], [\"\", \"matChipAvatar\", \"\"]], hostAttrs: [1, \"mat-chip-avatar\"] });\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChipAvatar, [{\n        type: Directive,\n        args: [{\n                selector: 'mat-chip-avatar, [matChipAvatar]',\n                host: { 'class': 'mat-chip-avatar' }\n            }]\n    }], null, null); })();\n/**\n * Dummy directive to add CSS class to chip trailing icon.\n * \\@docs-private\n */\nclass MatChipTrailingIcon {\n}\nMatChipTrailingIcon.ɵfac = function MatChipTrailingIcon_Factory(t) { return new (t || MatChipTrailingIcon)(); };\nMatChipTrailingIcon.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MatChipTrailingIcon, selectors: [[\"mat-chip-trailing-icon\"], [\"\", \"matChipTrailingIcon\", \"\"]], hostAttrs: [1, \"mat-chip-trailing-icon\"] });\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChipTrailingIcon, [{\n        type: Directive,\n        args: [{\n                selector: 'mat-chip-trailing-icon, [matChipTrailingIcon]',\n                host: { 'class': 'mat-chip-trailing-icon' }\n            }]\n    }], null, null); })();\n/**\n * Material design styled Chip component. Used inside the MatChipList component.\n */\nclass MatChip extends _MatChipMixinBase {\n    /**\n     * @param {?} _elementRef\n     * @param {?} _ngZone\n     * @param {?} platform\n     * @param {?} globalRippleOptions\n     * @param {?=} animationMode\n     * @param {?=} _changeDetectorRef\n     */\n    constructor(_elementRef, _ngZone, platform, globalRippleOptions, \n    // @breaking-change 8.0.0 `animationMode` parameter to become required.\n    animationMode, _changeDetectorRef) {\n        super(_elementRef);\n        this._elementRef = _elementRef;\n        this._ngZone = _ngZone;\n        this._changeDetectorRef = _changeDetectorRef;\n        /**\n         * Whether the chip has focus.\n         */\n        this._hasFocus = false;\n        /**\n         * Whether the chip list is selectable\n         */\n        this.chipListSelectable = true;\n        /**\n         * Whether the chip list is in multi-selection mode.\n         */\n        this._chipListMultiple = false;\n        this._selected = false;\n        this._selectable = true;\n        this._removable = true;\n        /**\n         * Emits when the chip is focused.\n         */\n        this._onFocus = new Subject();\n        /**\n         * Emits when the chip is blured.\n         */\n        this._onBlur = new Subject();\n        /**\n         * Emitted when the chip is selected or deselected.\n         */\n        this.selectionChange = new EventEmitter();\n        /**\n         * Emitted when the chip is destroyed.\n         */\n        this.destroyed = new EventEmitter();\n        /**\n         * Emitted when a chip is to be removed.\n         */\n        this.removed = new EventEmitter();\n        this._addHostClassName();\n        this._chipRipple = new RippleRenderer(this, _ngZone, _elementRef, platform);\n        this._chipRipple.setupTriggerEvents(_elementRef);\n        this.rippleConfig = globalRippleOptions || {};\n        this._animationsDisabled = animationMode === 'NoopAnimations';\n    }\n    /**\n     * Whether ripples are disabled on interaction\n     * \\@docs-private\n     * @return {?}\n     */\n    get rippleDisabled() {\n        return this.disabled || this.disableRipple || !!this.rippleConfig.disabled;\n    }\n    /**\n     * Whether the chip is selected.\n     * @return {?}\n     */\n    get selected() { return this._selected; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set selected(value) {\n        /** @type {?} */\n        const coercedValue = coerceBooleanProperty(value);\n        if (coercedValue !== this._selected) {\n            this._selected = coercedValue;\n            this._dispatchSelectionChange();\n        }\n    }\n    /**\n     * The value of the chip. Defaults to the content inside `<mat-chip>` tags.\n     * @return {?}\n     */\n    get value() {\n        return this._value !== undefined\n            ? this._value\n            : this._elementRef.nativeElement.textContent;\n    }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set value(value) { this._value = value; }\n    /**\n     * Whether or not the chip is selectable. When a chip is not selectable,\n     * changes to its selected state are always ignored. By default a chip is\n     * selectable, and it becomes non-selectable if its parent chip list is\n     * not selectable.\n     * @return {?}\n     */\n    get selectable() { return this._selectable && this.chipListSelectable; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set selectable(value) {\n        this._selectable = coerceBooleanProperty(value);\n    }\n    /**\n     * Determines whether or not the chip displays the remove styling and emits (removed) events.\n     * @return {?}\n     */\n    get removable() { return this._removable; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set removable(value) {\n        this._removable = coerceBooleanProperty(value);\n    }\n    /**\n     * The ARIA selected applied to the chip.\n     * @return {?}\n     */\n    get ariaSelected() {\n        // Remove the `aria-selected` when the chip is deselected in single-selection mode, because\n        // it adds noise to NVDA users where \"not selected\" will be read out for each chip.\n        return this.selectable && (this._chipListMultiple || this.selected) ?\n            this.selected.toString() : null;\n    }\n    /**\n     * @return {?}\n     */\n    _addHostClassName() {\n        /** @type {?} */\n        const basicChipAttrName = 'mat-basic-chip';\n        /** @type {?} */\n        const element = (/** @type {?} */ (this._elementRef.nativeElement));\n        if (element.hasAttribute(basicChipAttrName) ||\n            element.tagName.toLowerCase() === basicChipAttrName) {\n            element.classList.add(basicChipAttrName);\n            return;\n        }\n        else {\n            element.classList.add('mat-standard-chip');\n        }\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.destroyed.emit({ chip: this });\n        this._chipRipple._removeTriggerEvents();\n    }\n    /**\n     * Selects the chip.\n     * @return {?}\n     */\n    select() {\n        if (!this._selected) {\n            this._selected = true;\n            this._dispatchSelectionChange();\n            this._markForCheck();\n        }\n    }\n    /**\n     * Deselects the chip.\n     * @return {?}\n     */\n    deselect() {\n        if (this._selected) {\n            this._selected = false;\n            this._dispatchSelectionChange();\n            this._markForCheck();\n        }\n    }\n    /**\n     * Select this chip and emit selected event\n     * @return {?}\n     */\n    selectViaInteraction() {\n        if (!this._selected) {\n            this._selected = true;\n            this._dispatchSelectionChange(true);\n            this._markForCheck();\n        }\n    }\n    /**\n     * Toggles the current selected state of this chip.\n     * @param {?=} isUserInput\n     * @return {?}\n     */\n    toggleSelected(isUserInput = false) {\n        this._selected = !this.selected;\n        this._dispatchSelectionChange(isUserInput);\n        this._markForCheck();\n        return this.selected;\n    }\n    /**\n     * Allows for programmatic focusing of the chip.\n     * @return {?}\n     */\n    focus() {\n        if (!this._hasFocus) {\n            this._elementRef.nativeElement.focus();\n            this._onFocus.next({ chip: this });\n        }\n        this._hasFocus = true;\n    }\n    /**\n     * Allows for programmatic removal of the chip. Called by the MatChipList when the DELETE or\n     * BACKSPACE keys are pressed.\n     *\n     * Informs any listeners of the removal request. Does not remove the chip from the DOM.\n     * @return {?}\n     */\n    remove() {\n        if (this.removable) {\n            this.removed.emit({ chip: this });\n        }\n    }\n    /**\n     * Handles click events on the chip.\n     * @param {?} event\n     * @return {?}\n     */\n    _handleClick(event) {\n        if (this.disabled) {\n            event.preventDefault();\n        }\n        else {\n            event.stopPropagation();\n        }\n    }\n    /**\n     * Handle custom key presses.\n     * @param {?} event\n     * @return {?}\n     */\n    _handleKeydown(event) {\n        if (this.disabled) {\n            return;\n        }\n        switch (event.keyCode) {\n            case DELETE:\n            case BACKSPACE:\n                // If we are removable, remove the focused chip\n                this.remove();\n                // Always prevent so page navigation does not occur\n                event.preventDefault();\n                break;\n            case SPACE:\n                // If we are selectable, toggle the focused chip\n                if (this.selectable) {\n                    this.toggleSelected(true);\n                }\n                // Always prevent space from scrolling the page since the list has focus\n                event.preventDefault();\n                break;\n        }\n    }\n    /**\n     * @return {?}\n     */\n    _blur() {\n        // When animations are enabled, Angular may end up removing the chip from the DOM a little\n        // earlier than usual, causing it to be blurred and throwing off the logic in the chip list\n        // that moves focus not the next item. To work around the issue, we defer marking the chip\n        // as not focused until the next time the zone stabilizes.\n        this._ngZone.onStable\n            .asObservable()\n            .pipe(take(1))\n            .subscribe((/**\n         * @return {?}\n         */\n        () => {\n            this._ngZone.run((/**\n             * @return {?}\n             */\n            () => {\n                this._hasFocus = false;\n                this._onBlur.next({ chip: this });\n            }));\n        }));\n    }\n    /**\n     * @private\n     * @param {?=} isUserInput\n     * @return {?}\n     */\n    _dispatchSelectionChange(isUserInput = false) {\n        this.selectionChange.emit({\n            source: this,\n            isUserInput,\n            selected: this._selected\n        });\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    _markForCheck() {\n        // @breaking-change 9.0.0 Remove this method once the _changeDetectorRef is a required param.\n        if (this._changeDetectorRef) {\n            this._changeDetectorRef.markForCheck();\n        }\n    }\n}\nMatChip.ɵfac = function MatChip_Factory(t) { return new (t || MatChip)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.Platform), ɵngcc0.ɵɵdirectiveInject(MAT_RIPPLE_GLOBAL_OPTIONS, 8), ɵngcc0.ɵɵdirectiveInject(ANIMATION_MODULE_TYPE, 8), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };\nMatChip.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MatChip, selectors: [[\"mat-basic-chip\"], [\"\", \"mat-basic-chip\", \"\"], [\"mat-chip\"], [\"\", \"mat-chip\", \"\"]], contentQueries: function MatChip_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {\n        ɵngcc0.ɵɵcontentQuery(dirIndex, MatChipAvatar, true);\n        ɵngcc0.ɵɵcontentQuery(dirIndex, MatChipTrailingIcon, true);\n        ɵngcc0.ɵɵcontentQuery(dirIndex, MatChipRemove, true);\n    } if (rf & 2) {\n        var _t;\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.avatar = _t.first);\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.trailingIcon = _t.first);\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.removeIcon = _t.first);\n    } }, hostAttrs: [\"role\", \"option\", 1, \"mat-chip\"], hostVars: 14, hostBindings: function MatChip_HostBindings(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵlistener(\"click\", function MatChip_click_HostBindingHandler($event) { return ctx._handleClick($event); })(\"keydown\", function MatChip_keydown_HostBindingHandler($event) { return ctx._handleKeydown($event); })(\"focus\", function MatChip_focus_HostBindingHandler($event) { return ctx.focus(); })(\"blur\", function MatChip_blur_HostBindingHandler($event) { return ctx._blur(); });\n    } if (rf & 2) {\n        ɵngcc0.ɵɵattribute(\"tabindex\", ctx.disabled ? null : 0 - 1)(\"disabled\", ctx.disabled || null)(\"aria-disabled\", ctx.disabled.toString())(\"aria-selected\", ctx.ariaSelected);\n        ɵngcc0.ɵɵclassProp(\"mat-chip-selected\", ctx.selected)(\"mat-chip-with-avatar\", ctx.avatar)(\"mat-chip-with-trailing-icon\", ctx.trailingIcon || ctx.removeIcon)(\"mat-chip-disabled\", ctx.disabled)(\"_mat-animation-noopable\", ctx._animationsDisabled);\n    } }, inputs: { color: \"color\", disabled: \"disabled\", disableRipple: \"disableRipple\", selected: \"selected\", value: \"value\", selectable: \"selectable\", removable: \"removable\" }, outputs: { selectionChange: \"selectionChange\", destroyed: \"destroyed\", removed: \"removed\" }, exportAs: [\"matChip\"], features: [ɵngcc0.ɵɵInheritDefinitionFeature] });\n/** @nocollapse */\nMatChip.ctorParameters = () => [\n    { type: ElementRef },\n    { type: NgZone },\n    { type: Platform },\n    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [MAT_RIPPLE_GLOBAL_OPTIONS,] }] },\n    { type: String, decorators: [{ type: Optional }, { type: Inject, args: [ANIMATION_MODULE_TYPE,] }] },\n    { type: ChangeDetectorRef }\n];\nMatChip.propDecorators = {\n    avatar: [{ type: ContentChild, args: [MatChipAvatar,] }],\n    trailingIcon: [{ type: ContentChild, args: [MatChipTrailingIcon,] }],\n    removeIcon: [{ type: ContentChild, args: [forwardRef((/**\n                 * @return {?}\n                 */\n                () => MatChipRemove)),] }],\n    selected: [{ type: Input }],\n    value: [{ type: Input }],\n    selectable: [{ type: Input }],\n    removable: [{ type: Input }],\n    selectionChange: [{ type: Output }],\n    destroyed: [{ type: Output }],\n    removed: [{ type: Output }]\n};\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChip, [{\n        type: Directive,\n        args: [{\n                selector: `mat-basic-chip, [mat-basic-chip], mat-chip, [mat-chip]`,\n                inputs: ['color', 'disabled', 'disableRipple'],\n                exportAs: 'matChip',\n                host: {\n                    'class': 'mat-chip',\n                    '[attr.tabindex]': 'disabled ? null : -1',\n                    'role': 'option',\n                    '[class.mat-chip-selected]': 'selected',\n                    '[class.mat-chip-with-avatar]': 'avatar',\n                    '[class.mat-chip-with-trailing-icon]': 'trailingIcon || removeIcon',\n                    '[class.mat-chip-disabled]': 'disabled',\n                    '[class._mat-animation-noopable]': '_animationsDisabled',\n                    '[attr.disabled]': 'disabled || null',\n                    '[attr.aria-disabled]': 'disabled.toString()',\n                    '[attr.aria-selected]': 'ariaSelected',\n                    '(click)': '_handleClick($event)',\n                    '(keydown)': '_handleKeydown($event)',\n                    '(focus)': 'focus()',\n                    '(blur)': '_blur()'\n                }\n            }]\n    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }, { type: ɵngcc1.Platform }, { type: undefined, decorators: [{\n                type: Optional\n            }, {\n                type: Inject,\n                args: [MAT_RIPPLE_GLOBAL_OPTIONS]\n            }] }, { type: String, decorators: [{\n                type: Optional\n            }, {\n                type: Inject,\n                args: [ANIMATION_MODULE_TYPE]\n            }] }, { type: ɵngcc0.ChangeDetectorRef }]; }, { selectionChange: [{\n            type: Output\n        }], destroyed: [{\n            type: Output\n        }], removed: [{\n            type: Output\n        }], selected: [{\n            type: Input\n        }], value: [{\n            type: Input\n        }], selectable: [{\n            type: Input\n        }], removable: [{\n            type: Input\n        }], avatar: [{\n            type: ContentChild,\n            args: [MatChipAvatar]\n        }], trailingIcon: [{\n            type: ContentChild,\n            args: [MatChipTrailingIcon]\n        }], removeIcon: [{\n            type: ContentChild,\n            args: [forwardRef(( /**\n                             * @return {?}\n                             */() => MatChipRemove))]\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    MatChip.ngAcceptInputType_selected;\n    /** @type {?} */\n    MatChip.ngAcceptInputType_selectable;\n    /** @type {?} */\n    MatChip.ngAcceptInputType_removable;\n    /** @type {?} */\n    MatChip.ngAcceptInputType_disabled;\n    /** @type {?} */\n    MatChip.ngAcceptInputType_disableRipple;\n    /**\n     * Reference to the RippleRenderer for the chip.\n     * @type {?}\n     * @private\n     */\n    MatChip.prototype._chipRipple;\n    /**\n     * Ripple configuration for ripples that are launched on pointer down. The ripple config\n     * is set to the global ripple options since we don't have any configurable options for\n     * the chip ripples.\n     * \\@docs-private\n     * @type {?}\n     */\n    MatChip.prototype.rippleConfig;\n    /**\n     * Whether the chip has focus.\n     * @type {?}\n     */\n    MatChip.prototype._hasFocus;\n    /**\n     * Whether animations for the chip are enabled.\n     * @type {?}\n     */\n    MatChip.prototype._animationsDisabled;\n    /**\n     * Whether the chip list is selectable\n     * @type {?}\n     */\n    MatChip.prototype.chipListSelectable;\n    /**\n     * Whether the chip list is in multi-selection mode.\n     * @type {?}\n     */\n    MatChip.prototype._chipListMultiple;\n    /**\n     * The chip avatar\n     * @type {?}\n     */\n    MatChip.prototype.avatar;\n    /**\n     * The chip's trailing icon.\n     * @type {?}\n     */\n    MatChip.prototype.trailingIcon;\n    /**\n     * The chip's remove toggler.\n     * @type {?}\n     */\n    MatChip.prototype.removeIcon;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChip.prototype._selected;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChip.prototype._value;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChip.prototype._selectable;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChip.prototype._removable;\n    /**\n     * Emits when the chip is focused.\n     * @type {?}\n     */\n    MatChip.prototype._onFocus;\n    /**\n     * Emits when the chip is blured.\n     * @type {?}\n     */\n    MatChip.prototype._onBlur;\n    /**\n     * Emitted when the chip is selected or deselected.\n     * @type {?}\n     */\n    MatChip.prototype.selectionChange;\n    /**\n     * Emitted when the chip is destroyed.\n     * @type {?}\n     */\n    MatChip.prototype.destroyed;\n    /**\n     * Emitted when a chip is to be removed.\n     * @type {?}\n     */\n    MatChip.prototype.removed;\n    /** @type {?} */\n    MatChip.prototype._elementRef;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChip.prototype._ngZone;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChip.prototype._changeDetectorRef;\n}\n/**\n * Applies proper (click) support and adds styling for use with the Material Design \"cancel\" icon\n * available at https://material.io/icons/#ic_cancel.\n *\n * Example:\n *\n *     `<mat-chip>\n *       <mat-icon matChipRemove>cancel</mat-icon>\n *     </mat-chip>`\n *\n * You *may* use a custom icon, but you may need to override the `mat-chip-remove` positioning\n * styles to properly center the icon within the chip.\n */\nclass MatChipRemove {\n    /**\n     * @param {?} _parentChip\n     */\n    constructor(_parentChip) {\n        this._parentChip = _parentChip;\n    }\n    /**\n     * Calls the parent chip's public `remove()` method if applicable.\n     * @param {?} event\n     * @return {?}\n     */\n    _handleClick(event) {\n        /** @type {?} */\n        const parentChip = this._parentChip;\n        if (parentChip.removable && !parentChip.disabled) {\n            parentChip.remove();\n        }\n        // We need to stop event propagation because otherwise the event will bubble up to the\n        // form field and cause the `onContainerClick` method to be invoked. This method would then\n        // reset the focused chip that has been focused after chip removal. Usually the parent\n        // the parent click listener of the `MatChip` would prevent propagation, but it can happen\n        // that the chip is being removed before the event bubbles up.\n        event.stopPropagation();\n    }\n}\nMatChipRemove.ɵfac = function MatChipRemove_Factory(t) { return new (t || MatChipRemove)(ɵngcc0.ɵɵdirectiveInject(MatChip)); };\nMatChipRemove.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MatChipRemove, selectors: [[\"\", \"matChipRemove\", \"\"]], hostAttrs: [\"type\", \"button\", 1, \"mat-chip-remove\", \"mat-chip-trailing-icon\"], hostBindings: function MatChipRemove_HostBindings(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵlistener(\"click\", function MatChipRemove_click_HostBindingHandler($event) { return ctx._handleClick($event); });\n    } } });\n/** @nocollapse */\nMatChipRemove.ctorParameters = () => [\n    { type: MatChip }\n];\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChipRemove, [{\n        type: Directive,\n        args: [{\n                selector: '[matChipRemove]',\n                host: {\n                    'class': 'mat-chip-remove mat-chip-trailing-icon',\n                    '(click)': '_handleClick($event)',\n                    // Prevent accidental form submissions.\n                    'type': 'button'\n                }\n            }]\n    }], function () { return [{ type: MatChip }]; }, null); })();\nif (false) {\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipRemove.prototype._parentChip;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/material/chips/chip-default-options.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * Default options, for the chips module, that can be overridden.\n * @record\n */\nfunction MatChipsDefaultOptions() { }\nif (false) {\n    /**\n     * The list of key codes that will trigger a chipEnd event.\n     * @type {?}\n     */\n    MatChipsDefaultOptions.prototype.separatorKeyCodes;\n}\n/**\n * Injection token to be used to override the default options for the chips module.\n * @type {?}\n */\nconst MAT_CHIPS_DEFAULT_OPTIONS = new InjectionToken('mat-chips-default-options');\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/material/chips/chip-list.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n// Boilerplate for applying mixins to MatChipList.\n/**\n * \\@docs-private\n */\nclass MatChipListBase {\n    /**\n     * @param {?} _defaultErrorStateMatcher\n     * @param {?} _parentForm\n     * @param {?} _parentFormGroup\n     * @param {?} ngControl\n     */\n    constructor(_defaultErrorStateMatcher, _parentForm, _parentFormGroup, ngControl) {\n        this._defaultErrorStateMatcher = _defaultErrorStateMatcher;\n        this._parentForm = _parentForm;\n        this._parentFormGroup = _parentFormGroup;\n        this.ngControl = ngControl;\n    }\n}\nif (false) {\n    /** @type {?} */\n    MatChipListBase.prototype._defaultErrorStateMatcher;\n    /** @type {?} */\n    MatChipListBase.prototype._parentForm;\n    /** @type {?} */\n    MatChipListBase.prototype._parentFormGroup;\n    /**\n     * \\@docs-private\n     * @type {?}\n     */\n    MatChipListBase.prototype.ngControl;\n}\n/** @type {?} */\nconst _MatChipListMixinBase = mixinErrorState(MatChipListBase);\n// Increasing integer for generating unique ids for chip-list components.\n/** @type {?} */\nlet nextUniqueId = 0;\n/**\n * Change event object that is emitted when the chip list value has changed.\n */\nclass MatChipListChange {\n    /**\n     * @param {?} source\n     * @param {?} value\n     */\n    constructor(source, value) {\n        this.source = source;\n        this.value = value;\n    }\n}\nif (false) {\n    /**\n     * Chip list that emitted the event.\n     * @type {?}\n     */\n    MatChipListChange.prototype.source;\n    /**\n     * Value of the chip list when the event was emitted.\n     * @type {?}\n     */\n    MatChipListChange.prototype.value;\n}\n/**\n * A material design chips component (named ChipList for its similarity to the List component).\n */\nclass MatChipList extends _MatChipListMixinBase {\n    /**\n     * @param {?} _elementRef\n     * @param {?} _changeDetectorRef\n     * @param {?} _dir\n     * @param {?} _parentForm\n     * @param {?} _parentFormGroup\n     * @param {?} _defaultErrorStateMatcher\n     * @param {?} ngControl\n     */\n    constructor(_elementRef, _changeDetectorRef, _dir, _parentForm, _parentFormGroup, _defaultErrorStateMatcher, ngControl) {\n        super(_defaultErrorStateMatcher, _parentForm, _parentFormGroup, ngControl);\n        this._elementRef = _elementRef;\n        this._changeDetectorRef = _changeDetectorRef;\n        this._dir = _dir;\n        this.ngControl = ngControl;\n        /**\n         * Implemented as part of MatFormFieldControl.\n         * \\@docs-private\n         */\n        this.controlType = 'mat-chip-list';\n        /**\n         * When a chip is destroyed, we store the index of the destroyed chip until the chips\n         * query list notifies about the update. This is necessary because we cannot determine an\n         * appropriate chip that should receive focus until the array of chips updated completely.\n         */\n        this._lastDestroyedChipIndex = null;\n        /**\n         * Subject that emits when the component has been destroyed.\n         */\n        this._destroyed = new Subject();\n        /**\n         * Uid of the chip list\n         */\n        this._uid = `mat-chip-list-${nextUniqueId++}`;\n        /**\n         * Tab index for the chip list.\n         */\n        this._tabIndex = 0;\n        /**\n         * User defined tab index.\n         * When it is not null, use user defined tab index. Otherwise use _tabIndex\n         */\n        this._userTabIndex = null;\n        /**\n         * Function when touched\n         */\n        this._onTouched = (/**\n         * @return {?}\n         */\n        () => { });\n        /**\n         * Function when changed\n         */\n        this._onChange = (/**\n         * @return {?}\n         */\n        () => { });\n        this._multiple = false;\n        this._compareWith = (/**\n         * @param {?} o1\n         * @param {?} o2\n         * @return {?}\n         */\n        (o1, o2) => o1 === o2);\n        this._required = false;\n        this._disabled = false;\n        /**\n         * Orientation of the chip list.\n         */\n        this.ariaOrientation = 'horizontal';\n        this._selectable = true;\n        /**\n         * Event emitted when the selected chip list value has been changed by the user.\n         */\n        this.change = new EventEmitter();\n        /**\n         * Event that emits whenever the raw value of the chip-list changes. This is here primarily\n         * to facilitate the two-way binding for the `value` input.\n         * \\@docs-private\n         */\n        this.valueChange = new EventEmitter();\n        if (this.ngControl) {\n            this.ngControl.valueAccessor = this;\n        }\n    }\n    /**\n     * The array of selected chips inside chip list.\n     * @return {?}\n     */\n    get selected() {\n        return this.multiple ? this._selectionModel.selected : this._selectionModel.selected[0];\n    }\n    /**\n     * The ARIA role applied to the chip list.\n     * @return {?}\n     */\n    get role() { return this.empty ? null : 'listbox'; }\n    /**\n     * Whether the user should be allowed to select multiple chips.\n     * @return {?}\n     */\n    get multiple() { return this._multiple; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set multiple(value) {\n        this._multiple = coerceBooleanProperty(value);\n        this._syncChipsState();\n    }\n    /**\n     * A function to compare the option values with the selected values. The first argument\n     * is a value from an option. The second is a value from the selection. A boolean\n     * should be returned.\n     * @return {?}\n     */\n    get compareWith() { return this._compareWith; }\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    set compareWith(fn) {\n        this._compareWith = fn;\n        if (this._selectionModel) {\n            // A different comparator means the selection could change.\n            this._initializeSelection();\n        }\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get value() { return this._value; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set value(value) {\n        this.writeValue(value);\n        this._value = value;\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get id() {\n        return this._chipInput ? this._chipInput.id : this._uid;\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get required() { return this._required; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set required(value) {\n        this._required = coerceBooleanProperty(value);\n        this.stateChanges.next();\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get placeholder() {\n        return this._chipInput ? this._chipInput.placeholder : this._placeholder;\n    }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set placeholder(value) {\n        this._placeholder = value;\n        this.stateChanges.next();\n    }\n    /**\n     * Whether any chips or the matChipInput inside of this chip-list has focus.\n     * @return {?}\n     */\n    get focused() {\n        return (this._chipInput && this._chipInput.focused) || this._hasFocusedChip();\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get empty() {\n        return (!this._chipInput || this._chipInput.empty) && this.chips.length === 0;\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get shouldLabelFloat() { return !this.empty || this.focused; }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @return {?}\n     */\n    get disabled() { return this.ngControl ? !!this.ngControl.disabled : this._disabled; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set disabled(value) {\n        this._disabled = coerceBooleanProperty(value);\n        this._syncChipsState();\n    }\n    /**\n     * Whether or not this chip list is selectable. When a chip list is not selectable,\n     * the selected states for all the chips inside the chip list are always ignored.\n     * @return {?}\n     */\n    get selectable() { return this._selectable; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set selectable(value) {\n        this._selectable = coerceBooleanProperty(value);\n        if (this.chips) {\n            this.chips.forEach((/**\n             * @param {?} chip\n             * @return {?}\n             */\n            chip => chip.chipListSelectable = this._selectable));\n        }\n    }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set tabIndex(value) {\n        this._userTabIndex = value;\n        this._tabIndex = value;\n    }\n    /**\n     * Combined stream of all of the child chips' selection change events.\n     * @return {?}\n     */\n    get chipSelectionChanges() {\n        return merge(...this.chips.map((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => chip.selectionChange)));\n    }\n    /**\n     * Combined stream of all of the child chips' focus change events.\n     * @return {?}\n     */\n    get chipFocusChanges() {\n        return merge(...this.chips.map((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => chip._onFocus)));\n    }\n    /**\n     * Combined stream of all of the child chips' blur change events.\n     * @return {?}\n     */\n    get chipBlurChanges() {\n        return merge(...this.chips.map((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => chip._onBlur)));\n    }\n    /**\n     * Combined stream of all of the child chips' remove change events.\n     * @return {?}\n     */\n    get chipRemoveChanges() {\n        return merge(...this.chips.map((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => chip.destroyed)));\n    }\n    /**\n     * @return {?}\n     */\n    ngAfterContentInit() {\n        this._keyManager = new FocusKeyManager(this.chips)\n            .withWrap()\n            .withVerticalOrientation()\n            .withHorizontalOrientation(this._dir ? this._dir.value : 'ltr');\n        if (this._dir) {\n            this._dir.change\n                .pipe(takeUntil(this._destroyed))\n                .subscribe((/**\n             * @param {?} dir\n             * @return {?}\n             */\n            dir => this._keyManager.withHorizontalOrientation(dir)));\n        }\n        this._keyManager.tabOut.pipe(takeUntil(this._destroyed)).subscribe((/**\n         * @return {?}\n         */\n        () => {\n            this._allowFocusEscape();\n        }));\n        // When the list changes, re-subscribe\n        this.chips.changes.pipe(startWith(null), takeUntil(this._destroyed)).subscribe((/**\n         * @return {?}\n         */\n        () => {\n            if (this.disabled) {\n                // Since this happens after the content has been\n                // checked, we need to defer it to the next tick.\n                Promise.resolve().then((/**\n                 * @return {?}\n                 */\n                () => {\n                    this._syncChipsState();\n                }));\n            }\n            this._resetChips();\n            // Reset chips selected/deselected status\n            this._initializeSelection();\n            // Check to see if we need to update our tab index\n            this._updateTabIndex();\n            // Check to see if we have a destroyed chip and need to refocus\n            this._updateFocusForDestroyedChips();\n            this.stateChanges.next();\n        }));\n    }\n    /**\n     * @return {?}\n     */\n    ngOnInit() {\n        this._selectionModel = new SelectionModel(this.multiple, undefined, false);\n        this.stateChanges.next();\n    }\n    /**\n     * @return {?}\n     */\n    ngDoCheck() {\n        if (this.ngControl) {\n            // We need to re-evaluate this on every change detection cycle, because there are some\n            // error triggers that we can't subscribe to (e.g. parent form submissions). This means\n            // that whatever logic is in here has to be super lean or we risk destroying the performance.\n            this.updateErrorState();\n        }\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this._destroyed.next();\n        this._destroyed.complete();\n        this.stateChanges.complete();\n        this._dropSubscriptions();\n    }\n    /**\n     * Associates an HTML input element with this chip list.\n     * @param {?} inputElement\n     * @return {?}\n     */\n    registerInput(inputElement) {\n        this._chipInput = inputElement;\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @param {?} ids\n     * @return {?}\n     */\n    setDescribedByIds(ids) { this._ariaDescribedby = ids.join(' '); }\n    // Implemented as part of ControlValueAccessor.\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    writeValue(value) {\n        if (this.chips) {\n            this._setSelectionByValue(value, false);\n        }\n    }\n    // Implemented as part of ControlValueAccessor.\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    registerOnChange(fn) {\n        this._onChange = fn;\n    }\n    // Implemented as part of ControlValueAccessor.\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    registerOnTouched(fn) {\n        this._onTouched = fn;\n    }\n    // Implemented as part of ControlValueAccessor.\n    /**\n     * @param {?} isDisabled\n     * @return {?}\n     */\n    setDisabledState(isDisabled) {\n        this.disabled = isDisabled;\n        this.stateChanges.next();\n    }\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @param {?} event\n     * @return {?}\n     */\n    onContainerClick(event) {\n        if (!this._originatesFromChip(event)) {\n            this.focus();\n        }\n    }\n    /**\n     * Focuses the first non-disabled chip in this chip list, or the associated input when there\n     * are no eligible chips.\n     * @param {?=} options\n     * @return {?}\n     */\n    focus(options) {\n        if (this.disabled) {\n            return;\n        }\n        // TODO: ARIA says this should focus the first `selected` chip if any are selected.\n        // Focus on first element if there's no chipInput inside chip-list\n        if (this._chipInput && this._chipInput.focused) {\n            // do nothing\n        }\n        else if (this.chips.length > 0) {\n            this._keyManager.setFirstItemActive();\n            this.stateChanges.next();\n        }\n        else {\n            this._focusInput(options);\n            this.stateChanges.next();\n        }\n    }\n    /**\n     * Attempt to focus an input if we have one.\n     * @param {?=} options\n     * @return {?}\n     */\n    _focusInput(options) {\n        if (this._chipInput) {\n            this._chipInput.focus(options);\n        }\n    }\n    /**\n     * Pass events to the keyboard manager. Available here for tests.\n     * @param {?} event\n     * @return {?}\n     */\n    _keydown(event) {\n        /** @type {?} */\n        const target = (/** @type {?} */ (event.target));\n        // If they are on an empty input and hit backspace, focus the last chip\n        if (event.keyCode === BACKSPACE && this._isInputEmpty(target)) {\n            this._keyManager.setLastItemActive();\n            event.preventDefault();\n        }\n        else if (target && target.classList.contains('mat-chip')) {\n            if (event.keyCode === HOME) {\n                this._keyManager.setFirstItemActive();\n                event.preventDefault();\n            }\n            else if (event.keyCode === END) {\n                this._keyManager.setLastItemActive();\n                event.preventDefault();\n            }\n            else {\n                this._keyManager.onKeydown(event);\n            }\n            this.stateChanges.next();\n        }\n    }\n    /**\n     * Check the tab index as you should not be allowed to focus an empty list.\n     * @protected\n     * @return {?}\n     */\n    _updateTabIndex() {\n        // If we have 0 chips, we should not allow keyboard focus\n        this._tabIndex = this._userTabIndex || (this.chips.length === 0 ? -1 : 0);\n    }\n    /**\n     * If the amount of chips changed, we need to update the\n     * key manager state and focus the next closest chip.\n     * @protected\n     * @return {?}\n     */\n    _updateFocusForDestroyedChips() {\n        // Move focus to the closest chip. If no other chips remain, focus the chip-list itself.\n        if (this._lastDestroyedChipIndex != null) {\n            if (this.chips.length) {\n                /** @type {?} */\n                const newChipIndex = Math.min(this._lastDestroyedChipIndex, this.chips.length - 1);\n                this._keyManager.setActiveItem(newChipIndex);\n            }\n            else {\n                this.focus();\n            }\n        }\n        this._lastDestroyedChipIndex = null;\n    }\n    /**\n     * Utility to ensure all indexes are valid.\n     *\n     * @private\n     * @param {?} index The index to be checked.\n     * @return {?} True if the index is valid for our list of chips.\n     */\n    _isValidIndex(index) {\n        return index >= 0 && index < this.chips.length;\n    }\n    /**\n     * @private\n     * @param {?} element\n     * @return {?}\n     */\n    _isInputEmpty(element) {\n        if (element && element.nodeName.toLowerCase() === 'input') {\n            /** @type {?} */\n            let input = (/** @type {?} */ (element));\n            return !input.value;\n        }\n        return false;\n    }\n    /**\n     * @param {?} value\n     * @param {?=} isUserInput\n     * @return {?}\n     */\n    _setSelectionByValue(value, isUserInput = true) {\n        this._clearSelection();\n        this.chips.forEach((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => chip.deselect()));\n        if (Array.isArray(value)) {\n            value.forEach((/**\n             * @param {?} currentValue\n             * @return {?}\n             */\n            currentValue => this._selectValue(currentValue, isUserInput)));\n            this._sortValues();\n        }\n        else {\n            /** @type {?} */\n            const correspondingChip = this._selectValue(value, isUserInput);\n            // Shift focus to the active item. Note that we shouldn't do this in multiple\n            // mode, because we don't know what chip the user interacted with last.\n            if (correspondingChip) {\n                if (isUserInput) {\n                    this._keyManager.setActiveItem(correspondingChip);\n                }\n            }\n        }\n    }\n    /**\n     * Finds and selects the chip based on its value.\n     * @private\n     * @param {?} value\n     * @param {?=} isUserInput\n     * @return {?} Chip that has the corresponding value.\n     */\n    _selectValue(value, isUserInput = true) {\n        /** @type {?} */\n        const correspondingChip = this.chips.find((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => {\n            return chip.value != null && this._compareWith(chip.value, value);\n        }));\n        if (correspondingChip) {\n            isUserInput ? correspondingChip.selectViaInteraction() : correspondingChip.select();\n            this._selectionModel.select(correspondingChip);\n        }\n        return correspondingChip;\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    _initializeSelection() {\n        // Defer setting the value in order to avoid the \"Expression\n        // has changed after it was checked\" errors from Angular.\n        Promise.resolve().then((/**\n         * @return {?}\n         */\n        () => {\n            if (this.ngControl || this._value) {\n                this._setSelectionByValue(this.ngControl ? this.ngControl.value : this._value, false);\n                this.stateChanges.next();\n            }\n        }));\n    }\n    /**\n     * Deselects every chip in the list.\n     * @private\n     * @param {?=} skip Chip that should not be deselected.\n     * @return {?}\n     */\n    _clearSelection(skip) {\n        this._selectionModel.clear();\n        this.chips.forEach((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => {\n            if (chip !== skip) {\n                chip.deselect();\n            }\n        }));\n        this.stateChanges.next();\n    }\n    /**\n     * Sorts the model values, ensuring that they keep the same\n     * order that they have in the panel.\n     * @private\n     * @return {?}\n     */\n    _sortValues() {\n        if (this._multiple) {\n            this._selectionModel.clear();\n            this.chips.forEach((/**\n             * @param {?} chip\n             * @return {?}\n             */\n            chip => {\n                if (chip.selected) {\n                    this._selectionModel.select(chip);\n                }\n            }));\n            this.stateChanges.next();\n        }\n    }\n    /**\n     * Emits change event to set the model value.\n     * @private\n     * @param {?=} fallbackValue\n     * @return {?}\n     */\n    _propagateChanges(fallbackValue) {\n        /** @type {?} */\n        let valueToEmit = null;\n        if (Array.isArray(this.selected)) {\n            valueToEmit = this.selected.map((/**\n             * @param {?} chip\n             * @return {?}\n             */\n            chip => chip.value));\n        }\n        else {\n            valueToEmit = this.selected ? this.selected.value : fallbackValue;\n        }\n        this._value = valueToEmit;\n        this.change.emit(new MatChipListChange(this, valueToEmit));\n        this.valueChange.emit(valueToEmit);\n        this._onChange(valueToEmit);\n        this._changeDetectorRef.markForCheck();\n    }\n    /**\n     * When blurred, mark the field as touched when focus moved outside the chip list.\n     * @return {?}\n     */\n    _blur() {\n        if (!this._hasFocusedChip()) {\n            this._keyManager.setActiveItem(-1);\n        }\n        if (!this.disabled) {\n            if (this._chipInput) {\n                // If there's a chip input, we should check whether the focus moved to chip input.\n                // If the focus is not moved to chip input, mark the field as touched. If the focus moved\n                // to chip input, do nothing.\n                // Timeout is needed to wait for the focus() event trigger on chip input.\n                setTimeout((/**\n                 * @return {?}\n                 */\n                () => {\n                    if (!this.focused) {\n                        this._markAsTouched();\n                    }\n                }));\n            }\n            else {\n                // If there's no chip input, then mark the field as touched.\n                this._markAsTouched();\n            }\n        }\n    }\n    /**\n     * Mark the field as touched\n     * @return {?}\n     */\n    _markAsTouched() {\n        this._onTouched();\n        this._changeDetectorRef.markForCheck();\n        this.stateChanges.next();\n    }\n    /**\n     * Removes the `tabindex` from the chip list and resets it back afterwards, allowing the\n     * user to tab out of it. This prevents the list from capturing focus and redirecting\n     * it back to the first chip, creating a focus trap, if it user tries to tab away.\n     * @return {?}\n     */\n    _allowFocusEscape() {\n        if (this._tabIndex !== -1) {\n            this._tabIndex = -1;\n            setTimeout((/**\n             * @return {?}\n             */\n            () => {\n                this._tabIndex = this._userTabIndex || 0;\n                this._changeDetectorRef.markForCheck();\n            }));\n        }\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    _resetChips() {\n        this._dropSubscriptions();\n        this._listenToChipsFocus();\n        this._listenToChipsSelection();\n        this._listenToChipsRemoved();\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    _dropSubscriptions() {\n        if (this._chipFocusSubscription) {\n            this._chipFocusSubscription.unsubscribe();\n            this._chipFocusSubscription = null;\n        }\n        if (this._chipBlurSubscription) {\n            this._chipBlurSubscription.unsubscribe();\n            this._chipBlurSubscription = null;\n        }\n        if (this._chipSelectionSubscription) {\n            this._chipSelectionSubscription.unsubscribe();\n            this._chipSelectionSubscription = null;\n        }\n        if (this._chipRemoveSubscription) {\n            this._chipRemoveSubscription.unsubscribe();\n            this._chipRemoveSubscription = null;\n        }\n    }\n    /**\n     * Listens to user-generated selection events on each chip.\n     * @private\n     * @return {?}\n     */\n    _listenToChipsSelection() {\n        this._chipSelectionSubscription = this.chipSelectionChanges.subscribe((/**\n         * @param {?} event\n         * @return {?}\n         */\n        event => {\n            event.source.selected\n                ? this._selectionModel.select(event.source)\n                : this._selectionModel.deselect(event.source);\n            // For single selection chip list, make sure the deselected value is unselected.\n            if (!this.multiple) {\n                this.chips.forEach((/**\n                 * @param {?} chip\n                 * @return {?}\n                 */\n                chip => {\n                    if (!this._selectionModel.isSelected(chip) && chip.selected) {\n                        chip.deselect();\n                    }\n                }));\n            }\n            if (event.isUserInput) {\n                this._propagateChanges();\n            }\n        }));\n    }\n    /**\n     * Listens to user-generated selection events on each chip.\n     * @private\n     * @return {?}\n     */\n    _listenToChipsFocus() {\n        this._chipFocusSubscription = this.chipFocusChanges.subscribe((/**\n         * @param {?} event\n         * @return {?}\n         */\n        event => {\n            /** @type {?} */\n            let chipIndex = this.chips.toArray().indexOf(event.chip);\n            if (this._isValidIndex(chipIndex)) {\n                this._keyManager.updateActiveItem(chipIndex);\n            }\n            this.stateChanges.next();\n        }));\n        this._chipBlurSubscription = this.chipBlurChanges.subscribe((/**\n         * @return {?}\n         */\n        () => {\n            this._blur();\n            this.stateChanges.next();\n        }));\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    _listenToChipsRemoved() {\n        this._chipRemoveSubscription = this.chipRemoveChanges.subscribe((/**\n         * @param {?} event\n         * @return {?}\n         */\n        event => {\n            /** @type {?} */\n            const chip = event.chip;\n            /** @type {?} */\n            const chipIndex = this.chips.toArray().indexOf(event.chip);\n            // In case the chip that will be removed is currently focused, we temporarily store\n            // the index in order to be able to determine an appropriate sibling chip that will\n            // receive focus.\n            if (this._isValidIndex(chipIndex) && chip._hasFocus) {\n                this._lastDestroyedChipIndex = chipIndex;\n            }\n        }));\n    }\n    /**\n     * Checks whether an event comes from inside a chip element.\n     * @private\n     * @param {?} event\n     * @return {?}\n     */\n    _originatesFromChip(event) {\n        /** @type {?} */\n        let currentElement = (/** @type {?} */ (event.target));\n        while (currentElement && currentElement !== this._elementRef.nativeElement) {\n            if (currentElement.classList.contains('mat-chip')) {\n                return true;\n            }\n            currentElement = currentElement.parentElement;\n        }\n        return false;\n    }\n    /**\n     * Checks whether any of the chips is focused.\n     * @private\n     * @return {?}\n     */\n    _hasFocusedChip() {\n        return this.chips.some((/**\n         * @param {?} chip\n         * @return {?}\n         */\n        chip => chip._hasFocus));\n    }\n    /**\n     * Syncs the list's state with the individual chips.\n     * @private\n     * @return {?}\n     */\n    _syncChipsState() {\n        if (this.chips) {\n            this.chips.forEach((/**\n             * @param {?} chip\n             * @return {?}\n             */\n            chip => {\n                chip.disabled = this._disabled;\n                chip._chipListMultiple = this.multiple;\n            }));\n        }\n    }\n}\nMatChipList.ɵfac = function MatChipList_Factory(t) { return new (t || MatChipList)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.Directionality, 8), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.NgForm, 8), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.FormGroupDirective, 8), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.ErrorStateMatcher), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.NgControl, 10)); };\nMatChipList.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MatChipList, selectors: [[\"mat-chip-list\"]], contentQueries: function MatChipList_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {\n        ɵngcc0.ɵɵcontentQuery(dirIndex, MatChip, true);\n    } if (rf & 2) {\n        var _t;\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.chips = _t);\n    } }, hostAttrs: [1, \"mat-chip-list\"], hostVars: 15, hostBindings: function MatChipList_HostBindings(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵlistener(\"focus\", function MatChipList_focus_HostBindingHandler($event) { return ctx.focus(); })(\"blur\", function MatChipList_blur_HostBindingHandler($event) { return ctx._blur(); })(\"keydown\", function MatChipList_keydown_HostBindingHandler($event) { return ctx._keydown($event); });\n    } if (rf & 2) {\n        ɵngcc0.ɵɵhostProperty(\"id\", ctx._uid);\n        ɵngcc0.ɵɵattribute(\"tabindex\", ctx.disabled ? null : ctx._tabIndex)(\"aria-describedby\", ctx._ariaDescribedby || null)(\"aria-required\", ctx.role ? ctx.required : null)(\"aria-disabled\", ctx.disabled.toString())(\"aria-invalid\", ctx.errorState)(\"aria-multiselectable\", ctx.multiple)(\"role\", ctx.role)(\"aria-orientation\", ctx.ariaOrientation);\n        ɵngcc0.ɵɵclassProp(\"mat-chip-list-disabled\", ctx.disabled)(\"mat-chip-list-invalid\", ctx.errorState)(\"mat-chip-list-required\", ctx.required);\n    } }, inputs: { ariaOrientation: [\"aria-orientation\", \"ariaOrientation\"], multiple: \"multiple\", compareWith: \"compareWith\", value: \"value\", required: \"required\", placeholder: \"placeholder\", disabled: \"disabled\", selectable: \"selectable\", tabIndex: \"tabIndex\", errorStateMatcher: \"errorStateMatcher\" }, outputs: { change: \"change\", valueChange: \"valueChange\" }, exportAs: [\"matChipList\"], features: [ɵngcc0.ɵɵProvidersFeature([{ provide: MatFormFieldControl, useExisting: MatChipList }]), ɵngcc0.ɵɵInheritDefinitionFeature], ngContentSelectors: _c0, decls: 2, vars: 0, consts: [[1, \"mat-chip-list-wrapper\"]], template: function MatChipList_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵelementStart(0, \"div\", 0);\n        ɵngcc0.ɵɵprojection(1);\n        ɵngcc0.ɵɵelementEnd();\n    } }, styles: [\".mat-chip{position:relative;overflow:hidden;box-sizing:border-box;-webkit-tap-highlight-color:transparent;transform:translateZ(0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}._mat-animation-noopable.mat-standard-chip{transition:none;animation:none}.mat-standard-chip .mat-chip-remove.mat-icon{width:18px;height:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:\\\"\\\";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip:focus{outline:dotted 2px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}\\n\"], encapsulation: 2, changeDetection: 0 });\n/** @nocollapse */\nMatChipList.ctorParameters = () => [\n    { type: ElementRef },\n    { type: ChangeDetectorRef },\n    { type: Directionality, decorators: [{ type: Optional }] },\n    { type: NgForm, decorators: [{ type: Optional }] },\n    { type: FormGroupDirective, decorators: [{ type: Optional }] },\n    { type: ErrorStateMatcher },\n    { type: NgControl, decorators: [{ type: Optional }, { type: Self }] }\n];\nMatChipList.propDecorators = {\n    errorStateMatcher: [{ type: Input }],\n    multiple: [{ type: Input }],\n    compareWith: [{ type: Input }],\n    value: [{ type: Input }],\n    required: [{ type: Input }],\n    placeholder: [{ type: Input }],\n    disabled: [{ type: Input }],\n    ariaOrientation: [{ type: Input, args: ['aria-orientation',] }],\n    selectable: [{ type: Input }],\n    tabIndex: [{ type: Input }],\n    change: [{ type: Output }],\n    valueChange: [{ type: Output }],\n    chips: [{ type: ContentChildren, args: [MatChip, {\n                    // We need to use `descendants: true`, because Ivy will no longer match\n                    // indirect descendants if it's left as false.\n                    descendants: true\n                },] }]\n};\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChipList, [{\n        type: Component,\n        args: [{\n                selector: 'mat-chip-list',\n                template: `<div class=\"mat-chip-list-wrapper\"><ng-content></ng-content></div>`,\n                exportAs: 'matChipList',\n                host: {\n                    '[attr.tabindex]': 'disabled ? null : _tabIndex',\n                    '[attr.aria-describedby]': '_ariaDescribedby || null',\n                    '[attr.aria-required]': 'role ? required : null',\n                    '[attr.aria-disabled]': 'disabled.toString()',\n                    '[attr.aria-invalid]': 'errorState',\n                    '[attr.aria-multiselectable]': 'multiple',\n                    '[attr.role]': 'role',\n                    '[class.mat-chip-list-disabled]': 'disabled',\n                    '[class.mat-chip-list-invalid]': 'errorState',\n                    '[class.mat-chip-list-required]': 'required',\n                    '[attr.aria-orientation]': 'ariaOrientation',\n                    'class': 'mat-chip-list',\n                    '(focus)': 'focus()',\n                    '(blur)': '_blur()',\n                    '(keydown)': '_keydown($event)',\n                    '[id]': '_uid'\n                },\n                providers: [{ provide: MatFormFieldControl, useExisting: MatChipList }],\n                encapsulation: ViewEncapsulation.None,\n                changeDetection: ChangeDetectionStrategy.OnPush,\n                styles: [\".mat-chip{position:relative;overflow:hidden;box-sizing:border-box;-webkit-tap-highlight-color:transparent;transform:translateZ(0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}._mat-animation-noopable.mat-standard-chip{transition:none;animation:none}.mat-standard-chip .mat-chip-remove.mat-icon{width:18px;height:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:\\\"\\\";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip:focus{outline:dotted 2px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}\\n\"]\n            }]\n    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc2.Directionality, decorators: [{\n                type: Optional\n            }] }, { type: ɵngcc3.NgForm, decorators: [{\n                type: Optional\n            }] }, { type: ɵngcc3.FormGroupDirective, decorators: [{\n                type: Optional\n            }] }, { type: ɵngcc4.ErrorStateMatcher }, { type: ɵngcc3.NgControl, decorators: [{\n                type: Optional\n            }, {\n                type: Self\n            }] }]; }, { ariaOrientation: [{\n            type: Input,\n            args: ['aria-orientation']\n        }], change: [{\n            type: Output\n        }], valueChange: [{\n            type: Output\n        }], multiple: [{\n            type: Input\n        }], compareWith: [{\n            type: Input\n        }], value: [{\n            type: Input\n        }], required: [{\n            type: Input\n        }], placeholder: [{\n            type: Input\n        }], disabled: [{\n            type: Input\n        }], selectable: [{\n            type: Input\n        }], tabIndex: [{\n            type: Input\n        }], errorStateMatcher: [{\n            type: Input\n        }], chips: [{\n            type: ContentChildren,\n            args: [MatChip, {\n                    // We need to use `descendants: true`, because Ivy will no longer match\n                    // indirect descendants if it's left as false.\n                    descendants: true\n                }]\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    MatChipList.ngAcceptInputType_multiple;\n    /** @type {?} */\n    MatChipList.ngAcceptInputType_required;\n    /** @type {?} */\n    MatChipList.ngAcceptInputType_disabled;\n    /** @type {?} */\n    MatChipList.ngAcceptInputType_selectable;\n    /**\n     * Implemented as part of MatFormFieldControl.\n     * \\@docs-private\n     * @type {?}\n     */\n    MatChipList.prototype.controlType;\n    /**\n     * When a chip is destroyed, we store the index of the destroyed chip until the chips\n     * query list notifies about the update. This is necessary because we cannot determine an\n     * appropriate chip that should receive focus until the array of chips updated completely.\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._lastDestroyedChipIndex;\n    /**\n     * Subject that emits when the component has been destroyed.\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._destroyed;\n    /**\n     * Subscription to focus changes in the chips.\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._chipFocusSubscription;\n    /**\n     * Subscription to blur changes in the chips.\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._chipBlurSubscription;\n    /**\n     * Subscription to selection changes in chips.\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._chipSelectionSubscription;\n    /**\n     * Subscription to remove changes in chips.\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._chipRemoveSubscription;\n    /**\n     * The chip input to add more chips\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._chipInput;\n    /**\n     * Uid of the chip list\n     * @type {?}\n     */\n    MatChipList.prototype._uid;\n    /**\n     * The aria-describedby attribute on the chip list for improved a11y.\n     * @type {?}\n     */\n    MatChipList.prototype._ariaDescribedby;\n    /**\n     * Tab index for the chip list.\n     * @type {?}\n     */\n    MatChipList.prototype._tabIndex;\n    /**\n     * User defined tab index.\n     * When it is not null, use user defined tab index. Otherwise use _tabIndex\n     * @type {?}\n     */\n    MatChipList.prototype._userTabIndex;\n    /**\n     * The FocusKeyManager which handles focus.\n     * @type {?}\n     */\n    MatChipList.prototype._keyManager;\n    /**\n     * Function when touched\n     * @type {?}\n     */\n    MatChipList.prototype._onTouched;\n    /**\n     * Function when changed\n     * @type {?}\n     */\n    MatChipList.prototype._onChange;\n    /** @type {?} */\n    MatChipList.prototype._selectionModel;\n    /**\n     * An object used to control when error messages are shown.\n     * @type {?}\n     */\n    MatChipList.prototype.errorStateMatcher;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._multiple;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._compareWith;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._value;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._required;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._placeholder;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._disabled;\n    /**\n     * Orientation of the chip list.\n     * @type {?}\n     */\n    MatChipList.prototype.ariaOrientation;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._selectable;\n    /**\n     * Event emitted when the selected chip list value has been changed by the user.\n     * @type {?}\n     */\n    MatChipList.prototype.change;\n    /**\n     * Event that emits whenever the raw value of the chip-list changes. This is here primarily\n     * to facilitate the two-way binding for the `value` input.\n     * \\@docs-private\n     * @type {?}\n     */\n    MatChipList.prototype.valueChange;\n    /**\n     * The chip components contained within this chip list.\n     * @type {?}\n     */\n    MatChipList.prototype.chips;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipList.prototype._elementRef;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._changeDetectorRef;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChipList.prototype._dir;\n    /**\n     * \\@docs-private\n     * @type {?}\n     */\n    MatChipList.prototype.ngControl;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/material/chips/chip-input.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * Represents an input event on a `matChipInput`.\n * @record\n */\nfunction MatChipInputEvent() { }\nif (false) {\n    /**\n     * The native `<input>` element that the event is being fired for.\n     * @type {?}\n     */\n    MatChipInputEvent.prototype.input;\n    /**\n     * The value of the input.\n     * @type {?}\n     */\n    MatChipInputEvent.prototype.value;\n}\n// Increasing integer for generating unique ids.\n/** @type {?} */\nlet nextUniqueId$1 = 0;\n/**\n * Directive that adds chip-specific behaviors to an input element inside `<mat-form-field>`.\n * May be placed inside or outside of an `<mat-chip-list>`.\n */\nclass MatChipInput {\n    /**\n     * @param {?} _elementRef\n     * @param {?} _defaultOptions\n     */\n    constructor(_elementRef, _defaultOptions) {\n        this._elementRef = _elementRef;\n        this._defaultOptions = _defaultOptions;\n        /**\n         * Whether the control is focused.\n         */\n        this.focused = false;\n        this._addOnBlur = false;\n        /**\n         * The list of key codes that will trigger a chipEnd event.\n         *\n         * Defaults to `[ENTER]`.\n         */\n        this.separatorKeyCodes = this._defaultOptions.separatorKeyCodes;\n        /**\n         * Emitted when a chip is to be added.\n         */\n        this.chipEnd = new EventEmitter();\n        /**\n         * The input's placeholder text.\n         */\n        this.placeholder = '';\n        /**\n         * Unique id for the input.\n         */\n        this.id = `mat-chip-list-input-${nextUniqueId$1++}`;\n        this._disabled = false;\n        this._inputElement = (/** @type {?} */ (this._elementRef.nativeElement));\n    }\n    /**\n     * Register input for chip list\n     * @param {?} value\n     * @return {?}\n     */\n    set chipList(value) {\n        if (value) {\n            this._chipList = value;\n            this._chipList.registerInput(this);\n        }\n    }\n    /**\n     * Whether or not the chipEnd event will be emitted when the input is blurred.\n     * @return {?}\n     */\n    get addOnBlur() { return this._addOnBlur; }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set addOnBlur(value) { this._addOnBlur = coerceBooleanProperty(value); }\n    /**\n     * Whether the input is disabled.\n     * @return {?}\n     */\n    get disabled() { return this._disabled || (this._chipList && this._chipList.disabled); }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    set disabled(value) { this._disabled = coerceBooleanProperty(value); }\n    /**\n     * Whether the input is empty.\n     * @return {?}\n     */\n    get empty() { return !this._inputElement.value; }\n    /**\n     * @return {?}\n     */\n    ngOnChanges() {\n        this._chipList.stateChanges.next();\n    }\n    /**\n     * Utility method to make host definition/tests more clear.\n     * @param {?=} event\n     * @return {?}\n     */\n    _keydown(event) {\n        // Allow the user's focus to escape when they're tabbing forward. Note that we don't\n        // want to do this when going backwards, because focus should go back to the first chip.\n        if (event && event.keyCode === TAB && !hasModifierKey(event, 'shiftKey')) {\n            this._chipList._allowFocusEscape();\n        }\n        this._emitChipEnd(event);\n    }\n    /**\n     * Checks to see if the blur should emit the (chipEnd) event.\n     * @return {?}\n     */\n    _blur() {\n        if (this.addOnBlur) {\n            this._emitChipEnd();\n        }\n        this.focused = false;\n        // Blur the chip list if it is not focused\n        if (!this._chipList.focused) {\n            this._chipList._blur();\n        }\n        this._chipList.stateChanges.next();\n    }\n    /**\n     * @return {?}\n     */\n    _focus() {\n        this.focused = true;\n        this._chipList.stateChanges.next();\n    }\n    /**\n     * Checks to see if the (chipEnd) event needs to be emitted.\n     * @param {?=} event\n     * @return {?}\n     */\n    _emitChipEnd(event) {\n        if (!this._inputElement.value && !!event) {\n            this._chipList._keydown(event);\n        }\n        if (!event || this._isSeparatorKey(event)) {\n            this.chipEnd.emit({ input: this._inputElement, value: this._inputElement.value });\n            if (event) {\n                event.preventDefault();\n            }\n        }\n    }\n    /**\n     * @return {?}\n     */\n    _onInput() {\n        // Let chip list know whenever the value changes.\n        this._chipList.stateChanges.next();\n    }\n    /**\n     * Focuses the input.\n     * @param {?=} options\n     * @return {?}\n     */\n    focus(options) {\n        this._inputElement.focus(options);\n    }\n    /**\n     * Checks whether a keycode is one of the configured separators.\n     * @private\n     * @param {?} event\n     * @return {?}\n     */\n    _isSeparatorKey(event) {\n        if (hasModifierKey(event)) {\n            return false;\n        }\n        /** @type {?} */\n        const separators = this.separatorKeyCodes;\n        /** @type {?} */\n        const keyCode = event.keyCode;\n        return Array.isArray(separators) ? separators.indexOf(keyCode) > -1 : separators.has(keyCode);\n    }\n}\nMatChipInput.ɵfac = function MatChipInput_Factory(t) { return new (t || MatChipInput)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(MAT_CHIPS_DEFAULT_OPTIONS)); };\nMatChipInput.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MatChipInput, selectors: [[\"input\", \"matChipInputFor\", \"\"]], hostAttrs: [1, \"mat-chip-input\", \"mat-input-element\"], hostVars: 5, hostBindings: function MatChipInput_HostBindings(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵlistener(\"keydown\", function MatChipInput_keydown_HostBindingHandler($event) { return ctx._keydown($event); })(\"blur\", function MatChipInput_blur_HostBindingHandler($event) { return ctx._blur(); })(\"focus\", function MatChipInput_focus_HostBindingHandler($event) { return ctx._focus(); })(\"input\", function MatChipInput_input_HostBindingHandler($event) { return ctx._onInput(); });\n    } if (rf & 2) {\n        ɵngcc0.ɵɵhostProperty(\"id\", ctx.id);\n        ɵngcc0.ɵɵattribute(\"disabled\", ctx.disabled || null)(\"placeholder\", ctx.placeholder || null)(\"aria-invalid\", ctx._chipList && ctx._chipList.ngControl ? ctx._chipList.ngControl.invalid : null)(\"aria-required\", ctx._chipList && ctx._chipList.required || null);\n    } }, inputs: { separatorKeyCodes: [\"matChipInputSeparatorKeyCodes\", \"separatorKeyCodes\"], placeholder: \"placeholder\", id: \"id\", chipList: [\"matChipInputFor\", \"chipList\"], addOnBlur: [\"matChipInputAddOnBlur\", \"addOnBlur\"], disabled: \"disabled\" }, outputs: { chipEnd: \"matChipInputTokenEnd\" }, exportAs: [\"matChipInput\", \"matChipInputFor\"], features: [ɵngcc0.ɵɵNgOnChangesFeature()] });\n/** @nocollapse */\nMatChipInput.ctorParameters = () => [\n    { type: ElementRef },\n    { type: undefined, decorators: [{ type: Inject, args: [MAT_CHIPS_DEFAULT_OPTIONS,] }] }\n];\nMatChipInput.propDecorators = {\n    chipList: [{ type: Input, args: ['matChipInputFor',] }],\n    addOnBlur: [{ type: Input, args: ['matChipInputAddOnBlur',] }],\n    separatorKeyCodes: [{ type: Input, args: ['matChipInputSeparatorKeyCodes',] }],\n    chipEnd: [{ type: Output, args: ['matChipInputTokenEnd',] }],\n    placeholder: [{ type: Input }],\n    id: [{ type: Input }],\n    disabled: [{ type: Input }]\n};\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChipInput, [{\n        type: Directive,\n        args: [{\n                selector: 'input[matChipInputFor]',\n                exportAs: 'matChipInput, matChipInputFor',\n                host: {\n                    'class': 'mat-chip-input mat-input-element',\n                    '(keydown)': '_keydown($event)',\n                    '(blur)': '_blur()',\n                    '(focus)': '_focus()',\n                    '(input)': '_onInput()',\n                    '[id]': 'id',\n                    '[attr.disabled]': 'disabled || null',\n                    '[attr.placeholder]': 'placeholder || null',\n                    '[attr.aria-invalid]': '_chipList && _chipList.ngControl ? _chipList.ngControl.invalid : null',\n                    '[attr.aria-required]': '_chipList && _chipList.required || null'\n                }\n            }]\n    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: undefined, decorators: [{\n                type: Inject,\n                args: [MAT_CHIPS_DEFAULT_OPTIONS]\n            }] }]; }, { separatorKeyCodes: [{\n            type: Input,\n            args: ['matChipInputSeparatorKeyCodes']\n        }], chipEnd: [{\n            type: Output,\n            args: ['matChipInputTokenEnd']\n        }], placeholder: [{\n            type: Input\n        }], id: [{\n            type: Input\n        }], chipList: [{\n            type: Input,\n            args: ['matChipInputFor']\n        }], addOnBlur: [{\n            type: Input,\n            args: ['matChipInputAddOnBlur']\n        }], disabled: [{\n            type: Input\n        }] }); })();\nif (false) {\n    /** @type {?} */\n    MatChipInput.ngAcceptInputType_addOnBlur;\n    /** @type {?} */\n    MatChipInput.ngAcceptInputType_disabled;\n    /**\n     * Whether the control is focused.\n     * @type {?}\n     */\n    MatChipInput.prototype.focused;\n    /** @type {?} */\n    MatChipInput.prototype._chipList;\n    /** @type {?} */\n    MatChipInput.prototype._addOnBlur;\n    /**\n     * The list of key codes that will trigger a chipEnd event.\n     *\n     * Defaults to `[ENTER]`.\n     * @type {?}\n     */\n    MatChipInput.prototype.separatorKeyCodes;\n    /**\n     * Emitted when a chip is to be added.\n     * @type {?}\n     */\n    MatChipInput.prototype.chipEnd;\n    /**\n     * The input's placeholder text.\n     * @type {?}\n     */\n    MatChipInput.prototype.placeholder;\n    /**\n     * Unique id for the input.\n     * @type {?}\n     */\n    MatChipInput.prototype.id;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChipInput.prototype._disabled;\n    /**\n     * The native input element to which this directive is attached.\n     * @type {?}\n     * @protected\n     */\n    MatChipInput.prototype._inputElement;\n    /**\n     * @type {?}\n     * @protected\n     */\n    MatChipInput.prototype._elementRef;\n    /**\n     * @type {?}\n     * @private\n     */\n    MatChipInput.prototype._defaultOptions;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/material/chips/chips-module.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/** @type {?} */\nconst CHIP_DECLARATIONS = [\n    MatChipList,\n    MatChip,\n    MatChipInput,\n    MatChipRemove,\n    MatChipAvatar,\n    MatChipTrailingIcon,\n];\nconst ɵ0 = ({\n    separatorKeyCodes: [ENTER]\n});\nclass MatChipsModule {\n}\nMatChipsModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: MatChipsModule });\nMatChipsModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function MatChipsModule_Factory(t) { return new (t || MatChipsModule)(); }, providers: [\n        ErrorStateMatcher,\n        {\n            provide: MAT_CHIPS_DEFAULT_OPTIONS,\n            useValue: ( /** @type {?} */(ɵ0))\n        }\n    ] });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(MatChipsModule, { declarations: [MatChipList,\n        MatChip,\n        MatChipInput,\n        MatChipRemove,\n        MatChipAvatar,\n        MatChipTrailingIcon], exports: [MatChipList,\n        MatChip,\n        MatChipInput,\n        MatChipRemove,\n        MatChipAvatar,\n        MatChipTrailingIcon] }); })();\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MatChipsModule, [{\n        type: NgModule,\n        args: [{\n                exports: CHIP_DECLARATIONS,\n                declarations: CHIP_DECLARATIONS,\n                providers: [\n                    ErrorStateMatcher,\n                    {\n                        provide: MAT_CHIPS_DEFAULT_OPTIONS,\n                        useValue: ( /** @type {?} */(ɵ0))\n                    }\n                ]\n            }]\n    }], null, null); })();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: src/material/chips/public-api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { MAT_CHIPS_DEFAULT_OPTIONS, MatChip, MatChipAvatar, MatChipInput, MatChipList, MatChipListChange, MatChipRemove, MatChipSelectionChange, MatChipTrailingIcon, MatChipsModule };\n\n//# sourceMappingURL=chips.js.map","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {TextPreviewComponent} from './text-preview/text-preview.component';\r\nimport {AVAILABLE_PREVIEWS, DefaultPreviews} from './available-previews';\r\nimport {PreviewContainerComponent} from './preview-container/preview-container.component';\r\nimport {PortalModule} from '@angular/cdk/portal';\r\nimport {VideoPreviewComponent} from './video-preview/video-preview.component';\r\nimport {ImagePreviewComponent} from './image-preview/image-preview.component';\r\nimport {PdfPreviewComponent} from './pdf-preview/pdf-preview.component';\r\nimport {DefaultPreviewComponent} from './default-preview/default-preview.component';\r\nimport {MatButtonModule} from '@angular/material/button';\r\nimport {AudioPreviewComponent} from './audio-preview/audio-preview.component';\r\nimport {GoogleDocsViewerComponent} from './google-docs-viewer/google-docs-viewer.component';\r\nimport {LoadingIndicatorModule} from '@common/core/ui/loading-indicator/loading-indicator.module';\r\nimport {OverlayPanel} from '@common/core/ui/overlay-panel/overlay-panel.service';\r\nimport {PreviewFilesService} from '@common/file-preview/preview-files.service';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n\r\n        // material\r\n        PortalModule,\r\n        MatButtonModule,\r\n        LoadingIndicatorModule,\r\n    ],\r\n    exports: [\r\n        PreviewContainerComponent,\r\n    ],\r\n    declarations: [\r\n        PreviewContainerComponent,\r\n        TextPreviewComponent,\r\n        VideoPreviewComponent,\r\n        ImagePreviewComponent,\r\n        PdfPreviewComponent,\r\n        DefaultPreviewComponent,\r\n        AudioPreviewComponent,\r\n        GoogleDocsViewerComponent\r\n    ],\r\n    entryComponents: [\r\n        TextPreviewComponent,\r\n        VideoPreviewComponent,\r\n        ImagePreviewComponent,\r\n        PdfPreviewComponent,\r\n        DefaultPreviewComponent,\r\n        AudioPreviewComponent,\r\n        GoogleDocsViewerComponent,\r\n    ],\r\n    providers: [\r\n        OverlayPanel,\r\n        PreviewFilesService,\r\n        {provide: AVAILABLE_PREVIEWS, useClass: DefaultPreviews},\r\n    ]\r\n})\r\nexport class FilePreviewModule {\r\n}\r\n","<div class=\"container\">\r\n    <div class=\"title\">\r\n        <h1 trans>My requests</h1>\r\n        <a routerLink=\"/help-center/tickets/new\" *ngIf=\"!(paginator.noResults$ | async)\" mat-raised-button color=\"accent\" trans>New Request</a>\r\n    </div>\r\n\r\n    <form class=\"filter-form\" [formGroup]=\"form\">\r\n        <div class=\"input-container\">\r\n            <label for=\"customer-ticket-search\" class=\"hidden\" trans>Search requests</label>\r\n            <div class=\"input-with-icon\">\r\n                <input type=\"text\" id=\"customer-ticket-search\" class=\"filter-input\" placeholder=\"Search requests...\" trans-placeholder formControlName=\"query\">\r\n                <button mat-icon-button>\r\n                    <mat-icon svgIcon=\"search\"></mat-icon>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class=\"input-container status-input-container\">\r\n            <label for=\"customer-ticket-status\" class=\"hidden\" trans>Status</label>\r\n            <select id=\"customer-ticket-status\" class=\"filter-input\" formControlName=\"status\">\r\n                <option value=\"\" trans>All Requests</option>\r\n                <option value=\"open\" trans>Open Requests</option>\r\n                <option value=\"closed\" trans>Closed Requests</option>\r\n                <option value=\"pending\" trans>Awaiting your reply</option>\r\n            </select>\r\n        </div>\r\n    </form>\r\n\r\n    <mat-table [dataSource]=\"dataSource\" matSort class=\"responsive-material-table\">\r\n        <!-- Subject Column -->\r\n        <ng-container matColumnDef=\"subject\">\r\n            <mat-header-cell *matHeaderCellDef trans>Subject</mat-header-cell>\r\n            <mat-cell *matCellDef=\"let ticket\">{{ticket.subject}}</mat-cell>\r\n        </ng-container>\r\n\r\n        <!-- ID Column -->\r\n        <ng-container matColumnDef=\"id\">\r\n            <mat-header-cell *matHeaderCellDef mat-sort-header trans>ID</mat-header-cell>\r\n            <mat-cell *matCellDef=\"let ticket\" class=\"hidden-on-mobile\">#{{ticket.id}}</mat-cell>\r\n        </ng-container>\r\n\r\n        <!-- Created At Column -->\r\n        <ng-container matColumnDef=\"created-at\">\r\n            <mat-header-cell *matHeaderCellDef mat-sort-header=\"created_at\" trans>Created</mat-header-cell>\r\n            <mat-cell *matCellDef=\"let ticket\" class=\"hidden-on-mobile\">{{ticket.created_at | formattedDate}}</mat-cell>\r\n        </ng-container>\r\n\r\n        <!-- Last Updated Column -->\r\n        <ng-container matColumnDef=\"last-updated\">\r\n            <mat-header-cell *matHeaderCellDef mat-sort-header=\"updated_at\" trans>Last Updated</mat-header-cell>\r\n            <mat-cell *matCellDef=\"let ticket\">{{ticket.updated_at_formatted}}</mat-cell>\r\n        </ng-container>\r\n\r\n        <!-- Status Column -->\r\n        <ng-container matColumnDef=\"status\">\r\n            <mat-header-cell *matHeaderCellDef trans>Status</mat-header-cell>\r\n            <mat-cell *matCellDef=\"let ticket\">\r\n                <mat-chip-list [selectable]=\"false\" *ngIf=\"getStatus(ticket) as status\">\r\n                    <mat-chip [color]=\"!ticket.closed_at ? 'success' : 'standard'\" selected trans>{{status.display_name}}</mat-chip>\r\n                </mat-chip-list>\r\n            </mat-cell>\r\n        </ng-container>\r\n\r\n        <mat-header-row *matHeaderRowDef=\"['subject', 'id', 'created-at', 'last-updated', 'status']\"></mat-header-row>\r\n        <mat-row\r\n                *matRowDef=\"let ticket; columns: ['subject', 'id', 'created-at', 'last-updated', 'status'];\"\r\n                [class.open]=\"!ticket.closed_at\"\r\n                (click)=\"openConversation(ticket)\"\r\n        ></mat-row>\r\n    </mat-table>\r\n\r\n    <no-results-message *ngIf=\"paginator.noResults$ | async\">\r\n        <span primary-text trans>Could not find any requests.</span>\r\n        <span secondary-text>\r\n                <a routerLink=\"/help-center/tickets/new\" trans>Create a request?</a>\r\n            </span>\r\n    </no-results-message>\r\n\r\n    <mat-paginator [pageSize]=\"15\" [pageSizeOptions]=\"[5, 10, 15, 20]\" [class.hidden]=\"!(paginator.noResults$ | async)\"></mat-paginator>\r\n</div>\r\n\r\n<loading-indicator class=\"overlay\" [isVisible]=\"paginator.loading$ | async\"></loading-indicator>\r\n","import {Component, OnDestroy, OnInit, ViewChild} from '@angular/core';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {Ticket} from '../../shared/models/Ticket';\r\nimport {MatPaginator} from '@angular/material/paginator';\r\nimport {MatSort} from '@angular/material/sort';\r\nimport {Tag} from '../../shared/models/Tag';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {Paginator} from '@common/shared/paginator.service';\r\nimport {PaginatedDataTableSource} from '@common/shared/data-table/data/paginated-data-table-source';\r\nimport {FormControl, FormGroup} from '@angular/forms';\r\n\r\n@Component({\r\n    selector: 'customer-tickets-list',\r\n    templateUrl: './customer-tickets-list.component.html',\r\n    styleUrls: ['./customer-tickets-list.component.scss'],\r\n    providers: [Paginator],\r\n})\r\nexport class CustomerTicketsListComponent implements OnInit, OnDestroy {\r\n    @ViewChild(MatSort, { static: true }) matSort: MatSort;\r\n    @ViewChild(MatPaginator, { static: true }) matPaginator: MatPaginator;\r\n    public dataSource: PaginatedDataTableSource<Ticket>;\r\n\r\n    public form = new FormGroup({\r\n        query: new FormControl(this.route.snapshot.queryParams.query || ''),\r\n        status: new FormControl(this.route.snapshot.queryParams.status || ''),\r\n    });\r\n\r\n    constructor(\r\n        public paginator: Paginator<Ticket>,\r\n        public currentUser: CurrentUser,\r\n        private router: Router,\r\n        private route: ActivatedRoute,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.dataSource = new PaginatedDataTableSource<Ticket>({\r\n            uri: 'users/' + this.currentUser.get('id') + '/tickets',\r\n            dataPaginator: this.paginator,\r\n            matPaginator: this.matPaginator,\r\n            matSort: this.matSort,\r\n        }).init();\r\n\r\n        this.form.valueChanges.subscribe(value => {\r\n            console.log(value);\r\n            this.dataSource.reload(value);\r\n            // this.router.navigate([], {queryParams: value, replaceUrl: true});\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.dataSource.disconnect();\r\n    }\r\n\r\n    public getStatus(ticket: Ticket): Tag {\r\n        return ticket.tags.filter(tag => tag.type === 'status')[0];\r\n    }\r\n\r\n    public openConversation(ticket: Ticket) {\r\n        this.router.navigate(['/help-center/tickets', ticket.id]);\r\n    }\r\n}\r\n","<div class=\"suggestions-container\" [class.has-results]=\"articles.length\">\r\n    <div class=\"input-container\">\r\n        <input class=\"search-input\" type=\"text\" [attr.placeholder]=\"placeholder\" [formControl]=\"searchQuery\">\r\n        <mat-icon svgIcon=\"search\" class=\"search-icon input-icon\" [class.searching]=\"searching\"></mat-icon>\r\n    </div>\r\n\r\n    <section class=\"results-container\">\r\n        <div class=\"results-header\" trans>Were you looking for:</div>\r\n        <div class=\"results\" customScrollbar>\r\n            <a class=\"result\" *ngFor=\"let article of articles\" (click)=\"updateSearchLogger()\" [routerLink]=\"this.urls.article(article)\" target=\"_blank\">\r\n                <mat-icon svgIcon=\"description\"></mat-icon>\r\n                <span class=\"title\">{{article.title}}</span>\r\n            </a>\r\n        </div>\r\n    </section>\r\n</div>","import {Component, Input, OnInit, EventEmitter, ViewEncapsulation, Output} from '@angular/core';\r\nimport {FormControl} from '@angular/forms';\r\nimport {HelpCenterService} from '../../help-center/shared/help-center.service';\r\nimport {HcUrls} from '../../help-center/shared/hc-urls.service';\r\nimport {Article} from '../../shared/models/Article';\r\nimport {catchError, debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\r\nimport {of} from 'rxjs';\r\nimport {SearchTermLoggerService} from '../../help-center/front/search-term-logger.service';\r\n\r\n@Component({\r\n    selector: 'suggested-articles-drawer',\r\n    templateUrl: './suggested-articles-drawer.component.html',\r\n    styleUrls: ['./suggested-articles-drawer.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class SuggestedArticlesDrawerComponent implements OnInit {\r\n    @Input() public placeholder: string;\r\n    @Input() public categories: number[];\r\n    @Output() public inputValue = new EventEmitter();\r\n\r\n    public searchQuery = new FormControl();\r\n    public articles: Article[] = [];\r\n    public searching = false;\r\n\r\n    constructor(\r\n        private helpCenter: HelpCenterService,\r\n        public urls: HcUrls,\r\n        private searchLogger: SearchTermLoggerService,\r\n    ) {}\r\n\r\n    public ngOnInit() {\r\n        this.searchQuery.valueChanges\r\n            .pipe(\r\n                debounceTime(400),\r\n                distinctUntilChanged(),\r\n                switchMap(query => this.searchArticles(query)),\r\n                catchError(() => of({pagination: {data: []}}))\r\n            ).subscribe(response => {\r\n                this.inputValue.emit(this.searchQuery.value);\r\n                this.searching = false;\r\n                this.setSearchResults(response.pagination.data);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Search help center articles by specified query.\r\n     */\r\n    private searchArticles(query: string) {\r\n        if ( ! query) return of({pagination: {data: []}});\r\n        this.searching = true;\r\n        const params = {query, per_page: 4, categories: this.categories};\r\n        return this.helpCenter.findArticles(params);\r\n    }\r\n\r\n    /**\r\n     * Set specified search result on component instance.\r\n     */\r\n    private setSearchResults(articles: Article[]) {\r\n        if ( ! articles || ! articles.length) {\r\n            // if we've found no articles, wait until drawer\r\n            // animation completes before removing old articles\r\n            setTimeout(() => {\r\n                this.articles = [];\r\n            }, 300);\r\n        } else {\r\n            this.articles = articles;\r\n        }\r\n    }\r\n\r\n    public updateSearchLogger() {\r\n        this.searchLogger.updateSession({\r\n            clickedArticle: true,\r\n        });\r\n    }\r\n}\r\n","<ng-container *ngIf=\"content$ | async as content\">\r\n    <div class=\"left-column\">\r\n        <form (ngSubmit)=\"createTicket()\" ngNativeValidate *ngIf=\"errors$ | async as errors\">\r\n            <h1>{{content.title}}</h1>\r\n\r\n            <div class=\"input-container category-input-container\">\r\n                <label for=\"category-select\">{{content.categoryLabel}}</label>\r\n                <select name=\"category\" id=\"category-select\" [(ngModel)]=\"ticketModel.category\">\r\n                    <option [ngValue]=\"category\" *ngFor=\"let category of ticketCategories\">{{category.name}}</option>\r\n                </select>\r\n                <div class=\"errors category-error\" *ngIf=\"errors.category || errors.purchase_code\">{{errors.category || errors.purchase_code}}</div>\r\n            </div>\r\n\r\n            <div class=\"input-container subject-input-container\">\r\n                <label for=\"subject\">{{content.subjectLabel}}</label>\r\n                <suggested-articles-drawer id=\"subject\" (inputValue)=\"ticketModel.subject = $event\" [categories]=\"getArticleCategories()\" trans-placeholder></suggested-articles-drawer>\r\n                <div class=\"errors subject-error\" *ngIf=\"errors.subject\">{{errors.subject}}</div>\r\n            </div>\r\n\r\n            <div class=\"input-container description-input-container\">\r\n                <label for=\"description\">{{content.descriptionLabel}}</label>\r\n                <text-editor id=\"description\" inlineUploadPrefix=\"ticket_images\" (onFileUpload)=\"uploadFiles($event)\" (onChange)=\"ticketModel.body = $event\" [minHeight]=\"230\"></text-editor>\r\n                <upload-progress-bar></upload-progress-bar>\r\n                <div class=\"errors body-error\" *ngIf=\"errors.body\">{{errors.body}}</div>\r\n            </div>\r\n\r\n            <reply-attachment-list [attachments]=\"attachments$ | async\" (detached)=\"removeAttachment($event)\"></reply-attachment-list>\r\n\r\n            <div class=\"buttons\">\r\n                <button class=\"submit-button\" mat-raised-button color=\"accent\" type=\"submit\">{{content.submitButtonText}}</button>\r\n            </div>\r\n        </form>\r\n    </div>\r\n\r\n    <div class=\"right-column\">\r\n        <div class=\"header\">{{content.sidebarTitle}}</div>\r\n\r\n        <div class=\"tips\">\r\n            <div class=\"tip-container\" *ngFor=\"let tip of content.sidebarTips\">\r\n                <div class=\"title\">{{tip.title}}</div>\r\n                <div class=\"content\">{{tip.content}}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</ng-container>\r\n<loading-indicator [isVisible]=\"loading$ | async\" class=\"overlay\"></loading-indicator>\r\n","import {ChangeDetectionStrategy, Component, OnDestroy, OnInit, ViewChild, ViewEncapsulation} from '@angular/core';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {TicketsService} from '../tickets.service';\r\nimport {HcUrls} from '../../help-center/shared/hc-urls.service';\r\nimport {TextEditorComponent} from '@common/text-editor/text-editor.component';\r\nimport {Settings} from '@common/core/config/settings.service';\r\nimport {UploadsApiService} from '@common/uploads/uploads-api.service';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {UploadQueueService} from '@common/uploads/upload-queue/upload-queue.service';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\nimport {BehaviorSubject, ReplaySubject} from 'rxjs';\r\nimport {finalize} from 'rxjs/operators';\r\nimport {Tag} from '../../shared/models/Tag';\r\nimport {SearchTermLoggerService} from '../../help-center/front/search-term-logger.service';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\nimport {NewTicketPageContent} from '../../admin/appearance/new-ticket-appearance-panel/new-ticket-page-content';\r\n\r\ninterface TicketErrors {\r\n    category?: string;\r\n    purchase_code?: string;\r\n    subject?: string;\r\n    body?: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'new-ticket',\r\n    templateUrl: './new-ticket.component.html',\r\n    styleUrls: ['./new-ticket.component.scss'],\r\n    providers: [TicketsService, UploadQueueService],\r\n    encapsulation: ViewEncapsulation.None,\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n    host: {id: 'new-ticket'}\r\n})\r\nexport class NewTicketComponent implements OnInit, OnDestroy {\r\n    @ViewChild(TextEditorComponent, { static: false }) textEditor: TextEditorComponent;\r\n\r\n    public errors$ = new BehaviorSubject<TicketErrors>({});\r\n    public loading$ = new BehaviorSubject<boolean>(false);\r\n    public attachments$ = new BehaviorSubject<FileEntry[]>([]);\r\n\r\n    public ticketCategories: Tag[] = [];\r\n    public ticketModel: {category?: Tag, body?: string, subject?: string} = {};\r\n    public content$ = new ReplaySubject<NewTicketPageContent>(1);\r\n\r\n    constructor(\r\n        public settings: Settings,\r\n        private tickets: TicketsService,\r\n        private uploads: UploadsApiService,\r\n        private router: Router,\r\n        private urls: HcUrls,\r\n        private route: ActivatedRoute,\r\n        private toast: Toast,\r\n        private uploadQueue: UploadQueueService,\r\n        private searchLogger: SearchTermLoggerService,\r\n    ) {\r\n        this.settings.all$().subscribe(() => {\r\n            this.content$.next(this.settings.getJson('hc.newTicket.appearance', {}));\r\n        });\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.route.data.subscribe(data => {\r\n            this.ticketCategories = data.categories;\r\n            this.ticketModel.category = this.ticketCategories[0];\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.textEditor.destroyEditor();\r\n    }\r\n\r\n    public createTicket() {\r\n        this.loading$.next(true);\r\n\r\n        const payload = {\r\n            subject: this.ticketModel.subject,\r\n            body: this.ticketModel.body,\r\n            category: this.ticketModel.category && this.ticketModel.category.id,\r\n            uploads: this.uploadQueue.getAllCompleted().map(entry => entry.id)\r\n        };\r\n\r\n        this.tickets.create(payload)\r\n            .pipe(finalize(() => {\r\n                this.loading$.next(false);\r\n            }))\r\n            .subscribe(() => {\r\n                this.searchLogger.updateSessionAndStore({createdTicket: true});\r\n                this.router.navigate(this.urls.customerTicketList());\r\n                this.toast.open('Your request was successfully submitted.');\r\n            }, errors => {\r\n                this.errors$.next(errors.messages);\r\n            });\r\n    }\r\n\r\n    public uploadFiles(files: UploadedFile[]) {\r\n        this.uploadQueue.start(files).subscribe(response => {\r\n            this.attachments$.next([...this.attachments$.value, response.fileEntry]);\r\n        });\r\n    }\r\n\r\n    public removeAttachment(entry: FileEntry) {\r\n        const newAttachments = this.attachments$.value.slice();\r\n        for (let i = 0; i < newAttachments.length; i++) {\r\n            if (newAttachments[i].id === entry.id) {\r\n                newAttachments.splice(i, 1);\r\n            }\r\n        }\r\n        this.attachments$.next(newAttachments);\r\n    }\r\n\r\n    public getArticleCategories(): number[] {\r\n        return this.ticketModel.category ? this.ticketModel.category.categories.map(cat => cat.id) : [];\r\n    }\r\n}\r\n","<material-navbar menuPosition=\"header\" class=\"hc-content-navbar\">\r\n    <suggested-articles-dropdown\r\n            class=\"nav-searchbar\"\r\n            placeholder=\"Search help center...\"\r\n    ></suggested-articles-dropdown>\r\n</material-navbar>\r\n\r\n<breadcrumbs resource=\"Tickets\" resourceType=\"static\" class=\"container\"></breadcrumbs>\r\n\r\n<router-outlet></router-outlet>\r\n\r\n<customer-footer *ngIf=\"!settings.get('hc.hide_footer')\"></customer-footer>\r\n","import {Component, ViewEncapsulation} from '@angular/core';\r\nimport {Settings} from '@common/core/config/settings.service';\r\n\r\n@Component({\r\n    selector: 'customer-mailbox.customer-mailbox',\r\n    templateUrl: './customer-mailbox.component.html',\r\n    styleUrls: ['./customer-mailbox.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\n\r\nexport class CustomerMailboxComponent {\r\n    constructor(public settings: Settings) {}\r\n}\r\n","<div class=\"container\">\r\n    <div class=\"resolve-btn-container\" *ngIf=\"!conversation.get().closed_at\">\r\n        <button mat-raised-button color=\"accent\" (click)=\"markAsSolved()\" trans>Mark as solved</button>\r\n    </div>\r\n    <div class=\"ticket-container\" conversationInfiniteScroll>\r\n        <conversation-header></conversation-header>\r\n        <conversation-text-editor></conversation-text-editor>\r\n        <conversation-replies></conversation-replies>\r\n    </div>\r\n</div>\r\n<loading-indicator [isVisible]=\"conversation.replies.isLoading || conversation.isLoading\" class=\"overlay\"></loading-indicator>\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {TicketAttachmentsService} from '../../ticketing/ticket-attachments.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {Conversation} from '../../conversation/conversation.service';\r\nimport {UploadsApiService} from '@common/uploads/uploads-api.service';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {TicketsService} from '../../ticketing/tickets.service';\r\nimport {MailboxTagsService} from '../../ticketing/mailbox-tags.service';\r\n\r\n@Component({\r\n    selector: 'customer-conversation',\r\n    templateUrl: './customer-conversation.component.html',\r\n    styleUrls: ['./customer-conversation.component.scss'],\r\n    providers: [TicketAttachmentsService],\r\n})\r\nexport class CustomerConversationComponent implements OnInit {\r\n    constructor(\r\n        private route: ActivatedRoute,\r\n        public uploads: UploadsApiService,\r\n        public currentUser: CurrentUser,\r\n        public conversation: Conversation,\r\n        private tickets: TicketsService,\r\n        private tags: MailboxTagsService,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.route.data.subscribe(data => {\r\n            this.conversation.init(data.ticket);\r\n        });\r\n    }\r\n\r\n    public markAsSolved() {\r\n        const status = this.tags.getStatusTags().find(t => t.name === 'closed');\r\n        this.tickets.changeTicketStatus(this.conversation.get().id, status.name).subscribe(() => {\r\n            this.conversation.afterReplyAction.navigateToCustomerTicketsList('Ticket marked as solved.');\r\n            this.conversation.setStatus(status);\r\n        });\r\n    }\r\n}\r\n","import {RouterModule} from '@angular/router';\r\nimport {CustomerTicketsListComponent} from './customer-tickets-list/customer-tickets-list.component';\r\nimport {NewTicketComponent} from '../ticketing/new-ticket/new-ticket.component';\r\nimport {CustomerMailboxComponent} from './customer-mailbox.component';\r\nimport {CustomerConversationComponent} from './customer-conversation/customer-conversation.component';\r\nimport {TicketResolve} from '../conversation/conversation-resolve.service';\r\nimport {NewTicketCategoriesResolve} from './new-ticket-categories-resolve';\r\nimport {AuthGuard} from '@common/guards/auth-guard.service';\r\n\r\nexport const routing = RouterModule.forChild([\r\n    {path: '', component: CustomerMailboxComponent, canActivate: [AuthGuard], children: [\r\n        {\r\n            path: '',\r\n            component: CustomerTicketsListComponent\r\n        },\r\n        {\r\n            path: 'new',\r\n            component: NewTicketComponent,\r\n            resolve: {categories: NewTicketCategoriesResolve},\r\n            data: {permissions: ['tickets.create', 'tags.view']}\r\n        },\r\n        {\r\n            path: ':id',\r\n            component: CustomerConversationComponent,\r\n            resolve: {ticket: TicketResolve},\r\n        },\r\n    ]},\r\n]);\r\n\r\n","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\nimport {RouterModule} from '@angular/router';\r\nimport {CustomerTicketsListComponent} from './customer-tickets-list/customer-tickets-list.component';\r\nimport {routing} from './customer-mailbox.routing';\r\nimport {CustomerMailboxComponent} from './customer-mailbox.component';\r\nimport {NewTicketComponent} from '../ticketing/new-ticket/new-ticket.component';\r\nimport {SuggestedArticlesDrawerComponent} from '../ticketing/suggested-articles-drawer/suggested-articles-drawer.component';\r\nimport {CustomerConversationComponent} from './customer-conversation/customer-conversation.component';\r\nimport {HelpCenterSharedModule} from '../help-center/shared/help-center-shared.module';\r\nimport {ConversationModule} from '../conversation/conversation.module';\r\nimport {MatChipsModule} from '@angular/material/chips';\r\nimport {MatPaginatorModule} from '@angular/material/paginator';\r\nimport {MatSortModule} from '@angular/material/sort';\r\nimport {MatTableModule} from '@angular/material/table';\r\nimport {SuggestedArticleDropdownModule} from '../help-center/suggested-articles-dropdown/suggested-article-dropdown.module';\r\nimport {MaterialNavbarModule} from '@common/core/ui/material-navbar/material-navbar.module';\r\nimport {TextEditorModule} from '@common/text-editor/text-editor.module';\r\nimport {TranslationsModule} from '@common/core/translations/translations.module';\r\nimport {MatButtonModule} from '@angular/material/button';\r\nimport {FormatPipesModule} from '@common/core/ui/format-pipes/format-pipes.module';\r\nimport {LoadingIndicatorModule} from '@common/core/ui/loading-indicator/loading-indicator.module';\r\nimport {NoResultsMessageModule} from '@common/core/ui/no-results-message/no-results-message.module';\r\nimport {MatIconModule} from '@angular/material/icon';\r\nimport {CustomScrollbarModule} from '@common/core/ui/custom-scrollbar/custom-scrollbar.module';\r\nimport {ReplyAttachmentListModule} from '../shared/reply-attachment-list/reply-attachment-list.module';\r\nimport {CustomerFooterModule} from '../shared/customer-footer/customer-footer.module';\r\nimport {UploadsModule} from '@common/uploads/uploads.module';\r\n\r\n@NgModule({\r\n    imports:      [\r\n        CommonModule,\r\n        FormsModule,\r\n        ReactiveFormsModule,\r\n        RouterModule,\r\n        ConversationModule,\r\n        HelpCenterSharedModule,\r\n        SuggestedArticleDropdownModule,\r\n        TextEditorModule,\r\n        MaterialNavbarModule,\r\n        TranslationsModule,\r\n        LoadingIndicatorModule,\r\n        NoResultsMessageModule,\r\n        CustomScrollbarModule,\r\n        ReplyAttachmentListModule,\r\n        CustomerFooterModule,\r\n        UploadsModule,\r\n        routing,\r\n\r\n        // material\r\n        MatIconModule,\r\n        MatTableModule,\r\n        MatSortModule,\r\n        MatPaginatorModule,\r\n        MatChipsModule,\r\n        MatButtonModule,\r\n        FormatPipesModule,\r\n    ],\r\n    declarations: [\r\n        CustomerMailboxComponent,\r\n        CustomerTicketsListComponent,\r\n        NewTicketComponent,\r\n        SuggestedArticlesDrawerComponent,\r\n        CustomerConversationComponent,\r\n    ],\r\n    exports: [],\r\n})\r\nexport class CustomerMailboxModule { }\r\n","import { Injectable } from '@angular/core';\r\nimport {Router, Resolve, ActivatedRouteSnapshot, RouterStateSnapshot} from '@angular/router';\r\nimport {TicketsService} from '../ticketing/tickets.service';\r\nimport {Ticket} from '../shared/models/Ticket';\r\nimport {mergeMap} from 'rxjs/internal/operators/mergeMap';\r\nimport {EMPTY, Observable} from 'rxjs';\r\nimport {catchError} from 'rxjs/operators';\r\nimport {of} from 'rxjs/internal/observable/of';\r\n\r\nconst FAILURE_REDIRECT_URI = '/help-center/tickets';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class TicketResolve implements Resolve<Ticket> {\r\n\r\n    constructor(private tickets: TicketsService, private router: Router) {}\r\n\r\n    resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<Ticket> {\r\n        const ticketId = route.params['ticket_id'] || route.params['id'];\r\n        return this.tickets.get(+ticketId).pipe(\r\n            catchError(() => {\r\n                this.router.navigate([FAILURE_REDIRECT_URI]);\r\n                return EMPTY;\r\n            }),\r\n            mergeMap(response => {\r\n                if (! response.ticket) {\r\n                    this.router.navigate([FAILURE_REDIRECT_URI]);\r\n                    return EMPTY;\r\n                } else {\r\n                    return of(response.ticket);\r\n                }\r\n            })\r\n        );\r\n    }\r\n}\r\n","import { UploadedFile } from '../uploaded-file';\r\n\r\nexport async function readUploadedFolders(entries: WebKitEntry[]): Promise<UploadedFile[]> {\r\n    let files = [];\r\n\r\n    for (const key in entries) {\r\n        const entry = entries[key];\r\n\r\n        if ( ! entry.isDirectory) {\r\n            files.push(await transformFileEntry(entry as WebKitFileEntry));\r\n        } else {\r\n            files = files.concat(await readDirRecursive(entry as WebKitDirectoryEntry));\r\n        }\r\n    }\r\n\r\n    return files;\r\n}\r\n\r\nasync function readDirRecursive(entry: WebKitDirectoryEntry, files = []) {\r\n    const entries = await readEntries(entry);\r\n\r\n    for (const key in entries) {\r\n        const childEntry = entries[key];\r\n\r\n        if (childEntry.isDirectory) {\r\n            await readDirRecursive(childEntry as WebKitDirectoryEntry, files);\r\n        } else {\r\n            files.push(await transformFileEntry(childEntry as WebKitFileEntry));\r\n        }\r\n    }\r\n\r\n    return files;\r\n}\r\n\r\nfunction readEntries(dir: WebKitDirectoryEntry): Promise<WebKitEntry[]> {\r\n    return new Promise(resolve => {\r\n        const reader = dir.createReader();\r\n        reader.readEntries(entries => resolve(entries as any));\r\n    });\r\n}\r\n\r\nfunction transformFileEntry(entry: WebKitFileEntry) {\r\n    return new Promise(resolve => {\r\n        entry.file((file: any) => {\r\n            resolve(new UploadedFile(file as File, entry.fullPath));\r\n        });\r\n    });\r\n}\r\n","import { Directive, ElementRef, EventEmitter, Input, OnDestroy, OnInit, Output } from '@angular/core';\r\nimport { openUploadWindow } from '../utils/open-upload-window';\r\nimport { UploadedFile } from '../uploaded-file';\r\nimport { readUploadedFolders } from '../utils/read-uploaded-folders';\r\nimport { UploadInputConfig } from '@common/uploads/upload-input-config';\r\n\r\n@Directive({\r\n    selector: '[fileDropzone]',\r\n})\r\nexport class UploadDropzoneDirective implements OnInit, OnDestroy {\r\n    @Input() disableDropzoneClick = false;\r\n    @Input() disableDropzone = false;\r\n    @Input() clickButton: ElementRef;\r\n    @Input('fileDropzone') uploadConfig: UploadInputConfig = {};\r\n    @Output() filesDropped: EventEmitter<UploadedFile[]> = new EventEmitter();\r\n\r\n    constructor(protected el: ElementRef) {}\r\n\r\n    ngOnInit() {\r\n        const el = this.el.nativeElement;\r\n        el.addEventListener('dragenter', (e) => this.handleDragEnter(e));\r\n        el.addEventListener('dragover', (e) => this.handleDragOver(e));\r\n        el.addEventListener('dragleave', (e) => this.handleDragLeave(e));\r\n        el.addEventListener('drop', (e) => this.handleDrop(e));\r\n\r\n        if ( ! this.disableDropzoneClick) {\r\n            const trigger = this.clickButton ? this.clickButton.nativeElement : el;\r\n            trigger.addEventListener('click', () => this.handleClick());\r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.removeClassesFromDropzone();\r\n    }\r\n\r\n    protected handleClick() {\r\n        if (this.disableDropzone) return;\r\n        openUploadWindow(this.uploadConfig).then(files => {\r\n            this.emitUploadEvent(files);\r\n        });\r\n    }\r\n\r\n    public handleDragEnter(e) {\r\n        if (this.dropzoneDisabled(e)) return;\r\n        this.el.nativeElement.classList.add('file-over-dropzone');\r\n    }\r\n\r\n    public handleDragOver(e) {\r\n        if (e.preventDefault) e.preventDefault();\r\n        e.dataTransfer.dropEffect = this.dropzoneDisabled(e) ? 'none' : 'move';\r\n        return false;\r\n    }\r\n\r\n    public handleDragLeave(e: MouseEvent) {\r\n        const newEl = document.elementFromPoint(e.clientX, e.clientY);\r\n        if (this.el.nativeElement.contains(newEl)) return;\r\n        this.removeClassesFromDropzone();\r\n    }\r\n\r\n    public async handleDrop(e) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        this.removeClassesFromDropzone();\r\n        if (this.dropzoneDisabled(e) || !e.dataTransfer.items) return;\r\n\r\n        const items = Array.from(e.dataTransfer.items)\r\n            .filter((item: DataTransferItem) => item.kind === 'file')\r\n            .map((item: DataTransferItem) => {\r\n                return item.webkitGetAsEntry();\r\n            });\r\n\r\n        if (items.length) {\r\n            this.emitUploadEvent(await readUploadedFolders(items));\r\n        }\r\n    }\r\n\r\n    protected emitUploadEvent(files: UploadedFile[]) {\r\n        this.filesDropped.emit(files);\r\n    }\r\n\r\n    protected removeClassesFromDropzone() {\r\n        this.el.nativeElement.classList.remove('file-over-dropzone');\r\n    }\r\n\r\n    protected dropzoneDisabled(e: DragEvent) {\r\n        const hasFiles = e.dataTransfer.types.find(type => type.toLowerCase() === 'files');\r\n        return this.disableDropzone || ! hasFiles;\r\n    }\r\n}\r\n","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\nimport {RouterModule} from '@angular/router';\r\nimport {ConversationToolbarComponent} from './conversation-toolbar/conversation-toolbar.component';\r\nimport {ConversationHeaderComponent} from './conversation-header/conversation-header.component';\r\nimport {ConversationRepliesComponent} from './conversation-replies/conversation-replies.component';\r\nimport {ConversationTextEditorComponent} from './conversation-text-editor/conversation-text-editor.component';\r\nimport {ConversationSidebarComponent} from './conversation-sidebar/conversation-sidebar.component';\r\nimport {AddNoteModalComponent} from '../ticketing/add-note-modal/add-note-modal.component';\r\nimport {ConversationModalComponent} from './conversation-modal/conversation-modal.component';\r\nimport {ConversationComponent} from './conversation.component';\r\nimport {UpdateReplyModalComponent} from '../ticketing/update-reply-modal/update-reply-modal.component';\r\nimport {CannedRepliesDropdownComponent} from '../ticketing/canned-replies/dropdown/canned-replies-dropdown.component';\r\nimport {ConfirmReplyDeleteModalComponent} from './confirm-reply-delete-modal/confirm-reply-delete-modal.component';\r\nimport {ShowOriginalReplyModalComponent} from './conversation-replies/show-original-reply-modal/show-original-reply-modal.component';\r\nimport {CannedRepliesService} from '../ticketing/canned-replies/canned-replies.service';\r\nimport {Conversation} from './conversation.service';\r\nimport {TicketResolve} from './conversation-resolve.service';\r\nimport {AssignTicketDropdownComponent} from '../ticketing/assign-ticket-dropdown/assign-ticket-dropdown.component';\r\nimport {AddTagDropdownComponent} from '../ticketing/add-tag-dropdown/add-tag-dropdown.component';\r\nimport {TicketsService} from '../ticketing/tickets.service';\r\nimport {TagService} from '../shared/tag.service';\r\nimport {CrupdateCannedReplyModalComponent} from '../ticketing/canned-replies/crupdate-canned-reply-modal/crupdate-canned-reply-modal.component';\r\nimport {Draft} from './draft.service';\r\nimport {ConversationReplies} from './conversation-replies.service';\r\nimport {AfterReplyAction} from './after-reply-action.service';\r\nimport {TicketAttachmentsService} from '../ticketing/ticket-attachments.service';\r\nimport {TextEditorModule} from '@common/text-editor/text-editor.module';\r\nimport {FilePreviewModule} from '@common/file-preview/file-preview.module';\r\nimport {MatDialogModule} from '@angular/material/dialog';\r\nimport {SuggestedArticleDropdownModule} from '../help-center/suggested-articles-dropdown/suggested-article-dropdown.module';\r\nimport {MaterialNavbarModule} from '@common/core/ui/material-navbar/material-navbar.module';\r\nimport {MatIconModule} from '@angular/material/icon';\r\nimport {MatMenuModule} from '@angular/material/menu';\r\nimport {MatButtonModule} from '@angular/material/button';\r\nimport {TranslationsModule} from '@common/core/translations/translations.module';\r\nimport {FormatPipesModule} from '@common/core/ui/format-pipes/format-pipes.module';\r\nimport {MatTooltipModule} from '@angular/material/tooltip';\r\nimport {LoadingIndicatorModule} from '@common/core/ui/loading-indicator/loading-indicator.module';\r\nimport {ReplyAttachmentListModule} from '../shared/reply-attachment-list/reply-attachment-list.module';\r\nimport {UploadsModule} from '@common/uploads/uploads.module';\r\nimport {ConversationInfiniteScrollDirective} from '../shared/conversation-infinite-scroll.directive';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        ReactiveFormsModule,\r\n        RouterModule,\r\n        TextEditorModule,\r\n        FilePreviewModule,\r\n        MaterialNavbarModule,\r\n        TranslationsModule,\r\n        FormatPipesModule,\r\n        LoadingIndicatorModule,\r\n        ReplyAttachmentListModule,\r\n        UploadsModule,\r\n\r\n        // conversation article search\r\n        SuggestedArticleDropdownModule,\r\n\r\n        // material\r\n        MatTooltipModule,\r\n        MatDialogModule,\r\n        MatIconModule,\r\n        MatMenuModule,\r\n        MatButtonModule,\r\n    ],\r\n    declarations: [\r\n        ConversationToolbarComponent,\r\n        ConversationHeaderComponent,\r\n        ConversationRepliesComponent,\r\n        ConversationTextEditorComponent,\r\n        ConversationSidebarComponent,\r\n        AddNoteModalComponent,\r\n        ConversationModalComponent,\r\n        ConversationComponent,\r\n        UpdateReplyModalComponent,\r\n        CrupdateCannedReplyModalComponent,\r\n        CannedRepliesDropdownComponent,\r\n        ConfirmReplyDeleteModalComponent,\r\n        ShowOriginalReplyModalComponent,\r\n        AssignTicketDropdownComponent,\r\n        AddTagDropdownComponent,\r\n        ConversationInfiniteScrollDirective,\r\n    ],\r\n    exports: [\r\n        ConversationHeaderComponent,\r\n        ConversationTextEditorComponent,\r\n        ConversationRepliesComponent,\r\n        AddTagDropdownComponent,\r\n        AssignTicketDropdownComponent,\r\n        AddNoteModalComponent,\r\n        ConversationInfiniteScrollDirective,\r\n    ],\r\n    providers: [\r\n        CannedRepliesService,\r\n        Conversation,\r\n        ConversationReplies,\r\n        TicketsService,\r\n        TicketAttachmentsService,\r\n        TicketResolve,\r\n        TagService,\r\n        Draft,\r\n        AfterReplyAction,\r\n    ]\r\n})\r\nexport class ConversationModule { }\r\n","import { Directive, ElementRef, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { openUploadWindow } from '../utils/open-upload-window';\r\nimport { UploadInputConfig } from '../upload-input-config';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\n\r\n@Directive({\r\n    selector: '[uploadButton]'\r\n})\r\nexport class UploadButtonDirective implements OnInit {\r\n    @Input('uploadButton') config: UploadInputConfig = {};\r\n    @Output() filesSelected = new EventEmitter<UploadedFile[]>();\r\n\r\n    constructor(private el: ElementRef) {}\r\n\r\n    ngOnInit() {\r\n        this.el.nativeElement.addEventListener('click', e => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            openUploadWindow(this.config).then(files => {\r\n                if (files && files.length) {\r\n                    this.filesSelected.emit(files);\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar scheduleObservable_1 = require(\"./scheduleObservable\");\nvar schedulePromise_1 = require(\"./schedulePromise\");\nvar scheduleArray_1 = require(\"./scheduleArray\");\nvar scheduleIterable_1 = require(\"./scheduleIterable\");\nvar isInteropObservable_1 = require(\"../util/isInteropObservable\");\nvar isPromise_1 = require(\"../util/isPromise\");\nvar isArrayLike_1 = require(\"../util/isArrayLike\");\nvar isIterable_1 = require(\"../util/isIterable\");\nfunction scheduled(input, scheduler) {\n    if (input != null) {\n        if (isInteropObservable_1.isInteropObservable(input)) {\n            return scheduleObservable_1.scheduleObservable(input, scheduler);\n        }\n        else if (isPromise_1.isPromise(input)) {\n            return schedulePromise_1.schedulePromise(input, scheduler);\n        }\n        else if (isArrayLike_1.isArrayLike(input)) {\n            return scheduleArray_1.scheduleArray(input, scheduler);\n        }\n        else if (isIterable_1.isIterable(input) || typeof input === 'string') {\n            return scheduleIterable_1.scheduleIterable(input, scheduler);\n        }\n    }\n    throw new TypeError((input !== null && typeof input || input) + ' is not observable');\n}\nexports.scheduled = scheduled;\n//# sourceMappingURL=scheduled.js.map","import {Component, EventEmitter, Input, OnInit, Output, ViewChild} from '@angular/core';\r\nimport {FormControl} from '@angular/forms';\r\nimport {TicketsService} from '../tickets.service';\r\nimport {TagService} from '../../shared/tag.service';\r\nimport {Tag} from '../../shared/models/Tag';\r\nimport {debounceTime, distinctUntilChanged} from 'rxjs/operators';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {MatMenuTrigger} from '@angular/material/menu';\r\nimport {PaginationParams} from '@common/core/types/pagination/pagination-params';\r\n\r\n@Component({\r\n    selector: 'add-tag-dropdown',\r\n    templateUrl: './add-tag-dropdown.component.html',\r\n    styleUrls: ['./add-tag-dropdown.component.scss'],\r\n})\r\nexport class AddTagDropdownComponent implements OnInit {\r\n    @ViewChild(MatMenuTrigger, { static: true }) trigger: MatMenuTrigger;\r\n\r\n    @Input() ticketIds: number[] = [];\r\n    @Output() tagAdded: EventEmitter<Tag> = new EventEmitter();\r\n\r\n    public tags: Tag[];\r\n    public tagQuery = new FormControl();\r\n    public searchedOnce = false;\r\n\r\n    constructor(\r\n        private tickets: TicketsService,\r\n        private tagService: TagService,\r\n        private toast: Toast,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.bindTagQueryInput();\r\n\r\n        this.trigger.menuOpened.subscribe(() => {\r\n            if ( ! this.searchedOnce) {\r\n                this.searchForTags(null, {perPage: 5});\r\n            }\r\n        });\r\n\r\n        this.trigger.menuClosed.subscribe(() => {\r\n            this.clearSearchField();\r\n        });\r\n    }\r\n\r\n    public open() {\r\n        this.trigger.openMenu();\r\n    }\r\n\r\n    public close() {\r\n        this.trigger.closeMenu();\r\n    }\r\n\r\n    public addTag(tagName: string) {\r\n        this.tickets.addTag(tagName, this.ticketIds).subscribe(response => {\r\n            this.clearSearchField();\r\n            this.toast.open('Tag added');\r\n            this.tagAdded.emit(response.data);\r\n        });\r\n    }\r\n\r\n    public clearSearchField() {\r\n        if ( ! this.tagQuery.value) return;\r\n        this.tagQuery.setValue(null);\r\n    }\r\n\r\n    private bindTagQueryInput() {\r\n        this.tagQuery.valueChanges\r\n            .pipe(debounceTime(300), distinctUntilChanged())\r\n            .subscribe(query => {\r\n                this.searchForTags(query);\r\n            });\r\n    }\r\n\r\n    private searchForTags(query?: string, params: PaginationParams = {}) {\r\n        this.tagService.search(query, params)\r\n            .subscribe(response => this.tags = response.pagination.data);\r\n    }\r\n\r\n    public trackByFn = (i: number, tag: Tag) => tag.id;\r\n}\r\n","<button class=\"no-style add-tag-button toolbar-item\" [matMenuTriggerFor]=\"addTagMenu\"><mat-icon svgIcon=\"add-tag-custom\"></mat-icon></button>\r\n\r\n<mat-menu #addTagMenu=\"matMenu\" [overlapTrigger]=\"false\" class=\"add-tag-menu\">\r\n    <form class=\"input-container\" (ngSubmit)=\"addTag(tagQuery.value)\" (click)=\"$event.stopPropagation()\">\r\n        <input type=\"text\" [formControl]=\"tagQuery\" (keydown)=\"$event.stopPropagation()\" mat-menu-item class=\"tag-search-input\">\r\n    </form>\r\n    <button mat-menu-item class=\"tag-item\" *ngFor=\"let tag of tags; trackBy: trackByFn\" (click)=\"addTag(tag.name)\">{{tag.name}}</button>\r\n</mat-menu>\r\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isFunction_1 = require(\"./util/isFunction\");\nvar Observer_1 = require(\"./Observer\");\nvar Subscription_1 = require(\"./Subscription\");\nvar rxSubscriber_1 = require(\"../internal/symbol/rxSubscriber\");\nvar config_1 = require(\"./config\");\nvar hostReportError_1 = require(\"./util/hostReportError\");\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destinationOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this.syncErrorValue = null;\n        _this.syncErrorThrown = false;\n        _this.syncErrorThrowable = false;\n        _this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                _this.destination = Observer_1.empty;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    _this.destination = Observer_1.empty;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n                        _this.destination = destinationOrNext;\n                        destinationOrNext.add(_this);\n                    }\n                    else {\n                        _this.syncErrorThrowable = true;\n                        _this.destination = new SafeSubscriber(_this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                _this.syncErrorThrowable = true;\n                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n                break;\n        }\n        return _this;\n    }\n    Subscriber.prototype[rxSubscriber_1.rxSubscriber] = function () { return this; };\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _parentOrParents = this._parentOrParents;\n        this._parentOrParents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parentOrParents = _parentOrParents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription_1.Subscription));\nexports.Subscriber = Subscriber;\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = _this;\n        if (isFunction_1.isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== Observer_1.empty) {\n                context = Object.create(observerOrNext);\n                if (isFunction_1.isFunction(context.unsubscribe)) {\n                    _this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = _this.unsubscribe.bind(_this);\n            }\n        }\n        _this._context = context;\n        _this._next = next;\n        _this._error = error;\n        _this._complete = complete;\n        return _this;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!config_1.config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            var useDeprecatedSynchronousErrorHandling = config_1.config.useDeprecatedSynchronousErrorHandling;\n            if (this._error) {\n                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                if (useDeprecatedSynchronousErrorHandling) {\n                    throw err;\n                }\n                hostReportError_1.hostReportError(err);\n            }\n            else {\n                if (useDeprecatedSynchronousErrorHandling) {\n                    _parentSubscriber.syncErrorValue = err;\n                    _parentSubscriber.syncErrorThrown = true;\n                }\n                else {\n                    hostReportError_1.hostReportError(err);\n                }\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!config_1.config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                throw err;\n            }\n            else {\n                hostReportError_1.hostReportError(err);\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        if (!config_1.config.useDeprecatedSynchronousErrorHandling) {\n            throw new Error('bad call');\n        }\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                parent.syncErrorValue = err;\n                parent.syncErrorThrown = true;\n                return true;\n            }\n            else {\n                hostReportError_1.hostReportError(err);\n                return true;\n            }\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\nexports.SafeSubscriber = SafeSubscriber;\n//# sourceMappingURL=Subscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isObject(x) {\n    return x !== null && typeof x === 'object';\n}\nexports.isObject = isObject;\n//# sourceMappingURL=isObject.js.map","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {MatButtonModule} from '@angular/material/button';\r\nimport {MatIconModule} from '@angular/material/icon';\r\nimport {MatProgressBarModule} from '@angular/material/progress-bar';\r\nimport {UploadButtonDirective} from './directives/upload-button.directive';\r\nimport {UploadDropzoneDirective} from './directives/upload-dropzone.directive';\r\nimport {UploadProgressBarComponent} from './upload-progress-bar/upload-progress-bar.component';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n\r\n        // material\r\n        MatButtonModule,\r\n        MatProgressBarModule,\r\n        MatIconModule,\r\n    ],\r\n    declarations: [\r\n        UploadDropzoneDirective,\r\n        UploadButtonDirective,\r\n        UploadProgressBarComponent,\r\n    ],\r\n    exports: [\r\n        UploadDropzoneDirective,\r\n        UploadButtonDirective,\r\n        UploadProgressBarComponent,\r\n    ],\r\n})\r\nexport class UploadsModule {\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar config_1 = require(\"./config\");\nvar hostReportError_1 = require(\"./util/hostReportError\");\nexports.empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) {\n        if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n            throw err;\n        }\n        else {\n            hostReportError_1.hostReportError(err);\n        }\n    },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map","import {Component, OnInit, ViewEncapsulation} from '@angular/core';\r\nimport {ConversationModalComponent} from '../conversation-modal/conversation-modal.component';\r\nimport {User} from '../../shared/models/User';\r\nimport {Ticket} from '../../shared/models/Ticket';\r\nimport {Conversation} from '../conversation.service';\r\nimport {TicketsService} from '../../ticketing/tickets.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {Modal} from '@common/core/ui/dialogs/modal.service';\r\nimport {PurchaseCode} from '../../shared/models/PurchaseCode';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {FindUserModalComponent} from '@common/auth/find-user-modal/find-user-modal.component';\r\n\r\n@Component({\r\n    selector: 'conversation-sidebar',\r\n    templateUrl: './conversation-sidebar.component.html',\r\n    styleUrls: ['./conversation-sidebar.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationSidebarComponent implements OnInit {\r\n    public requester: User;\r\n    public otherTickets: Ticket[];\r\n    public previousTicketsVisible = true;\r\n    public envatoPurchase: PurchaseCode;\r\n    private activeTicket: Ticket;\r\n\r\n    constructor(\r\n        private modal: Modal,\r\n        private tickets: TicketsService,\r\n        private conversation: Conversation,\r\n        private route: ActivatedRoute,\r\n        private toast: Toast,\r\n    ) { }\r\n\r\n    ngOnInit() {\r\n        this.route.data.subscribe(data => {\r\n            this.activeTicket = data.ticket;\r\n            this.loadUserData();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Show given ticket in a modal.\r\n     */\r\n    public openTicketModal(ticketId: number) {\r\n        const params = {ticketId: ticketId, activeTicketId: this.conversation.get().id};\r\n\r\n        // if tickets were merged, set merged ticket on conversation\r\n        // service and remove merged ticket from sidebar\r\n        this.modal.open(ConversationModalComponent, params, 'conversation-modal-container')\r\n            .afterClosed()\r\n            .subscribe(mergedTicket => {\r\n                if ( ! mergedTicket) return;\r\n                this.otherTickets = this.otherTickets.filter(ticket => ticket.id !== ticketId);\r\n                this.conversation.init(mergedTicket);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Get tickets (except currently active one) of active ticket requester.\r\n     */\r\n    private getUserTicketsExceptCurrent() {\r\n        this.requester = this.activeTicket.user;\r\n\r\n        if ( ! this.requester) return;\r\n\r\n        this.tickets.getTickets({user_id: this.requester.id, per_page: 6}).subscribe(response => {\r\n            this.otherTickets = response.pagination.data.filter(ticket => {\r\n                // skip currently open ticket\r\n                return ticket.id !== this.activeTicket.id;\r\n            });\r\n        });\r\n    }\r\n\r\n    public setEnvatoPurchase() {\r\n        const category = this.conversation.getCategory();\r\n        if ( ! this.requester.purchase_codes.length || ! category) return;\r\n        const categoryName = category.name.toLowerCase();\r\n        const bestMatch = this.requester.purchase_codes.find(code => {\r\n            return code.item_name.toLowerCase().indexOf(categoryName) > -1;\r\n        });\r\n        this.envatoPurchase = bestMatch || this.requester.purchase_codes[0];\r\n    }\r\n\r\n    public changeCustomer() {\r\n        this.modal.open(FindUserModalComponent).beforeClosed()\r\n            .subscribe(user => {\r\n                if ( ! user) return;\r\n                this.tickets.update(this.activeTicket.id, {user_id: user.id})\r\n                    .subscribe(() => {\r\n                        this.requester = user;\r\n                        this.loadUserData();\r\n                        this.toast.open('Customer changed.');\r\n                    });\r\n            });\r\n    }\r\n\r\n    private loadUserData() {\r\n        this.getUserTicketsExceptCurrent();\r\n        this.setEnvatoPurchase();\r\n    }\r\n}\r\n","<div class=\"user-info\" *ngIf=\"requester\">\r\n    <a class=\"avatar\" [routerLink]=\"['/mailbox/users', requester.id]\">\r\n        <img [src]=\"requester.avatar\" alt=\"Avatar\">\r\n    </a>\r\n\r\n    <div class=\"user-details\">\r\n        <div class=\"name\">\r\n            <div class=\"text\" [title]=\"requester.display_name\">{{requester.display_name}}</div>\r\n            <button mat-icon-button [matMenuTriggerFor]=\"editCustomerMenu\">\r\n                <mat-icon svgIcon=\"settings\"></mat-icon>\r\n            </button>\r\n        </div>\r\n        <div class=\"info-line\">\r\n            <mat-icon svgIcon=\"mail\"></mat-icon>\r\n            <span [title]=\"requester.email\">{{requester.email}}</span>\r\n        </div>\r\n\r\n        <mat-menu #editCustomerMenu=\"matMenu\">\r\n            <a mat-menu-item [routerLink]=\"['/mailbox/users', requester.id]\" trans>Edit Profile</a>\r\n            <button mat-menu-item (click)=\"changeCustomer()\" trans>Change Customer</button>\r\n        </mat-menu>\r\n\r\n        <div class=\"info-container\" *ngIf=\"envatoPurchase\">\r\n            <div class=\"info-title\">\r\n                <span trans>Envato</span>\r\n            </div>\r\n            <div class=\"info-line\" *ngIf=\"envatoPurchase.envato_username\">\r\n                <mat-icon svgIcon=\"person\"></mat-icon>\r\n                <a [href]=\"'https://codecanyon.net/user/' + envatoPurchase.envato_username\" [title]=\"envatoPurchase.envato_username\" target=\"_blank\">{{envatoPurchase.envato_username}}</a>\r\n            </div>\r\n            <div class=\"info-line\" [matTooltip]=\"'Supported until' | trans\" *ngIf=\"envatoPurchase.supported_until\">\r\n                <mat-icon svgIcon=\"access-time\"></mat-icon>\r\n                <span>{{envatoPurchase.supported_until | formattedDate}}</span>\r\n            </div>\r\n            <div class=\"envato-purchases\">\r\n                <div class=\"purchase-item\" *ngFor=\"let purchase of requester.purchase_codes | slice:0:5\">\r\n                    <img [src]=\"purchase.image\" alt=\"Purchase image\">\r\n                    <div class=\"purchase-name\">{{purchase.item_name}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"tickets-list-container\" [class.tickets-visible]=\"previousTicketsVisible\">\r\n    <div class=\"title\" (click)=\"previousTicketsVisible = !previousTicketsVisible\">\r\n        <span class=\"text\" trans>Other Conversations</span>\r\n        <button class=\"no-style toggle-button\"><mat-icon svgIcon=\"keyboard-arrow-down\"></mat-icon></button>\r\n    </div>\r\n\r\n    <div class=\"tickets-list toggle-container\" *ngIf=\"otherTickets\">\r\n        <div class=\"ticket\" *ngFor=\"let ticket of otherTickets\" [class.open]=\"!ticket.closed_at\" (click)=\"openTicketModal(ticket.id)\">\r\n            <mat-icon svgIcon=\"mail\"></mat-icon>\r\n            <span>{{ticket.subject}}</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar observable_1 = require(\"../symbol/observable\");\nfunction isInteropObservable(input) {\n    return input && typeof input[observable_1.observable] === 'function';\n}\nexports.isInteropObservable = isInteropObservable;\n//# sourceMappingURL=isInteropObservable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isScheduler_1 = require(\"../util/isScheduler\");\nvar fromArray_1 = require(\"./fromArray\");\nvar scheduleArray_1 = require(\"../scheduled/scheduleArray\");\nfunction of() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = args[args.length - 1];\n    if (isScheduler_1.isScheduler(scheduler)) {\n        args.pop();\n        return scheduleArray_1.scheduleArray(args, scheduler);\n    }\n    else {\n        return fromArray_1.fromArray(args);\n    }\n}\nexports.of = of;\n//# sourceMappingURL=of.js.map","import {Injectable} from '@angular/core';\r\nimport {HttpCacheClient} from '@common/core/http/http-cache-client';\r\nimport {BackendResponse} from '@common/core/types/backend-response';\r\nimport {Tag} from './models/Tag';\r\nimport {PaginatedBackendResponse} from '@common/core/types/pagination/paginated-backend-response';\r\nimport {PaginationParams} from '@common/core/types/pagination/pagination-params';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TagService {\r\n    private baseUri = 'tags';\r\n\r\n    constructor(private http: HttpCacheClient) {}\r\n\r\n    public getTags(params?: PaginationParams): PaginatedBackendResponse<Tag> {\r\n        return this.http.getWithCache(this.baseUri, params);\r\n    }\r\n\r\n    public createNew(data: Partial<Tag>): BackendResponse<{tag: Tag}> {\r\n        return this.http.post(this.baseUri, data);\r\n    }\r\n\r\n    public update(id: number, data: Partial<Tag>): BackendResponse<{tag: Tag}> {\r\n        return this.http.put(this.baseUri + '/' + id, data);\r\n    }\r\n\r\n    public deleteMultiple(ids: number[]) {\r\n        return this.http.delete(this.baseUri + '/delete-multiple', {ids});\r\n    }\r\n\r\n    public search(query: string, params: PaginationParams = {}): PaginatedBackendResponse<Tag> {\r\n        params = {\r\n            ...{query, notType: 'status', perPage: 10},\r\n            ...params\r\n        };\r\n        return this.http.get(this.baseUri, params);\r\n    }\r\n}\r\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {ReplyAttachmentListComponent} from './reply-attachment-list.component';\nimport {MatButtonModule} from '@angular/material/button';\nimport {MatIconModule} from '@angular/material/icon';\nimport {FormatPipesModule} from '@common/core/ui/format-pipes/format-pipes.module';\nimport {FilePreviewOverlayComponent} from '../file-preview-overlay/file-preview-overlay.component';\nimport {FilePreviewToolbarComponent} from '../file-preview-overlay/file-preview-toolbar/file-preview-toolbar.component';\nimport {FilePreviewModule} from '@common/file-preview/file-preview.module';\n\n@NgModule({\n    declarations: [\n        ReplyAttachmentListComponent,\n        FilePreviewOverlayComponent,\n        FilePreviewToolbarComponent,\n    ],\n    imports: [\n        CommonModule,\n        FilePreviewModule,\n\n        // material\n        MatButtonModule,\n        MatIconModule,\n        FormatPipesModule,\n    ],\n    exports: [\n        ReplyAttachmentListComponent,\n    ],\n})\nexport class ReplyAttachmentListModule {\n}\n","import {Injectable} from '@angular/core';\r\nimport {Reply} from '../shared/models/Reply';\r\nimport {TicketsService} from '../ticketing/tickets.service';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class ConversationReplies {\r\n\r\n    /**\r\n     * Current conversation replies.\r\n     */\r\n    private replies: Reply[] = [];\r\n\r\n    /**\r\n     * Current replies infinite load page.\r\n     */\r\n    public currentPage = 1;\r\n\r\n    /**\r\n     * Last replies infinite load page.\r\n     */\r\n    public lastPage = 2;\r\n\r\n    /**\r\n     * Whether replies are currently being loaded.\r\n     */\r\n    public isLoading = false;\r\n\r\n    /**\r\n     * ID of currently active ticket.\r\n     */\r\n    private ticketId: number;\r\n\r\n    /**\r\n     * ConversationReplies service constructor.\r\n     */\r\n    constructor(private tickets: TicketsService, private toast: Toast) {}\r\n\r\n    /**\r\n     * Get current conversation replies.\r\n     */\r\n    public get() {\r\n        return this.replies;\r\n    }\r\n\r\n    /**\r\n     * Add specified reply.\r\n     */\r\n    public add(reply: Reply) {\r\n        // if specified reply does not have ID, bail\r\n        if ( ! reply || ! reply.id) return;\r\n\r\n        // if reply does not already exist, add it to replies array\r\n        if ( ! this.replies.find(existing => existing.id === reply.id)) {\r\n            this.replies.unshift(reply);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Replace existing reply with specified one.\r\n     */\r\n    public replace(newReply: Reply) {\r\n        const index = this.replies.findIndex(oldReply => oldReply.id === newReply.id);\r\n        this.replies[index] = newReply;\r\n    }\r\n\r\n    /**\r\n     * Remove specified reply.\r\n     */\r\n    public remove(replyId: number) {\r\n        this.replies = this.replies.filter(reply => reply.id !== replyId);\r\n    }\r\n\r\n    /**\r\n     * Delete specified reply from server.\r\n     */\r\n    public delete(reply: Reply) {\r\n        const method = reply.type === 'drafts' ? 'deleteDraft' : 'deleteReply';\r\n\r\n        this.tickets[method](reply.id).subscribe(() => {\r\n            this.remove(reply.id);\r\n            this.toast.open('Deleted successfully');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Load next page of replies from the server.\r\n     */\r\n    public loadMore() {\r\n        if (this.isLoading) return;\r\n\r\n        this.isLoading = true;\r\n\r\n        this.tickets.getTicketReplies(this.ticketId, this.currentPage + 1).subscribe(response => {\r\n            this.replies = this.replies.concat(response.pagination.data);\r\n            this.currentPage = response.pagination.current_page;\r\n            this.lastPage = response.pagination.last_page;\r\n            this.isLoading = false;\r\n        }, () => {\r\n            this.isLoading = false;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Check if more replies can be loaded from the server.\r\n     */\r\n    public canLoadMore(): boolean {\r\n        return this.currentPage < this.lastPage;\r\n    }\r\n\r\n    /**\r\n     * Init or reset conversation replies service.\r\n     */\r\n    public init(replies: Reply[], ticketId: number) {\r\n        this.replies = replies.slice();\r\n        this.currentPage = 1;\r\n        this.lastPage = 2;\r\n        this.ticketId = ticketId;\r\n    }\r\n}\r\n","import {Injectable, NgZone} from '@angular/core';\r\nimport {Settings} from '../../core/config/settings.service';\r\nimport {LazyLoaderService} from '../../core/utils/lazy-loader.service';\r\nimport {BreakpointsService} from '../../core/ui/breakpoints.service';\r\nimport {Editor, EditorManager} from 'tinymce';\r\nimport {Translations} from '../../core/translations/translations.service';\r\n\r\nconst EDITOR_TOOLBAR_HEIGHT = 74;\r\n\r\ndeclare const tinymce: EditorManager;\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TinymceTextEditor {\r\n    private bootstrapPromise: Promise<Editor> | boolean;\r\n    private bootstrapPromiseResolve: any;\r\n    private config: { [key: string]: any };\r\n    public tinymceInstance: Editor|any;\r\n\r\n    constructor(\r\n        private settings: Settings,\r\n        private zone: NgZone,\r\n        private lazyLoader: LazyLoaderService,\r\n        private breakpoints: BreakpointsService,\r\n        private i18n: Translations,\r\n    ) {\r\n        this.makeBootstrapPromise();\r\n    }\r\n\r\n    public reset() {\r\n        if (!this.editorIsReady()) return;\r\n        this.tinymceInstance.setContent('');\r\n        this.tinymceInstance.undoManager.clear();\r\n    }\r\n\r\n    public focus() {\r\n        this.waitForEditor().then(() => {\r\n            this.tinymceInstance.focus(false);\r\n        });\r\n    }\r\n\r\n    public hasUndo(): boolean {\r\n        return this.editorIsReady() && this.tinymceInstance.undoManager.hasUndo();\r\n    }\r\n\r\n    public hasRedo(): boolean {\r\n        return this.editorIsReady() && this.tinymceInstance.undoManager.hasRedo();\r\n    }\r\n\r\n    /**\r\n     * Queries the current state for specified tinymce command.\r\n     * For example if the current selection is \"bold\".\r\n     */\r\n    public queryCommandState(name: string): boolean | number {\r\n        return this.editorIsReady() && this.tinymceInstance.queryCommandState(name);\r\n    }\r\n\r\n    public execCommand(name: string, value: string | number = null) {\r\n        this.waitForEditor().then(() => {\r\n            this.zone.run(() => {\r\n                this.tinymceInstance.execCommand(name, false, value);\r\n            });\r\n        });\r\n    }\r\n\r\n    public getContents(params?: Object): string {\r\n        if (!this.editorIsReady()) return '';\r\n        return this.tinymceInstance.getContent(params);\r\n    }\r\n\r\n    public setContents(contents: string) {\r\n        this.waitForEditor().then(() => {\r\n            if (!this.tinymceInstance.undoManager) return;\r\n\r\n            this.tinymceInstance.undoManager.transact(() => {\r\n                this.tinymceInstance.setContent(contents);\r\n            });\r\n\r\n            this.tinymceInstance.selection.setCursorLocation();\r\n            this.tinymceInstance.nodeChanged();\r\n            this.tinymceInstance.execCommand('mceResize');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Insert specified contents at the end of tinymce.\r\n     */\r\n    public insertContents(contents) {\r\n        this.waitForEditor().then(() => {\r\n            this.tinymceInstance.execCommand('mceInsertContent', false, contents);\r\n            setTimeout(() => this.tinymceInstance.selection.collapse());\r\n        });\r\n    }\r\n\r\n    public insertImage(url: string) {\r\n        this.waitForEditor().then(() => {\r\n            this.insertContents('<img src=\"' + url + '\"/>');\r\n            setTimeout(() => this.execCommand('mceAutoResize'), 500);\r\n        });\r\n    }\r\n\r\n    public waitForEditor(): Promise<Editor> {\r\n        // editor already bootstrapped\r\n        if (this.tinymceInstance) {\r\n            return new Promise(resolve => resolve(this.tinymceInstance));\r\n        }\r\n        // editor is still bootstrapping\r\n        if (this.bootstrapPromise) {\r\n            return this.bootstrapPromise as Promise<Editor>;\r\n        }\r\n    }\r\n\r\n    public setConfig(config: object) {\r\n        this.config = config;\r\n        this.loadTinymce().then(() => {\r\n            this.initTinymce();\r\n        });\r\n    }\r\n\r\n    private editorIsReady(): boolean {\r\n        return !this.bootstrapPromise && !!this.tinymceInstance && !!this.tinymceInstance.undoManager;\r\n    }\r\n\r\n    private loadTinymce(): Promise<any> {\r\n        return this.lazyLoader.loadAsset('js/tinymce/tinymce.min.js', {type: 'js'});\r\n    }\r\n\r\n    private initTinymce() {\r\n        const config: any = {\r\n            target: this.config.textAreaEl.nativeElement,\r\n            plugins: ['link', 'codesample', 'paste', 'autoresize'],\r\n            branding: false,\r\n            browser_spellcheck: true,\r\n            max_height: this.config.maxHeight,\r\n            min_height: this.config.minHeight,\r\n            autoresize_on_init: false,\r\n            paste_as_text: true,\r\n            elementpath: false,\r\n            statusbar: false,\r\n            menubar: false,\r\n            convert_urls: false,\r\n            forced_root_block: false,\r\n            element_format: 'html',\r\n            body_class: 'editor-body',\r\n            content_style: `html {font-size: 62.5%;}\r\n.editor-body {font-size: 1.4rem;font-family: \"Roboto\", \"Helvetica Neue\", sans-serif;color: rgba(0, 0, 0, .87);}\r\nimg {max-width: 100%}\r\ncode[class*=language-], pre[class*=language-] {font-size: inherit;}`,\r\n            content_css: ['https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic'],\r\n            default_link_target: '_blank',\r\n            link_assume_external_targets: true,\r\n            target_list: false,\r\n            link_title: false,\r\n            image_dimensions: false,\r\n            image_description: false,\r\n            setup: editor => {\r\n                this.tinymceInstance = editor;\r\n                editor.on('change', () => this.config.onChange.emit(editor.getContent()));\r\n\r\n                editor.on('click', () => {\r\n                    // need to run angular zone on editor (iframe) click\r\n                    // so custom editor buttons are highlighted properly\r\n                    this.zone.run(() => {\r\n                    });\r\n                });\r\n\r\n                editor.shortcuts.add('ctrl+13', 'desc', () => {\r\n                    this.zone.run(() => {\r\n                        this.config.onChange.emit(editor.getContent());\r\n                        this.config.onCtrlEnter.emit();\r\n                    });\r\n                });\r\n            },\r\n            init_instance_callback: () => {\r\n                this.bootstrapPromise = false;\r\n                this.bootstrapPromiseResolve(this.tinymceInstance);\r\n            }\r\n        };\r\n\r\n        // need to show toolbar on mobile, otherwise tinymce will error out\r\n        if (!this.breakpoints.isMobile$.value) {\r\n            config.toolbar = false;\r\n        }\r\n\r\n        if (this.config['showAdvancedControls']) {\r\n            config.plugins = config.plugins.concat(['media', 'hr', 'visualblocks', 'visualchars', 'wordcount']);\r\n            config.forced_root_block = 'p';\r\n            config.statusbar = true;\r\n            config.autoresize_on_init = true;\r\n            config.extended_valid_elements = 'svg[*],use[*],iframe[src],script[src]';\r\n            config.elementpath = true;\r\n            config.content_css.push(this.settings.getAssetUrl() + 'css/advanced-editor-styles.css');\r\n            config.target_list = [\r\n                {title: this.i18n.t('Current window'), value: ''},\r\n                {title: this.i18n.t('New Window'), value: '_blank'},\r\n            ];\r\n        }\r\n\r\n        if (this.config['minHeight'] === 'auto') {\r\n            const height = this.config.editorEl.nativeElement.parentElement.offsetHeight - EDITOR_TOOLBAR_HEIGHT - 4;\r\n            config.min_height = height;\r\n            config.max_height = height;\r\n        }\r\n\r\n        tinymce.init(config);\r\n    }\r\n\r\n    public destroyEditor() {\r\n        // catch error that sometimes occurs on EDGE when\r\n        // trying to destroy editor that is no longer in the DOM\r\n        try {\r\n            if (this.tinymceInstance) {\r\n                this.tinymceInstance.remove();\r\n            }\r\n\r\n            this.tinymceInstance = null;\r\n            this.makeBootstrapPromise();\r\n        } catch (e) {\r\n            //\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create a tinymce bootstrap promise.\r\n     */\r\n    private makeBootstrapPromise() {\r\n        this.bootstrapPromise = new Promise(resolve => this.bootstrapPromiseResolve = resolve);\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { UploadValidator } from '../../uploads/validation/upload-validator';\r\nimport { FileSizeValidation } from '../../uploads/validation/validations/file-size-validation';\r\nimport { convertToBytes } from '../../core/utils/convertToBytes';\r\nimport { FileTypeValidation } from '../../uploads/validation/validations/file-type-validation';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TextEditorImageValidator extends UploadValidator {\r\n    protected readonly DEFAULT_MAX_SIZE_MB = 3;\r\n\r\n    protected initValidations() {\r\n        const validations = [\r\n            new FileSizeValidation(\r\n                {maxSize: convertToBytes(this.DEFAULT_MAX_SIZE_MB, 'MB')},\r\n                this.i18n\r\n            ),\r\n            new FileTypeValidation({types: ['image']}, this.i18n),\r\n        ];\r\n\r\n        this.validations.push(...validations);\r\n    }\r\n}\r\n","<div class=\"editor-header\">\r\n    <div class=\"toolbar-row\">\r\n        <div class=\"header-actions\" *ngIf=\"inlineUploadPrefix && currentUser.hasPermission('files.create')\">\r\n            <button class=\"no-style editor-button\" type=\"button\" [matTooltip]=\"'Add Attachment' | trans\"\r\n                    (click)=\"openFileUploadDialog()\">\r\n                <mat-icon svgIcon=\"attachment\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <div class=\"header-actions\" *ngIf=\"!basic\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('codesample')\"\r\n                    [matTooltip]=\"'Insert Code Sample' | trans\">\r\n                <mat-icon svgIcon=\"code\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('undo')\"\r\n                    [class.disabled]=\"!hasUndo()\" [matTooltip]=\"'Undo' | trans\">\r\n                <mat-icon svgIcon=\"undo\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('redo')\"\r\n                    [class.disabled]=\"!hasRedo()\" [matTooltip]=\"'Redo' | trans\">\r\n                <mat-icon svgIcon=\"redo\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('bold')\"\r\n                    [class.active]=\"queryCommandState('bold')\" [matTooltip]=\"'Bold' | trans\">\r\n                <mat-icon svgIcon=\"format-bold\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('italic')\"\r\n                    [class.active]=\"queryCommandState('italic')\" [matTooltip]=\"'Italic' | trans\">\r\n                <mat-icon svgIcon=\"format-italic\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('underline')\"\r\n                    [class.active]=\"queryCommandState('underline')\" [matTooltip]=\"'Underline' | trans\">\r\n                <mat-icon svgIcon=\"format-underlined\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('insertunorderedlist')\"\r\n                    [class.active]=\"queryCommandState('unorderedlist')\" [matTooltip]=\"'Unordered List' | trans\">\r\n                <mat-icon svgIcon=\"format-list-bulleted\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('insertorderedlist')\"\r\n                    [class.active]=\"queryCommandState('orderedlist')\" [matTooltip]=\"'Ordered List' | trans\">\r\n                <mat-icon svgIcon=\"format-list-numbered\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <div class=\"header-actions\" *ngIf=\"!basic\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('mceLink')\"\r\n                    [class.active]=\"queryCommandState('link')\" [matTooltip]=\"'Insert Link' | trans\">\r\n                <mat-icon svgIcon=\"link\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button image-modal-button\" (click)=\"openInsertImageModal()\"\r\n                    *ngIf=\"currentUser.hasPermission('files.create')\" [matTooltip]=\"'Insert Image' | trans\">\r\n                <mat-icon svgIcon=\"image\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <ng-content select=\"[customButtons]\"></ng-content>\r\n\r\n        <div class=\"header-actions last\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('removeformat')\"\r\n                    [matTooltip]=\"'Remove Formatting' | trans\">\r\n                <mat-icon svgIcon=\"format-clear\"></mat-icon>\r\n            </button>\r\n        </div>\r\n\r\n        <ng-content select=\"[header]\"></ng-content>\r\n    </div>\r\n    <div class=\"toolbar-row\" *ngIf=\"showAdvancedControls\">\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" [matMenuTriggerFor]=\"insertMenu\"\r\n                    class=\"no-style editor-button text-button insert-button\">\r\n                <span trans>Insert</span>\r\n                <mat-icon svgIcon=\"arrow-drop-down\" class=\"caret\"></mat-icon>\r\n            </button>\r\n            <mat-menu #insertMenu>\r\n                <div mat-menu-item (click)=\"execCommand('InsertHorizontalRule')\">\r\n                    <mat-icon svgIcon=\"remove\"></mat-icon>\r\n                    <span trans>Horizontal Line</span>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('mceLink')\">\r\n                    <mat-icon svgIcon=\"link\"></mat-icon>\r\n                    <span trans>Link</span>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('mceMedia')\">\r\n                    <mat-icon svgIcon=\"videocam\"></mat-icon>\r\n                    <span trans>Media</span>\r\n                </div>\r\n                <div mat-menu-item (click)=\"insertInfoContainer('important')\" trans>\r\n                    <mat-icon svgIcon=\"star\"></mat-icon>\r\n                    <span trans>Important</span>\r\n                </div>\r\n                <div mat-menu-item (click)=\"insertInfoContainer('warning')\" trans>\r\n                    <mat-icon svgIcon=\"warning\"></mat-icon>\r\n                    <span trans>Warning</span>\r\n                </div>\r\n                <div mat-menu-item (click)=\"insertInfoContainer('note')\" trans>\r\n                    <mat-icon svgIcon=\"note\"></mat-icon>\r\n                    <span trans>Note</span>\r\n                </div>\r\n            </mat-menu>\r\n        </div>\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" [matMenuTriggerFor]=\"formatMenu\" class=\"no-style editor-button text-button format-button\">\r\n                <span trans>Format</span>\r\n                <mat-icon svgIcon=\"arrow-drop-down\" class=\"caret\"></mat-icon>\r\n            </button>\r\n            <mat-menu #formatMenu class=\"format-menu menu-with-alt-text\">\r\n                <div mat-menu-item (click)=\"execCommand('FormatBlock', 'h1')\">\r\n                    <div class=\"text\" trans>Heading 1</div>\r\n                    <div class=\"alt-text\">Ctrl+Alt+1</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('FormatBlock', 'h2')\">\r\n                    <div class=\"text\" trans>Heading 2</div>\r\n                    <div class=\"alt-text\">Ctrl+Alt+2</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('FormatBlock', 'h3')\">\r\n                    <div class=\"text\" trans>Heading 3</div>\r\n                    <div class=\"alt-text\">Ctrl+Alt+3</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('strikethrough')\">\r\n                    <div class=\"text\" trans>Strikethrough</div>\r\n                    <div class=\"alt-text\">Alt+Shift+5</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('superscript')\">\r\n                    <div class=\"text\" trans>Superscript</div>\r\n                    <div class=\"alt-text\">Ctrl+.</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('subscript')\">\r\n                    <div class=\"text\" trans>Subscript</div>\r\n                    <div class=\"alt-text\">Ctrl+,</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('mceBlockQuote')\">\r\n                    <div class=\"text\" trans>Blockquote</div>\r\n                    <div class=\"alt-text\">Ctrl+Alt+B</div>\r\n                </div>\r\n                <div mat-menu-item (click)=\"execCommand('FormatBlock', 'p')\">\r\n                    <div class=\"text\" trans>Paragraph</div>\r\n                    <div class=\"alt-text\">Ctrl+Alt+0</div>\r\n                </div>\r\n            </mat-menu>\r\n        </div>\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" [matMenuTriggerFor]=\"colorMenu\" class=\"no-style editor-button text-button color-button\" #colorPickerOrigin>\r\n                <span trans>Color</span>\r\n                <mat-icon svgIcon=\"arrow-drop-down\" class=\"caret\"></mat-icon>\r\n            </button>\r\n            <mat-menu #colorMenu class=\"color-dropdown\">\r\n                <div mat-menu-item class=\"text-color-item\" (click)=\"showColorPicker('ForeColor', colorPickerOrigin)\">\r\n                    <mat-icon svgIcon=\"format-color-text\"></mat-icon>\r\n                    <span trans>Text Color</span>\r\n                </div>\r\n                <div mat-menu-item class=\"bg-color-item\" (click)=\"showColorPicker('HiliteColor', colorPickerOrigin)\">\r\n                    <mat-icon svgIcon=\"format-color-fill\"></mat-icon>\r\n                    <span trans>Background Color</span>\r\n                </div>\r\n            </mat-menu>\r\n        </div>\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('justifyLeft')\"\r\n                    [class.active]=\"queryCommandState('justifyLeft')\" [matTooltip]=\"'Align Left' | trans\">\r\n                <mat-icon svgIcon=\"format-align-left\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('justifyCenter')\"\r\n                    [class.active]=\"queryCommandState('justifyCenter')\" [matTooltip]=\"'Center' | trans\">\r\n                <mat-icon svgIcon=\"format-align-center\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('justifyRight')\"\r\n                    [class.active]=\"queryCommandState('justifyRight')\" [matTooltip]=\"'Align Right' | trans\">\r\n                <mat-icon svgIcon=\"format-align-right\"></mat-icon>\r\n            </button>\r\n        </div>\r\n        <div class=\"header-actions\">\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('Outdent')\" [matTooltip]=\"'Decrease Indent' | trans\">\r\n                <mat-icon svgIcon=\"format-indent-decrease\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button\" (click)=\"execCommand('Indent')\" [matTooltip]=\"'Increase Indent' | trans\">\r\n                <mat-icon svgIcon=\"format-indent-increase\"></mat-icon>\r\n            </button>\r\n        </div>\r\n        <div class=\"header-actions editor-toggle-buttons\">\r\n            <button type=\"button\" class=\"no-style editor-button visual-mode-button\"\r\n                    [class.active]=\"activeEditor === 'visual'\" (click)=\"showVisualEditor()\" trans>Visual\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button source-mode-button\"\r\n                    [class.active]=\"activeEditor === 'source'\" (click)=\"showSourceEditor()\" trans>Source\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<textarea class=\"source-textarea\" #sourceArea rows=\"8\" [style.min-height]=\"minHeight\" style=\"display: none\" [formControl]=\"sourceAreaControl\" (blur)=\"setContents(sourceAreaControl.value)\"></textarea>\r\n<textarea class=\"visual-textarea\" #visualArea rows=\"8\" [style.min-height]=\"minHeight\"></textarea>\r\n\r\n<ng-content select=\"[footer]\"></ng-content>\r\n","import {\r\n    AfterViewInit,\r\n    ChangeDetectionStrategy,\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    OnDestroy,\r\n    Output,\r\n    Renderer2,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport {TinymceTextEditor} from './editors/tinymce-text-editor.service';\r\nimport {Settings} from '../core/config/settings.service';\r\nimport {OverlayPanel} from '../core/ui/overlay-panel/overlay-panel.service';\r\nimport {openUploadWindow} from '../uploads/utils/open-upload-window';\r\nimport {UploadQueueService} from '../uploads/upload-queue/upload-queue.service';\r\nimport {TextEditorImageValidator} from './validation/text-editor-image-validator';\r\nimport {UploadInputTypes} from '../uploads/upload-input-config';\r\nimport {CurrentUser} from '../auth/current-user';\r\nimport {BOTTOM_POSITION} from '../core/ui/overlay-panel/positions/bottom-position';\r\nimport {ucFirst} from '../core/utils/uc-first';\r\nimport {FormControl} from '@angular/forms';\r\nimport {debounceTime} from 'rxjs/operators';\r\nimport {UploadUri} from '@common/uploads/types/upload-uri.enum';\r\nimport {UploadApiConfig} from '@common/uploads/types/upload-api-config';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\n\r\nexport interface LinkAttrs {\r\n    text: string;\r\n    href: string;\r\n    target?: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'text-editor',\r\n    templateUrl: './text-editor.component.html',\r\n    styleUrls: ['./text-editor.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n    providers: [\r\n        UploadQueueService,\r\n    ]\r\n})\r\nexport class TextEditorComponent implements OnDestroy, AfterViewInit {\r\n    @ViewChild('visualArea', { static: true }) visualTextArea: ElementRef;\r\n    @ViewChild('sourceArea', { static: true }) sourceTextArea: ElementRef;\r\n\r\n    public sourceAreaControl = new FormControl();\r\n    public activeEditor = 'visual';\r\n\r\n    @Input() showAdvancedControls = false;\r\n    @Input() basic = false;\r\n    @Input() minHeight: number|string = 183;\r\n    @Input() maxHeight = 530;\r\n    @Input() inlineUploadPrefix: string;\r\n\r\n    @Output() onChange: EventEmitter<string> = new EventEmitter();\r\n    @Output() onCtrlEnter = new EventEmitter();\r\n    @Output() onFileUpload = new EventEmitter<UploadedFile[]>();\r\n\r\n    constructor(\r\n        public editor: TinymceTextEditor,\r\n        public currentUser: CurrentUser,\r\n        private uploadQueue: UploadQueueService,\r\n        private settings: Settings,\r\n        private renderer: Renderer2,\r\n        public el: ElementRef,\r\n        private overlayPanel: OverlayPanel,\r\n        private imageValidator: TextEditorImageValidator,\r\n    ) {}\r\n\r\n    ngAfterViewInit() {\r\n        this.bootTextEditor();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.destroyEditor();\r\n    }\r\n\r\n    public reset() {\r\n        this.editor.reset();\r\n    }\r\n\r\n    public focus() {\r\n        this.editor.focus();\r\n    }\r\n\r\n    public hasUndo(): boolean {\r\n        return this.editor.hasUndo();\r\n    }\r\n\r\n    public hasRedo(): boolean {\r\n        return this.editor.hasRedo();\r\n    }\r\n\r\n    /**\r\n     * Queries the current state for specified text editor command.\r\n     * For example if the current selection is \"bold\".\r\n     */\r\n    public queryCommandState(name: string): boolean|number {\r\n        return this.editor.queryCommandState(name);\r\n    }\r\n\r\n    public execCommand(name: string, value: string|number = null) {\r\n        this.editor.execCommand(name, value);\r\n    }\r\n\r\n    /**\r\n     * Insert information container of specified type into the editor.\r\n     */\r\n    public insertInfoContainer(type: string) {\r\n        // TODO: refactor into shortcodes maybe if need more of similar buttons in the future\r\n        // TODO: translate once angular translation service is available\r\n        this.insertContents(\r\n            `<div class=\"widget widget-${type}\"><div class=\"title\">${ucFirst(type)}:</div><br></div><br>`\r\n        );\r\n    }\r\n\r\n    public async showColorPicker(command: string, origin: HTMLElement) {\r\n        const { BeColorPickerModule } = await import('@common/core/ui/color-picker/be-color-picker.module');\r\n        this.overlayPanel.open(BeColorPickerModule.components.panel, {origin: new ElementRef(origin), position: BOTTOM_POSITION})\r\n            .valueChanged().pipe(debounceTime(50)).subscribe(color => {\r\n                this.execCommand(command, color);\r\n            });\r\n    }\r\n\r\n    public showVisualEditor() {\r\n        if ( ! this.editor.tinymceInstance.contentAreaContainer || this.activeEditor === 'visual') return;\r\n\r\n        this.activeEditor = 'visual';\r\n\r\n        this.renderer.setStyle(this.editor.tinymceInstance.contentAreaContainer, 'display', 'block');\r\n        this.renderer.setStyle(this.sourceTextArea.nativeElement, 'display', 'none');\r\n\r\n        this.editor.focus();\r\n    }\r\n\r\n    public showSourceEditor() {\r\n        if ( ! this.editor.tinymceInstance.contentAreaContainer || this.activeEditor === 'source') return;\r\n\r\n        this.activeEditor = 'source';\r\n\r\n        this.renderer.setStyle(this.sourceTextArea.nativeElement, 'height', this.editor.tinymceInstance.contentAreaContainer.offsetHeight + 'px');\r\n        this.renderer.setStyle(this.sourceTextArea.nativeElement, 'display', 'block');\r\n        this.renderer.setStyle(this.editor.tinymceInstance.contentAreaContainer, 'display', 'none');\r\n\r\n        this.sourceAreaControl.setValue(this.editor.getContents({source_view: true}));\r\n    }\r\n\r\n    public openFileUploadDialog() {\r\n        openUploadWindow({multiple: true}).then(fileList => {\r\n            this.onFileUpload.emit(fileList);\r\n        });\r\n    }\r\n\r\n    public openInsertImageModal() {\r\n        const params: UploadApiConfig = {\r\n            uri: UploadUri.Image,\r\n            validator: this.imageValidator,\r\n            httpParams: {diskPrefix: this.inlineUploadPrefix}\r\n        };\r\n        openUploadWindow({types: [UploadInputTypes.image]}).then(files => {\r\n            this.uploadQueue.start(files, params).subscribe(response => {\r\n                this.insertImage(this.settings.getBaseUrl(true) + response.fileEntry.url);\r\n            });\r\n        });\r\n    }\r\n\r\n    public getContents(): string {\r\n        return this.editor.getContents();\r\n    }\r\n\r\n    public setContents(contents: string) {\r\n        this.editor.setContents(contents);\r\n    }\r\n\r\n    public insertContents(contents) {\r\n        this.editor.insertContents(contents);\r\n    }\r\n\r\n    public insertImage(url: string) {\r\n        this.editor.insertImage(url);\r\n    }\r\n\r\n    public insertLink(attrs: LinkAttrs) {\r\n        const target = attrs.target || 'self';\r\n        this.insertContents(`<a href=\"${attrs.href}\" target=\"${target}\">${attrs.text}</a>`);\r\n    }\r\n\r\n    public destroyEditor() {\r\n        this.editor.destroyEditor();\r\n    }\r\n\r\n    private bootTextEditor() {\r\n        this.editor.setConfig({\r\n            textAreaEl: this.visualTextArea,\r\n            editorEl: this.el,\r\n            minHeight: this.minHeight,\r\n            maxHeight: this.maxHeight,\r\n            onChange: this.onChange,\r\n            onCtrlEnter: this.onCtrlEnter,\r\n            showAdvancedControls: this.showAdvancedControls,\r\n        });\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar UnsubscriptionErrorImpl = (function () {\n    function UnsubscriptionErrorImpl(errors) {\n        Error.call(this);\n        this.message = errors ?\n            errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ') : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n        return this;\n    }\n    UnsubscriptionErrorImpl.prototype = Object.create(Error.prototype);\n    return UnsubscriptionErrorImpl;\n})();\nexports.UnsubscriptionError = UnsubscriptionErrorImpl;\n//# sourceMappingURL=UnsubscriptionError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar Subscription_1 = require(\"../Subscription\");\nvar iterator_1 = require(\"../symbol/iterator\");\nfunction scheduleIterable(input, scheduler) {\n    if (!input) {\n        throw new Error('Iterable cannot be null');\n    }\n    return new Observable_1.Observable(function (subscriber) {\n        var sub = new Subscription_1.Subscription();\n        var iterator;\n        sub.add(function () {\n            if (iterator && typeof iterator.return === 'function') {\n                iterator.return();\n            }\n        });\n        sub.add(scheduler.schedule(function () {\n            iterator = input[iterator_1.iterator]();\n            sub.add(scheduler.schedule(function () {\n                if (subscriber.closed) {\n                    return;\n                }\n                var value;\n                var done;\n                try {\n                    var result = iterator.next();\n                    value = result.value;\n                    done = result.done;\n                }\n                catch (err) {\n                    subscriber.error(err);\n                    return;\n                }\n                if (done) {\n                    subscriber.complete();\n                }\n                else {\n                    subscriber.next(value);\n                    this.schedule();\n                }\n            }));\n        }));\n        return sub;\n    });\n}\nexports.scheduleIterable = scheduleIterable;\n//# sourceMappingURL=scheduleIterable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction hostReportError(err) {\n    setTimeout(function () { throw err; }, 0);\n}\nexports.hostReportError = hostReportError;\n//# sourceMappingURL=hostReportError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subscribeToArray = function (array) { return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n        subscriber.next(array[i]);\n    }\n    subscriber.complete();\n}; };\n//# sourceMappingURL=subscribeToArray.js.map","import {Component, Input, OnInit, Output, EventEmitter, ViewEncapsulation, ViewChild, ElementRef} from '@angular/core';\r\nimport {FormControl} from '@angular/forms';\r\nimport {Conversation} from '../../../conversation/conversation.service';\r\nimport {CannedRepliesService} from '../canned-replies.service';\r\nimport {CannedReply} from '../../../shared/models/CannedReply';\r\nimport {CrupdateCannedReplyModalComponent} from '../crupdate-canned-reply-modal/crupdate-canned-reply-modal.component';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {catchError, debounceTime, distinctUntilChanged, switchMap, tap} from 'rxjs/operators';\r\nimport { MatMenuTrigger } from '@angular/material/menu';\r\nimport {Modal} from '@common/core/ui/dialogs/modal.service';\r\nimport * as Dot from 'dot-object';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {of} from 'rxjs';\r\nimport {EMPTY_PAGINATION_RESPONSE} from '@common/core/types/pagination/pagination-response';\r\n\r\n@Component({\r\n    selector: 'canned-replies-dropdown',\r\n    templateUrl: './canned-replies-dropdown.component.html',\r\n    styleUrls: ['./canned-replies-dropdown.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class CannedRepliesDropdownComponent implements OnInit {\r\n    @ViewChild(MatMenuTrigger, { static: true }) trigger: MatMenuTrigger;\r\n    @ViewChild('input', { static: true }) input: ElementRef;\r\n\r\n    @Input() searchQuery = new FormControl();\r\n    @Output() onReplySelect = new EventEmitter();\r\n\r\n    public loadedResultsAtLeastOnce = false;\r\n    public cannedReplies: CannedReply[] = [];\r\n\r\n    constructor(\r\n        private cannedRepliesService: CannedRepliesService,\r\n        private currentUser: CurrentUser,\r\n        private modal: Modal,\r\n        private conversation: Conversation,\r\n        private toast: Toast,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.searchQuery.valueChanges\r\n            .pipe(\r\n                debounceTime(250),\r\n                distinctUntilChanged(),\r\n                switchMap(query => this.getCannedReplies(query)),\r\n                catchError(() => of(EMPTY_PAGINATION_RESPONSE)),\r\n            ).subscribe();\r\n\r\n        this.trigger.menuOpened\r\n            .subscribe(() => {\r\n                if ( ! this.loadedResultsAtLeastOnce) {\r\n                    this.getCannedReplies(null, true).subscribe();\r\n                }\r\n            });\r\n    }\r\n\r\n    public selectCannedReply(cannedReply: CannedReply) {\r\n        // replace placeholders\r\n        const body = cannedReply.body.replace(/{{([\\w.\\-]+?)}}/, (fullMatch, groupMatch) => {\r\n            const replacement = Dot.pick(groupMatch.toLowerCase(), {ticket: this.conversation.get()});\r\n            return replacement || fullMatch;\r\n        });\r\n        this.onReplySelect.emit({...cannedReply, body});\r\n    }\r\n\r\n    public showNewCannedReplyModal() {\r\n        const cannedReply =  new CannedReply({\r\n            body: this.conversation.draft.get().body,\r\n            uploads: this.conversation.draft.get().uploads,\r\n        });\r\n        this.modal.open(\r\n            CrupdateCannedReplyModalComponent,\r\n            {cannedReply},\r\n            {panelClass: 'crupdate-canned-reply-modal-container'}\r\n        ).afterClosed().subscribe(newReply => {\r\n            if ( ! newReply) return;\r\n            this.toast.open('Canned reply created.');\r\n            this.cannedReplies.unshift(newReply);\r\n        });\r\n    }\r\n\r\n    public getCannedReplies(query: string, force?: boolean) {\r\n        if ( ! query && ! force) return of(EMPTY_PAGINATION_RESPONSE);\r\n        const payload = {query, user_id: this.currentUser.get('id'), per_page: 20, shared: true};\r\n        return this.cannedRepliesService.getReplies(payload)\r\n            .pipe(tap(response => {\r\n                this.loadedResultsAtLeastOnce = true;\r\n                this.cannedReplies = response.pagination.data;\r\n            }));\r\n    }\r\n}\r\n","<button class=\"no-style editor-button\" mat-icon-button [matMenuTriggerFor]=\"cannedReplyMenu\">\r\n    <mat-icon svgIcon=\"comment\" class=\"dropdown-icon\"></mat-icon>\r\n</button>\r\n\r\n<mat-menu #cannedReplyMenu=\"matMenu\" [overlapTrigger]=\"false\" class=\"canned-reply-menu\">\r\n    <div class=\"input-container\" (click)=\"$event.stopPropagation()\">\r\n        <input type=\"text\" [formControl]=\"searchQuery\" mat-menu-item class=\"canned-reply-search-input\" #input>\r\n    </div>\r\n\r\n    <button class=\"new-canned-reply\" mat-menu-item (click)=\"showNewCannedReplyModal()\" *ngIf=\"!searchQuery.value\" trans>\r\n        <strong trans>Create new canned reply</strong>\r\n    </button>\r\n\r\n    <button class=\"canned-reply\" mat-menu-item *ngFor=\"let cannedReply of cannedReplies\" (click)=\"selectCannedReply(cannedReply)\">\r\n        {{cannedReply.name}}\r\n    </button>\r\n\r\n    <div class=\"no-results\" *ngIf=\"!cannedReplies.length && loadedResultsAtLeastOnce && searchQuery.value\" (click)=\"$event.stopPropagation()\">\r\n        <div><span trans>No results found for</span> <strong>{{ searchQuery.value }}</strong></div>\r\n    </div>\r\n</mat-menu>\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar canReportError_1 = require(\"./util/canReportError\");\nvar toSubscriber_1 = require(\"./util/toSubscriber\");\nvar observable_1 = require(\"./symbol/observable\");\nvar pipe_1 = require(\"./util/pipe\");\nvar config_1 = require(\"./config\");\nvar Observable = (function () {\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber_1.toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            sink.add(operator.call(sink, this.source));\n        }\n        else {\n            sink.add(this.source || (config_1.config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?\n                this._subscribe(sink) :\n                this._trySubscribe(sink));\n        }\n        if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n            if (sink.syncErrorThrowable) {\n                sink.syncErrorThrowable = false;\n                if (sink.syncErrorThrown) {\n                    throw sink.syncErrorValue;\n                }\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                sink.syncErrorThrown = true;\n                sink.syncErrorValue = err;\n            }\n            if (canReportError_1.canReportError(sink)) {\n                sink.error(err);\n            }\n            else {\n                console.warn(err);\n            }\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                try {\n                    next(value);\n                }\n                catch (err) {\n                    reject(err);\n                    if (subscription) {\n                        subscription.unsubscribe();\n                    }\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        return source && source.subscribe(subscriber);\n    };\n    Observable.prototype[observable_1.observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        if (operations.length === 0) {\n            return this;\n        }\n        return pipe_1.pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexports.Observable = Observable;\nfunction getPromiseCtor(promiseCtor) {\n    if (!promiseCtor) {\n        promiseCtor = config_1.config.Promise || Promise;\n    }\n    if (!promiseCtor) {\n        throw new Error('no Promise impl found');\n    }\n    return promiseCtor;\n}\n//# sourceMappingURL=Observable.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscribeToResult_1 = require(\"../util/subscribeToResult\");\nvar OuterSubscriber_1 = require(\"../OuterSubscriber\");\nvar InnerSubscriber_1 = require(\"../InnerSubscriber\");\nvar map_1 = require(\"./map\");\nvar from_1 = require(\"../observable/from\");\nfunction mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Number.POSITIVE_INFINITY; }\n    if (typeof resultSelector === 'function') {\n        return function (source) { return source.pipe(mergeMap(function (a, i) { return from_1.from(project(a, i)).pipe(map_1.map(function (b, ii) { return resultSelector(a, b, i, ii); })); }, concurrent)); };\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return function (source) { return source.lift(new MergeMapOperator(project, concurrent)); };\n}\nexports.mergeMap = mergeMap;\nvar MergeMapOperator = (function () {\n    function MergeMapOperator(project, concurrent) {\n        if (concurrent === void 0) { concurrent = Number.POSITIVE_INFINITY; }\n        this.project = project;\n        this.concurrent = concurrent;\n    }\n    MergeMapOperator.prototype.call = function (observer, source) {\n        return source.subscribe(new MergeMapSubscriber(observer, this.project, this.concurrent));\n    };\n    return MergeMapOperator;\n}());\nexports.MergeMapOperator = MergeMapOperator;\nvar MergeMapSubscriber = (function (_super) {\n    __extends(MergeMapSubscriber, _super);\n    function MergeMapSubscriber(destination, project, concurrent) {\n        if (concurrent === void 0) { concurrent = Number.POSITIVE_INFINITY; }\n        var _this = _super.call(this, destination) || this;\n        _this.project = project;\n        _this.concurrent = concurrent;\n        _this.hasCompleted = false;\n        _this.buffer = [];\n        _this.active = 0;\n        _this.index = 0;\n        return _this;\n    }\n    MergeMapSubscriber.prototype._next = function (value) {\n        if (this.active < this.concurrent) {\n            this._tryNext(value);\n        }\n        else {\n            this.buffer.push(value);\n        }\n    };\n    MergeMapSubscriber.prototype._tryNext = function (value) {\n        var result;\n        var index = this.index++;\n        try {\n            result = this.project(value, index);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.active++;\n        this._innerSub(result, value, index);\n    };\n    MergeMapSubscriber.prototype._innerSub = function (ish, value, index) {\n        var innerSubscriber = new InnerSubscriber_1.InnerSubscriber(this, value, index);\n        var destination = this.destination;\n        destination.add(innerSubscriber);\n        var innerSubscription = subscribeToResult_1.subscribeToResult(this, ish, undefined, undefined, innerSubscriber);\n        if (innerSubscription !== innerSubscriber) {\n            destination.add(innerSubscription);\n        }\n    };\n    MergeMapSubscriber.prototype._complete = function () {\n        this.hasCompleted = true;\n        if (this.active === 0 && this.buffer.length === 0) {\n            this.destination.complete();\n        }\n        this.unsubscribe();\n    };\n    MergeMapSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    MergeMapSubscriber.prototype.notifyComplete = function (innerSub) {\n        var buffer = this.buffer;\n        this.remove(innerSub);\n        this.active--;\n        if (buffer.length > 0) {\n            this._next(buffer.shift());\n        }\n        else if (this.active === 0 && this.hasCompleted) {\n            this.destination.complete();\n        }\n    };\n    return MergeMapSubscriber;\n}(OuterSubscriber_1.OuterSubscriber));\nexports.MergeMapSubscriber = MergeMapSubscriber;\n//# sourceMappingURL=mergeMap.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexports.getSymbolIterator = getSymbolIterator;\nexports.iterator = getSymbolIterator();\nexports.$$iterator = exports.iterator;\n//# sourceMappingURL=iterator.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"./Subscriber\");\nvar InnerSubscriber = (function (_super) {\n    __extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber_1.Subscriber));\nexports.InnerSubscriber = InnerSubscriber;\n//# sourceMappingURL=InnerSubscriber.js.map","import {Injectable} from '@angular/core';\r\nimport {CannedReply} from '../../shared/models/CannedReply';\r\nimport {AppHttpClient} from '@common/core/http/app-http-client.service';\r\nimport {BackendResponse} from '@common/core/types/backend-response';\r\nimport {PaginatedBackendResponse} from '@common/core/types/pagination/paginated-backend-response';\r\n\r\ninterface RepliesIndexParams {\r\n    query?: string;\r\n    per_page?: number;\r\n    user_id?: number;\r\n    shared?: boolean;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class CannedRepliesService {\r\n    constructor(private httpClient: AppHttpClient) {}\r\n\r\n    public getReplies(params: RepliesIndexParams): PaginatedBackendResponse<CannedReply> {\r\n        return this.httpClient.get('canned-replies', params);\r\n    }\r\n\r\n    public create(params): BackendResponse<CannedReply> {\r\n        return this.httpClient.post('canned-replies', params);\r\n    }\r\n\r\n    public update(id: number, params): BackendResponse<CannedReply> {\r\n        return this.httpClient.put('canned-replies/' + id, params);\r\n    }\r\n\r\n    public delete(ids: number[]): BackendResponse<void> {\r\n        return this.httpClient.delete('canned-replies', {ids});\r\n    }\r\n}\r\n","import { EventEmitter, HostBinding, Inject, Directive } from '@angular/core';\r\nimport { CURRENT_PREVIEW_FILE } from './current-preview-file';\r\nimport { FileEntry } from '../uploads/types/file-entry';\r\nimport { PREVIEW_URL_TRANSFORMER, PreviewUrlTransformer } from './preview-url-transformer';\r\nimport { Settings } from '../core/config/settings.service';\r\nimport { Observable } from 'rxjs';\r\nimport { AppHttpClient } from '../core/http/app-http-client.service';\r\nimport { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';\r\nimport { CurrentUser } from '../auth/current-user';\r\n\r\n@Directive()\nexport abstract class BaseFilePreview {\r\n    @HostBinding('class.file-preview-wrapper') filePreviewWrapper = true;\r\n    public download = new EventEmitter();\r\n\r\n    constructor(\r\n        @Inject(CURRENT_PREVIEW_FILE) protected file: FileEntry,\r\n        @Inject(PREVIEW_URL_TRANSFORMER) protected transformer: PreviewUrlTransformer,\r\n        protected settings: Settings,\r\n        protected http: AppHttpClient,\r\n        protected sanitizer: DomSanitizer,\r\n        protected currentUser: CurrentUser,\r\n    ) {}\r\n\r\n    public getSrc(): string {\r\n        return this.transformer(this.file);\r\n    }\r\n\r\n    public getSafeSrc(): SafeResourceUrl {\r\n        return this.sanitizer.bypassSecurityTrustResourceUrl(this.getSrc());\r\n    }\r\n\r\n    public getContents(): Observable<string> {\r\n        return this.http.get(this.getSrc(), null, {responseType: 'text'});\r\n    }\r\n}\r\n","import {BehaviorSubject, combineLatest, merge, Observable} from 'rxjs';\r\nimport {debounceTime, distinctUntilChanged, filter, map, take} from 'rxjs/operators';\r\nimport {FormControl, FormGroup} from '@angular/forms';\r\nimport {PageEvent} from '@angular/material/paginator';\r\nimport {Sort} from '@angular/material/sort';\r\nimport {DataSource, SelectionModel} from '@angular/cdk/collections';\r\nimport {DataTableSourceConfig} from '@common/shared/data-table/data/data-table-source-config';\r\nimport {arrayToObject} from '@common/core/utils/array-to-object';\r\nimport {DataTableFilter} from '@common/shared/data-table/filter-panel/data-table-filters';\r\nimport {PaginationResponse} from '@common/core/types/pagination/pagination-response';\r\nimport {PaginationParams} from '@common/core/types/pagination/pagination-params';\r\n\r\nexport class PaginatedDataTableSource<T> implements DataSource<T> {\r\n    public initiated = false;\r\n    private pagination$ = new BehaviorSubject<PaginationResponse<T>>(null);\r\n    private userParamsChange$ = new BehaviorSubject<object>({});\r\n    public selectedRows = new SelectionModel<T>(true, []);\r\n    public searchControl = new FormControl();\r\n    public filterForm = new FormGroup({});\r\n    public nextPageLoader$ = new BehaviorSubject<{page: number}>(null);\r\n    public virtualSort$ = new BehaviorSubject<Partial<Sort>>({});\r\n    public paginationParams: PaginationParams = {};\r\n    public activeFilters$: Observable<DataTableFilter[]> = this.filterForm.valueChanges.pipe(map((value: object) => {\r\n        return Object.entries(value)\r\n            // remove non active filters\r\n            .filter(entry => entry[1] != null)\r\n            // map filter column to display name\r\n            .map(entry => this.config.filters.find(f => f.column === entry[0]));\r\n    }));\r\n\r\n    public get paginatedOnce$(): Observable<boolean> {\r\n        return this.config.dataPaginator.paginatedOnce$.pipe(filter(val => !!val), take(1));\r\n    }\r\n\r\n    public get noResults$() {\r\n        // check if paginated at least once or if\r\n        // data has been set via \"setData\" method\r\n        return combineLatest([\r\n            this.config.dataPaginator.noResults$,\r\n            this.pagination$,\r\n        ]).pipe(map(([noResults, paginationResponse]) => {\r\n            return noResults && (paginationResponse && !paginationResponse.data.length);\r\n        }));\r\n    }\r\n\r\n    public get loading$() {\r\n        return this.config.dataPaginator.loading$;\r\n    }\r\n\r\n    public get totalCount$(): Observable<number|null> {\r\n        return this.pagination$.pipe(map(p => p ? p.total : null));\r\n    }\r\n\r\n    constructor(public config: DataTableSourceConfig<T>) {\r\n        if (this.config.filters) {\r\n            this.config.filters.forEach(f => {\r\n                const control = new FormControl(f.defaultValue || null);\r\n                this.filterForm.addControl(f.column, control);\r\n            });\r\n            this.applyFiltersFromQueryParams();\r\n        }\r\n        if (config.dataPaginator && config.dontUpdateQueryParams) {\r\n            config.dataPaginator.dontUpdateQueryParams = true;\r\n        }\r\n    }\r\n\r\n    public anyRowsSelected() {\r\n        return this.selectedRows.hasValue();\r\n    }\r\n\r\n    public allRowsSelected(): boolean {\r\n        return this.selectedRows.selected.length &&\r\n            this.selectedRows.selected.length === this.pagination$.value.data.length;\r\n    }\r\n\r\n    public toggleAllRows() {\r\n        this.allRowsSelected() ?\r\n            this.deselectAllItems() :\r\n            this.pagination$.value.data.forEach(row => this.selectedRows.select(row));\r\n    }\r\n\r\n    public deselectAllItems() {\r\n        this.selectedRows.clear();\r\n    }\r\n\r\n    public getSelectedItems(): number[] {\r\n        return this.selectedRows.selected.map(item => item['id']);\r\n    }\r\n\r\n    public setSelectedItems(items: T[]) {\r\n        this.deselectAllItems();\r\n        this.selectedRows.select(...items);\r\n    }\r\n\r\n    public setData(data: T[]) {\r\n        this.pagination$.next({...this.pagination$.value, data});\r\n    }\r\n\r\n    public getData(): T[] {\r\n        return this.pagination$.value ? this.pagination$.value.data : [];\r\n    }\r\n    \r\n    public removeFilter(column: string) {\r\n        this.filterForm.get(column).setValue(null);\r\n    }\r\n\r\n    public updateConfig(config: DataTableSourceConfig<T>) {\r\n        this.config = {...this.config, ...config};\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Merge specified params with current\r\n     * pagination params and reload data.\r\n     */\r\n    public reload(params: object = {}) {\r\n        this.userParamsChange$.next(params);\r\n        if ( ! this.initiated) {\r\n            this.init();\r\n        }\r\n    }\r\n    \r\n    public canLoadNextPage() {\r\n        return this.pagination$.value &&\r\n            this.getCurrentPage() < this.pagination$.value.last_page;\r\n    }\r\n\r\n    public loadNextPage() {\r\n        this.nextPageLoader$.next({page: this.getCurrentPage() + 1});\r\n    }\r\n\r\n    /**\r\n     * Reset current pagination params to initial\r\n     * state and reload data using specified params\r\n     */\r\n    public reset(params?: object) {\r\n        this.searchControl.reset();\r\n        this.resetSort();\r\n        this.resetMatPaginator();\r\n        this.deselectAllItems();\r\n        this.reload(params);\r\n    }\r\n\r\n    public init(config?: DataTableSourceConfig<T>) {\r\n        if (this.initiated) return this;\r\n        if (config) this.updateConfig(config);\r\n        const sortChange = this.config.matSort ?\r\n            merge(this.config.matSort.sortChange, this.config.matSort.initialized) :\r\n            this.virtualSort$;\r\n        const pageChange = this.config.matPaginator ?\r\n            merge(this.config.matPaginator.page, this.config.matPaginator.initialized) :\r\n            this.nextPageLoader$;\r\n        const searchChange = this.searchControl.valueChanges.pipe(\r\n            debounceTime(400),\r\n            distinctUntilChanged(),\r\n            map(query => {\r\n                return {query};\r\n            })\r\n        );\r\n        const filterChange = this.filterForm.valueChanges.pipe(map((value: object) => {\r\n            // remove \"undefined\" values from filters object\r\n            Object.keys(value).forEach(key => {\r\n                if (value[key] == null) {\r\n                    delete value[key];\r\n                // return only ID if whole model is bound to form\r\n                } else if (value[key].id) {\r\n                    value[key] = value[key].id;\r\n                }\r\n            });\r\n            return value;\r\n        }));\r\n\r\n        combineLatest([sortChange, pageChange, searchChange, filterChange, this.userParamsChange$])\r\n            .pipe(\r\n                // prevent double trigger when resetting all filters at the same time\r\n                debounceTime(0),\r\n                map(params => this.transformParams(params as any)),\r\n            )\r\n            .subscribe(params => {\r\n                this.config.dataPaginator.paginate(params, this.config.uri, this.config.initialData);\r\n            });\r\n\r\n        this.config.dataPaginator.pagination$.subscribe(pagination => {\r\n            // material paginator current page is zero-based while laravel starts from one\r\n            if (this.config.matPaginator) {\r\n                this.config.matPaginator.pageIndex = pagination.current_page - 1;\r\n                this.config.matPaginator.pageSize = pagination.per_page;\r\n                this.config.matPaginator.length = pagination.data.length ? pagination.total : 0;\r\n            }\r\n\r\n            // append data instead of overriding with next page data (infinite scroll).\r\n            // if page did not change, we can assume that it was filter or sort\r\n            // change and we should use only new data, even on infinite scroll\r\n            if (this.config.appendData && pagination.current_page !== this.getCurrentPage()) {\r\n                const currentData = this.pagination$.value ? this.pagination$.value.data : [];\r\n                pagination = {...pagination, data: [...currentData, ...pagination.data]};\r\n            }\r\n\r\n            this.pagination$.next(pagination);\r\n        });\r\n\r\n        // angular does not fire \"valueChanges\" on form control if default\r\n        // value is not provided, so need to trigger it manually here otherwise\r\n        // changes pipeline will not fire until search control value changes\r\n        // # https://github.com/angular/angular/issues/14542\r\n        this.searchControl.setValue(null);\r\n        this.filterForm.patchValue({});\r\n\r\n        this.initiated = true;\r\n        return this;\r\n    }\r\n\r\n    public getCurrentPage(): number {\r\n        return this.pagination$.value ? this.pagination$.value.current_page : undefined;\r\n    }\r\n\r\n    private transformParams(originalParams: (PageEvent & Sort)[]) {\r\n        const params = arrayToObject(originalParams);\r\n\r\n        // have mat paginator\r\n        if (this.config.matPaginator) {\r\n            // pageIndex can be 0, need to check for undefined or null only\r\n            params.page = params.pageIndex != null ? params.pageIndex + 1 : undefined;\r\n            params.per_page = params.pageSize;\r\n        }\r\n\r\n        params.orderBy = params.active;\r\n        params.orderDir = params.direction;\r\n\r\n        // remove \"undefined\" and renamed values from object\r\n        const keysToRemove = ['pageIndex', 'pageSize', 'active', 'direction', 'previousPageIndex', 'length'];\r\n        Object.keys(params)\r\n            .forEach(key => {\r\n                if (keysToRemove.indexOf(key) > -1 || params[key] == null) {\r\n                    delete params[key];\r\n                }\r\n            });\r\n\r\n        // merge static params specified by users, they will\r\n        // not change and should be sent with every request\r\n        this.paginationParams = {...this.config.staticParams, ...params};\r\n        return this.paginationParams;\r\n    }\r\n\r\n    private resetSort() {\r\n        if ( ! this.config.matSort) return;\r\n        this.config.matSort.sort({\r\n            id: null,\r\n            start: null,\r\n            disableClear: false\r\n        });\r\n    }\r\n\r\n    private resetMatPaginator() {\r\n        if ( ! this.config.matPaginator) return;\r\n        this.config.matPaginator.length = 0;\r\n        this.config.matPaginator._changePageSize(15);\r\n        this.config.matPaginator.firstPage();\r\n    }\r\n\r\n    public connect(): Observable<T[]> {\r\n        return this.pagination$.pipe(\r\n            filter(p => !!p), // skip first \"null\" on behaviour subject\r\n            map(p => p ? p.data : [])\r\n        );\r\n    }\r\n\r\n    public disconnect() {\r\n        this.config.dataPaginator.destroy();\r\n        this.pagination$.complete();\r\n    }\r\n\r\n    private applyFiltersFromQueryParams() {\r\n        const queryParams = this.config.dataPaginator.currentQueryParams();\r\n        const queryValues = {};\r\n        Object.keys(this.filterForm.controls).forEach(filterName => {\r\n            let queryValue = queryParams[filterName];\r\n            if (queryValue) {\r\n                if (queryValue === 'false') {\r\n                    queryValue = false;\r\n                } else if (queryValue === 'true') {\r\n                    queryValue = true;\r\n                }\r\n                queryValues[filterName] = queryValue;\r\n            }\r\n        });\r\n        if (Object.keys(queryValues).length) {\r\n            setTimeout(() => {\r\n                this.filterForm.patchValue(queryValues);\r\n            });\r\n        }\r\n    }\r\n}\r\n","export function arrayToObject(array: object[]): {[key: string]: any} {\r\n    return array.reduce((previous, current) => {\r\n        return {...previous, ...current};\r\n    });\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nvar rxSubscriber_1 = require(\"../symbol/rxSubscriber\");\nvar Observer_1 = require(\"../Observer\");\nfunction toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber_1.Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriber_1.rxSubscriber]) {\n            return nextOrObserver[rxSubscriber_1.rxSubscriber]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber_1.Subscriber(Observer_1.empty);\n    }\n    return new Subscriber_1.Subscriber(nextOrObserver, error, complete);\n}\nexports.toSubscriber = toSubscriber;\n//# sourceMappingURL=toSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"./Subscriber\");\nvar OuterSubscriber = (function (_super) {\n    __extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber_1.Subscriber));\nexports.OuterSubscriber = OuterSubscriber;\n//# sourceMappingURL=OuterSubscriber.js.map","/*!\n * perfect-scrollbar v1.5.0\n * Copyright 2020 Hyunje Jun, MDBootstrap and Contributors\n * Licensed under MIT\n */\n\nfunction get(element) {\n  return getComputedStyle(element);\n}\n\nfunction set(element, obj) {\n  for (var key in obj) {\n    var val = obj[key];\n    if (typeof val === 'number') {\n      val = val + \"px\";\n    }\n    element.style[key] = val;\n  }\n  return element;\n}\n\nfunction div(className) {\n  var div = document.createElement('div');\n  div.className = className;\n  return div;\n}\n\nvar elMatches =\n  typeof Element !== 'undefined' &&\n  (Element.prototype.matches ||\n    Element.prototype.webkitMatchesSelector ||\n    Element.prototype.mozMatchesSelector ||\n    Element.prototype.msMatchesSelector);\n\nfunction matches(element, query) {\n  if (!elMatches) {\n    throw new Error('No element matching method supported');\n  }\n\n  return elMatches.call(element, query);\n}\n\nfunction remove(element) {\n  if (element.remove) {\n    element.remove();\n  } else {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  }\n}\n\nfunction queryChildren(element, selector) {\n  return Array.prototype.filter.call(element.children, function (child) { return matches(child, selector); }\n  );\n}\n\nvar cls = {\n  main: 'ps',\n  rtl: 'ps__rtl',\n  element: {\n    thumb: function (x) { return (\"ps__thumb-\" + x); },\n    rail: function (x) { return (\"ps__rail-\" + x); },\n    consuming: 'ps__child--consume',\n  },\n  state: {\n    focus: 'ps--focus',\n    clicking: 'ps--clicking',\n    active: function (x) { return (\"ps--active-\" + x); },\n    scrolling: function (x) { return (\"ps--scrolling-\" + x); },\n  },\n};\n\n/*\n * Helper methods\n */\nvar scrollingClassTimeout = { x: null, y: null };\n\nfunction addScrollingClass(i, x) {\n  var classList = i.element.classList;\n  var className = cls.state.scrolling(x);\n\n  if (classList.contains(className)) {\n    clearTimeout(scrollingClassTimeout[x]);\n  } else {\n    classList.add(className);\n  }\n}\n\nfunction removeScrollingClass(i, x) {\n  scrollingClassTimeout[x] = setTimeout(\n    function () { return i.isAlive && i.element.classList.remove(cls.state.scrolling(x)); },\n    i.settings.scrollingThreshold\n  );\n}\n\nfunction setScrollingClassInstantly(i, x) {\n  addScrollingClass(i, x);\n  removeScrollingClass(i, x);\n}\n\nvar EventElement = function EventElement(element) {\n  this.element = element;\n  this.handlers = {};\n};\n\nvar prototypeAccessors = { isEmpty: { configurable: true } };\n\nEventElement.prototype.bind = function bind (eventName, handler) {\n  if (typeof this.handlers[eventName] === 'undefined') {\n    this.handlers[eventName] = [];\n  }\n  this.handlers[eventName].push(handler);\n  this.element.addEventListener(eventName, handler, false);\n};\n\nEventElement.prototype.unbind = function unbind (eventName, target) {\n    var this$1 = this;\n\n  this.handlers[eventName] = this.handlers[eventName].filter(function (handler) {\n    if (target && handler !== target) {\n      return true;\n    }\n    this$1.element.removeEventListener(eventName, handler, false);\n    return false;\n  });\n};\n\nEventElement.prototype.unbindAll = function unbindAll () {\n  for (var name in this.handlers) {\n    this.unbind(name);\n  }\n};\n\nprototypeAccessors.isEmpty.get = function () {\n    var this$1 = this;\n\n  return Object.keys(this.handlers).every(\n    function (key) { return this$1.handlers[key].length === 0; }\n  );\n};\n\nObject.defineProperties( EventElement.prototype, prototypeAccessors );\n\nvar EventManager = function EventManager() {\n  this.eventElements = [];\n};\n\nEventManager.prototype.eventElement = function eventElement (element) {\n  var ee = this.eventElements.filter(function (ee) { return ee.element === element; })[0];\n  if (!ee) {\n    ee = new EventElement(element);\n    this.eventElements.push(ee);\n  }\n  return ee;\n};\n\nEventManager.prototype.bind = function bind (element, eventName, handler) {\n  this.eventElement(element).bind(eventName, handler);\n};\n\nEventManager.prototype.unbind = function unbind (element, eventName, handler) {\n  var ee = this.eventElement(element);\n  ee.unbind(eventName, handler);\n\n  if (ee.isEmpty) {\n    // remove\n    this.eventElements.splice(this.eventElements.indexOf(ee), 1);\n  }\n};\n\nEventManager.prototype.unbindAll = function unbindAll () {\n  this.eventElements.forEach(function (e) { return e.unbindAll(); });\n  this.eventElements = [];\n};\n\nEventManager.prototype.once = function once (element, eventName, handler) {\n  var ee = this.eventElement(element);\n  var onceHandler = function (evt) {\n    ee.unbind(eventName, onceHandler);\n    handler(evt);\n  };\n  ee.bind(eventName, onceHandler);\n};\n\nfunction createEvent(name) {\n  if (typeof window.CustomEvent === 'function') {\n    return new CustomEvent(name);\n  } else {\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(name, false, false, undefined);\n    return evt;\n  }\n}\n\nfunction processScrollDiff(\n  i,\n  axis,\n  diff,\n  useScrollingClass,\n  forceFireReachEvent\n) {\n  if ( useScrollingClass === void 0 ) useScrollingClass = true;\n  if ( forceFireReachEvent === void 0 ) forceFireReachEvent = false;\n\n  var fields;\n  if (axis === 'top') {\n    fields = [\n      'contentHeight',\n      'containerHeight',\n      'scrollTop',\n      'y',\n      'up',\n      'down' ];\n  } else if (axis === 'left') {\n    fields = [\n      'contentWidth',\n      'containerWidth',\n      'scrollLeft',\n      'x',\n      'left',\n      'right' ];\n  } else {\n    throw new Error('A proper axis should be provided');\n  }\n\n  processScrollDiff$1(i, diff, fields, useScrollingClass, forceFireReachEvent);\n}\n\nfunction processScrollDiff$1(\n  i,\n  diff,\n  ref,\n  useScrollingClass,\n  forceFireReachEvent\n) {\n  var contentHeight = ref[0];\n  var containerHeight = ref[1];\n  var scrollTop = ref[2];\n  var y = ref[3];\n  var up = ref[4];\n  var down = ref[5];\n  if ( useScrollingClass === void 0 ) useScrollingClass = true;\n  if ( forceFireReachEvent === void 0 ) forceFireReachEvent = false;\n\n  var element = i.element;\n\n  // reset reach\n  i.reach[y] = null;\n\n  // 1 for subpixel rounding\n  if (element[scrollTop] < 1) {\n    i.reach[y] = 'start';\n  }\n\n  // 1 for subpixel rounding\n  if (element[scrollTop] > i[contentHeight] - i[containerHeight] - 1) {\n    i.reach[y] = 'end';\n  }\n\n  if (diff) {\n    element.dispatchEvent(createEvent((\"ps-scroll-\" + y)));\n\n    if (diff < 0) {\n      element.dispatchEvent(createEvent((\"ps-scroll-\" + up)));\n    } else if (diff > 0) {\n      element.dispatchEvent(createEvent((\"ps-scroll-\" + down)));\n    }\n\n    if (useScrollingClass) {\n      setScrollingClassInstantly(i, y);\n    }\n  }\n\n  if (i.reach[y] && (diff || forceFireReachEvent)) {\n    element.dispatchEvent(createEvent((\"ps-\" + y + \"-reach-\" + (i.reach[y]))));\n  }\n}\n\nfunction toInt(x) {\n  return parseInt(x, 10) || 0;\n}\n\nfunction isEditable(el) {\n  return (\n    matches(el, 'input,[contenteditable]') ||\n    matches(el, 'select,[contenteditable]') ||\n    matches(el, 'textarea,[contenteditable]') ||\n    matches(el, 'button,[contenteditable]')\n  );\n}\n\nfunction outerWidth(element) {\n  var styles = get(element);\n  return (\n    toInt(styles.width) +\n    toInt(styles.paddingLeft) +\n    toInt(styles.paddingRight) +\n    toInt(styles.borderLeftWidth) +\n    toInt(styles.borderRightWidth)\n  );\n}\n\nvar env = {\n  isWebKit:\n    typeof document !== 'undefined' &&\n    'WebkitAppearance' in document.documentElement.style,\n  supportsTouch:\n    typeof window !== 'undefined' &&\n    ('ontouchstart' in window ||\n      ('maxTouchPoints' in window.navigator &&\n        window.navigator.maxTouchPoints > 0) ||\n      (window.DocumentTouch && document instanceof window.DocumentTouch)),\n  supportsIePointer:\n    typeof navigator !== 'undefined' && navigator.msMaxTouchPoints,\n  isChrome:\n    typeof navigator !== 'undefined' &&\n    /Chrome/i.test(navigator && navigator.userAgent),\n};\n\nfunction updateGeometry(i) {\n  var element = i.element;\n  var roundedScrollTop = Math.floor(element.scrollTop);\n  var rect = element.getBoundingClientRect();\n\n  i.containerWidth = Math.ceil(rect.width);\n  i.containerHeight = Math.ceil(rect.height);\n  i.contentWidth = element.scrollWidth;\n  i.contentHeight = element.scrollHeight;\n\n  if (!element.contains(i.scrollbarXRail)) {\n    // clean up and append\n    queryChildren(element, cls.element.rail('x')).forEach(function (el) { return remove(el); }\n    );\n    element.appendChild(i.scrollbarXRail);\n  }\n  if (!element.contains(i.scrollbarYRail)) {\n    // clean up and append\n    queryChildren(element, cls.element.rail('y')).forEach(function (el) { return remove(el); }\n    );\n    element.appendChild(i.scrollbarYRail);\n  }\n\n  if (\n    !i.settings.suppressScrollX &&\n    i.containerWidth + i.settings.scrollXMarginOffset < i.contentWidth\n  ) {\n    i.scrollbarXActive = true;\n    i.railXWidth = i.containerWidth - i.railXMarginWidth;\n    i.railXRatio = i.containerWidth / i.railXWidth;\n    i.scrollbarXWidth = getThumbSize(\n      i,\n      toInt((i.railXWidth * i.containerWidth) / i.contentWidth)\n    );\n    i.scrollbarXLeft = toInt(\n      ((i.negativeScrollAdjustment + element.scrollLeft) *\n        (i.railXWidth - i.scrollbarXWidth)) /\n        (i.contentWidth - i.containerWidth)\n    );\n  } else {\n    i.scrollbarXActive = false;\n  }\n\n  if (\n    !i.settings.suppressScrollY &&\n    i.containerHeight + i.settings.scrollYMarginOffset < i.contentHeight\n  ) {\n    i.scrollbarYActive = true;\n    i.railYHeight = i.containerHeight - i.railYMarginHeight;\n    i.railYRatio = i.containerHeight / i.railYHeight;\n    i.scrollbarYHeight = getThumbSize(\n      i,\n      toInt((i.railYHeight * i.containerHeight) / i.contentHeight)\n    );\n    i.scrollbarYTop = toInt(\n      (roundedScrollTop * (i.railYHeight - i.scrollbarYHeight)) /\n        (i.contentHeight - i.containerHeight)\n    );\n  } else {\n    i.scrollbarYActive = false;\n  }\n\n  if (i.scrollbarXLeft >= i.railXWidth - i.scrollbarXWidth) {\n    i.scrollbarXLeft = i.railXWidth - i.scrollbarXWidth;\n  }\n  if (i.scrollbarYTop >= i.railYHeight - i.scrollbarYHeight) {\n    i.scrollbarYTop = i.railYHeight - i.scrollbarYHeight;\n  }\n\n  updateCss(element, i);\n\n  if (i.scrollbarXActive) {\n    element.classList.add(cls.state.active('x'));\n  } else {\n    element.classList.remove(cls.state.active('x'));\n    i.scrollbarXWidth = 0;\n    i.scrollbarXLeft = 0;\n    element.scrollLeft = i.isRtl === true ? i.contentWidth : 0;\n  }\n  if (i.scrollbarYActive) {\n    element.classList.add(cls.state.active('y'));\n  } else {\n    element.classList.remove(cls.state.active('y'));\n    i.scrollbarYHeight = 0;\n    i.scrollbarYTop = 0;\n    element.scrollTop = 0;\n  }\n}\n\nfunction getThumbSize(i, thumbSize) {\n  if (i.settings.minScrollbarLength) {\n    thumbSize = Math.max(thumbSize, i.settings.minScrollbarLength);\n  }\n  if (i.settings.maxScrollbarLength) {\n    thumbSize = Math.min(thumbSize, i.settings.maxScrollbarLength);\n  }\n  return thumbSize;\n}\n\nfunction updateCss(element, i) {\n  var xRailOffset = { width: i.railXWidth };\n  var roundedScrollTop = Math.floor(element.scrollTop);\n\n  if (i.isRtl) {\n    xRailOffset.left =\n      i.negativeScrollAdjustment +\n      element.scrollLeft +\n      i.containerWidth -\n      i.contentWidth;\n  } else {\n    xRailOffset.left = element.scrollLeft;\n  }\n  if (i.isScrollbarXUsingBottom) {\n    xRailOffset.bottom = i.scrollbarXBottom - roundedScrollTop;\n  } else {\n    xRailOffset.top = i.scrollbarXTop + roundedScrollTop;\n  }\n  set(i.scrollbarXRail, xRailOffset);\n\n  var yRailOffset = { top: roundedScrollTop, height: i.railYHeight };\n  if (i.isScrollbarYUsingRight) {\n    if (i.isRtl) {\n      yRailOffset.right =\n        i.contentWidth -\n        (i.negativeScrollAdjustment + element.scrollLeft) -\n        i.scrollbarYRight -\n        i.scrollbarYOuterWidth -\n        9;\n    } else {\n      yRailOffset.right = i.scrollbarYRight - element.scrollLeft;\n    }\n  } else {\n    if (i.isRtl) {\n      yRailOffset.left =\n        i.negativeScrollAdjustment +\n        element.scrollLeft +\n        i.containerWidth * 2 -\n        i.contentWidth -\n        i.scrollbarYLeft -\n        i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.left = i.scrollbarYLeft + element.scrollLeft;\n    }\n  }\n  set(i.scrollbarYRail, yRailOffset);\n\n  set(i.scrollbarX, {\n    left: i.scrollbarXLeft,\n    width: i.scrollbarXWidth - i.railBorderXWidth,\n  });\n  set(i.scrollbarY, {\n    top: i.scrollbarYTop,\n    height: i.scrollbarYHeight - i.railBorderYWidth,\n  });\n}\n\nfunction clickRail(i) {\n  var element = i.element;\n\n  i.event.bind(i.scrollbarY, 'mousedown', function (e) { return e.stopPropagation(); });\n  i.event.bind(i.scrollbarYRail, 'mousedown', function (e) {\n    var positionTop =\n      e.pageY -\n      window.pageYOffset -\n      i.scrollbarYRail.getBoundingClientRect().top;\n    var direction = positionTop > i.scrollbarYTop ? 1 : -1;\n\n    i.element.scrollTop += direction * i.containerHeight;\n    updateGeometry(i);\n\n    e.stopPropagation();\n  });\n\n  i.event.bind(i.scrollbarX, 'mousedown', function (e) { return e.stopPropagation(); });\n  i.event.bind(i.scrollbarXRail, 'mousedown', function (e) {\n    var positionLeft =\n      e.pageX -\n      window.pageXOffset -\n      i.scrollbarXRail.getBoundingClientRect().left;\n    var direction = positionLeft > i.scrollbarXLeft ? 1 : -1;\n\n    i.element.scrollLeft += direction * i.containerWidth;\n    updateGeometry(i);\n\n    e.stopPropagation();\n  });\n}\n\nfunction dragThumb(i) {\n  bindMouseScrollHandler(i, [\n    'containerWidth',\n    'contentWidth',\n    'pageX',\n    'railXWidth',\n    'scrollbarX',\n    'scrollbarXWidth',\n    'scrollLeft',\n    'x',\n    'scrollbarXRail' ]);\n  bindMouseScrollHandler(i, [\n    'containerHeight',\n    'contentHeight',\n    'pageY',\n    'railYHeight',\n    'scrollbarY',\n    'scrollbarYHeight',\n    'scrollTop',\n    'y',\n    'scrollbarYRail' ]);\n}\n\nfunction bindMouseScrollHandler(\n  i,\n  ref\n) {\n  var containerHeight = ref[0];\n  var contentHeight = ref[1];\n  var pageY = ref[2];\n  var railYHeight = ref[3];\n  var scrollbarY = ref[4];\n  var scrollbarYHeight = ref[5];\n  var scrollTop = ref[6];\n  var y = ref[7];\n  var scrollbarYRail = ref[8];\n\n  var element = i.element;\n\n  var startingScrollTop = null;\n  var startingMousePageY = null;\n  var scrollBy = null;\n\n  function mouseMoveHandler(e) {\n    if (e.touches && e.touches[0]) {\n      e[pageY] = e.touches[0].pageY;\n    }\n    element[scrollTop] =\n      startingScrollTop + scrollBy * (e[pageY] - startingMousePageY);\n    addScrollingClass(i, y);\n    updateGeometry(i);\n\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  function mouseUpHandler() {\n    removeScrollingClass(i, y);\n    i[scrollbarYRail].classList.remove(cls.state.clicking);\n    i.event.unbind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n  }\n\n  function bindMoves(e, touchMode) {\n    startingScrollTop = element[scrollTop];\n    if (touchMode && e.touches) {\n      e[pageY] = e.touches[0].pageY;\n    }\n    startingMousePageY = e[pageY];\n    scrollBy =\n      (i[contentHeight] - i[containerHeight]) /\n      (i[railYHeight] - i[scrollbarYHeight]);\n    if (!touchMode) {\n      i.event.bind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n      i.event.once(i.ownerDocument, 'mouseup', mouseUpHandler);\n      e.preventDefault();\n    } else {\n      i.event.bind(i.ownerDocument, 'touchmove', mouseMoveHandler);\n    }\n\n    i[scrollbarYRail].classList.add(cls.state.clicking);\n\n    e.stopPropagation();\n  }\n\n  i.event.bind(i[scrollbarY], 'mousedown', function (e) {\n    bindMoves(e);\n  });\n  i.event.bind(i[scrollbarY], 'touchstart', function (e) {\n    bindMoves(e, true);\n  });\n}\n\nfunction keyboard(i) {\n  var element = i.element;\n\n  var elementHovered = function () { return matches(element, ':hover'); };\n  var scrollbarFocused = function () { return matches(i.scrollbarX, ':focus') || matches(i.scrollbarY, ':focus'); };\n\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = Math.floor(element.scrollTop);\n    if (deltaX === 0) {\n      if (!i.scrollbarYActive) {\n        return false;\n      }\n      if (\n        (scrollTop === 0 && deltaY > 0) ||\n        (scrollTop >= i.contentHeight - i.containerHeight && deltaY < 0)\n      ) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n\n    var scrollLeft = element.scrollLeft;\n    if (deltaY === 0) {\n      if (!i.scrollbarXActive) {\n        return false;\n      }\n      if (\n        (scrollLeft === 0 && deltaX < 0) ||\n        (scrollLeft >= i.contentWidth - i.containerWidth && deltaX > 0)\n      ) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n    return true;\n  }\n\n  i.event.bind(i.ownerDocument, 'keydown', function (e) {\n    if (\n      (e.isDefaultPrevented && e.isDefaultPrevented()) ||\n      e.defaultPrevented\n    ) {\n      return;\n    }\n\n    if (!elementHovered() && !scrollbarFocused()) {\n      return;\n    }\n\n    var activeElement = document.activeElement\n      ? document.activeElement\n      : i.ownerDocument.activeElement;\n    if (activeElement) {\n      if (activeElement.tagName === 'IFRAME') {\n        activeElement = activeElement.contentDocument.activeElement;\n      } else {\n        // go deeper if element is a webcomponent\n        while (activeElement.shadowRoot) {\n          activeElement = activeElement.shadowRoot.activeElement;\n        }\n      }\n      if (isEditable(activeElement)) {\n        return;\n      }\n    }\n\n    var deltaX = 0;\n    var deltaY = 0;\n\n    switch (e.which) {\n      case 37: // left\n        if (e.metaKey) {\n          deltaX = -i.contentWidth;\n        } else if (e.altKey) {\n          deltaX = -i.containerWidth;\n        } else {\n          deltaX = -30;\n        }\n        break;\n      case 38: // up\n        if (e.metaKey) {\n          deltaY = i.contentHeight;\n        } else if (e.altKey) {\n          deltaY = i.containerHeight;\n        } else {\n          deltaY = 30;\n        }\n        break;\n      case 39: // right\n        if (e.metaKey) {\n          deltaX = i.contentWidth;\n        } else if (e.altKey) {\n          deltaX = i.containerWidth;\n        } else {\n          deltaX = 30;\n        }\n        break;\n      case 40: // down\n        if (e.metaKey) {\n          deltaY = -i.contentHeight;\n        } else if (e.altKey) {\n          deltaY = -i.containerHeight;\n        } else {\n          deltaY = -30;\n        }\n        break;\n      case 32: // space bar\n        if (e.shiftKey) {\n          deltaY = i.containerHeight;\n        } else {\n          deltaY = -i.containerHeight;\n        }\n        break;\n      case 33: // page up\n        deltaY = i.containerHeight;\n        break;\n      case 34: // page down\n        deltaY = -i.containerHeight;\n        break;\n      case 36: // home\n        deltaY = i.contentHeight;\n        break;\n      case 35: // end\n        deltaY = -i.contentHeight;\n        break;\n      default:\n        return;\n    }\n\n    if (i.settings.suppressScrollX && deltaX !== 0) {\n      return;\n    }\n    if (i.settings.suppressScrollY && deltaY !== 0) {\n      return;\n    }\n\n    element.scrollTop -= deltaY;\n    element.scrollLeft += deltaX;\n    updateGeometry(i);\n\n    if (shouldPreventDefault(deltaX, deltaY)) {\n      e.preventDefault();\n    }\n  });\n}\n\nfunction wheel(i) {\n  var element = i.element;\n\n  function shouldPreventDefault(deltaX, deltaY) {\n    var roundedScrollTop = Math.floor(element.scrollTop);\n    var isTop = element.scrollTop === 0;\n    var isBottom =\n      roundedScrollTop + element.offsetHeight === element.scrollHeight;\n    var isLeft = element.scrollLeft === 0;\n    var isRight =\n      element.scrollLeft + element.offsetWidth === element.scrollWidth;\n\n    var hitsBound;\n\n    // pick axis with primary direction\n    if (Math.abs(deltaY) > Math.abs(deltaX)) {\n      hitsBound = isTop || isBottom;\n    } else {\n      hitsBound = isLeft || isRight;\n    }\n\n    return hitsBound ? !i.settings.wheelPropagation : true;\n  }\n\n  function getDeltaFromEvent(e) {\n    var deltaX = e.deltaX;\n    var deltaY = -1 * e.deltaY;\n\n    if (typeof deltaX === 'undefined' || typeof deltaY === 'undefined') {\n      // OS X Safari\n      deltaX = (-1 * e.wheelDeltaX) / 6;\n      deltaY = e.wheelDeltaY / 6;\n    }\n\n    if (e.deltaMode && e.deltaMode === 1) {\n      // Firefox in deltaMode 1: Line scrolling\n      deltaX *= 10;\n      deltaY *= 10;\n    }\n\n    if (deltaX !== deltaX && deltaY !== deltaY /* NaN checks */) {\n      // IE in some mouse drivers\n      deltaX = 0;\n      deltaY = e.wheelDelta;\n    }\n\n    if (e.shiftKey) {\n      // reverse axis with shift key\n      return [-deltaY, -deltaX];\n    }\n    return [deltaX, deltaY];\n  }\n\n  function shouldBeConsumedByChild(target, deltaX, deltaY) {\n    // FIXME: this is a workaround for <select> issue in FF and IE #571\n    if (!env.isWebKit && element.querySelector('select:focus')) {\n      return true;\n    }\n\n    if (!element.contains(target)) {\n      return false;\n    }\n\n    var cursor = target;\n\n    while (cursor && cursor !== element) {\n      if (cursor.classList.contains(cls.element.consuming)) {\n        return true;\n      }\n\n      var style = get(cursor);\n\n      // if deltaY && vertical scrollable\n      if (deltaY && style.overflowY.match(/(scroll|auto)/)) {\n        var maxScrollTop = cursor.scrollHeight - cursor.clientHeight;\n        if (maxScrollTop > 0) {\n          if (\n            (cursor.scrollTop > 0 && deltaY < 0) ||\n            (cursor.scrollTop < maxScrollTop && deltaY > 0)\n          ) {\n            return true;\n          }\n        }\n      }\n      // if deltaX && horizontal scrollable\n      if (deltaX && style.overflowX.match(/(scroll|auto)/)) {\n        var maxScrollLeft = cursor.scrollWidth - cursor.clientWidth;\n        if (maxScrollLeft > 0) {\n          if (\n            (cursor.scrollLeft > 0 && deltaX < 0) ||\n            (cursor.scrollLeft < maxScrollLeft && deltaX > 0)\n          ) {\n            return true;\n          }\n        }\n      }\n\n      cursor = cursor.parentNode;\n    }\n\n    return false;\n  }\n\n  function mousewheelHandler(e) {\n    var ref = getDeltaFromEvent(e);\n    var deltaX = ref[0];\n    var deltaY = ref[1];\n\n    if (shouldBeConsumedByChild(e.target, deltaX, deltaY)) {\n      return;\n    }\n\n    var shouldPrevent = false;\n    if (!i.settings.useBothWheelAxes) {\n      // deltaX will only be used for horizontal scrolling and deltaY will\n      // only be used for vertical scrolling - this is the default\n      element.scrollTop -= deltaY * i.settings.wheelSpeed;\n      element.scrollLeft += deltaX * i.settings.wheelSpeed;\n    } else if (i.scrollbarYActive && !i.scrollbarXActive) {\n      // only vertical scrollbar is active and useBothWheelAxes option is\n      // active, so let's scroll vertical bar using both mouse wheel axes\n      if (deltaY) {\n        element.scrollTop -= deltaY * i.settings.wheelSpeed;\n      } else {\n        element.scrollTop += deltaX * i.settings.wheelSpeed;\n      }\n      shouldPrevent = true;\n    } else if (i.scrollbarXActive && !i.scrollbarYActive) {\n      // useBothWheelAxes and only horizontal bar is active, so use both\n      // wheel axes for horizontal bar\n      if (deltaX) {\n        element.scrollLeft += deltaX * i.settings.wheelSpeed;\n      } else {\n        element.scrollLeft -= deltaY * i.settings.wheelSpeed;\n      }\n      shouldPrevent = true;\n    }\n\n    updateGeometry(i);\n\n    shouldPrevent = shouldPrevent || shouldPreventDefault(deltaX, deltaY);\n    if (shouldPrevent && !e.ctrlKey) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  if (typeof window.onwheel !== 'undefined') {\n    i.event.bind(element, 'wheel', mousewheelHandler);\n  } else if (typeof window.onmousewheel !== 'undefined') {\n    i.event.bind(element, 'mousewheel', mousewheelHandler);\n  }\n}\n\nfunction touch(i) {\n  if (!env.supportsTouch && !env.supportsIePointer) {\n    return;\n  }\n\n  var element = i.element;\n\n  function shouldPrevent(deltaX, deltaY) {\n    var scrollTop = Math.floor(element.scrollTop);\n    var scrollLeft = element.scrollLeft;\n    var magnitudeX = Math.abs(deltaX);\n    var magnitudeY = Math.abs(deltaY);\n\n    if (magnitudeY > magnitudeX) {\n      // user is perhaps trying to swipe up/down the page\n\n      if (\n        (deltaY < 0 && scrollTop === i.contentHeight - i.containerHeight) ||\n        (deltaY > 0 && scrollTop === 0)\n      ) {\n        // set prevent for mobile Chrome refresh\n        return window.scrollY === 0 && deltaY > 0 && env.isChrome;\n      }\n    } else if (magnitudeX > magnitudeY) {\n      // user is perhaps trying to swipe left/right across the page\n\n      if (\n        (deltaX < 0 && scrollLeft === i.contentWidth - i.containerWidth) ||\n        (deltaX > 0 && scrollLeft === 0)\n      ) {\n        return true;\n      }\n    }\n\n    return true;\n  }\n\n  function applyTouchMove(differenceX, differenceY) {\n    element.scrollTop -= differenceY;\n    element.scrollLeft -= differenceX;\n\n    updateGeometry(i);\n  }\n\n  var startOffset = {};\n  var startTime = 0;\n  var speed = {};\n  var easingLoop = null;\n\n  function getTouch(e) {\n    if (e.targetTouches) {\n      return e.targetTouches[0];\n    } else {\n      // Maybe IE pointer\n      return e;\n    }\n  }\n\n  function shouldHandle(e) {\n    if (e.pointerType && e.pointerType === 'pen' && e.buttons === 0) {\n      return false;\n    }\n    if (e.targetTouches && e.targetTouches.length === 1) {\n      return true;\n    }\n    if (\n      e.pointerType &&\n      e.pointerType !== 'mouse' &&\n      e.pointerType !== e.MSPOINTER_TYPE_MOUSE\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  function touchStart(e) {\n    if (!shouldHandle(e)) {\n      return;\n    }\n\n    var touch = getTouch(e);\n\n    startOffset.pageX = touch.pageX;\n    startOffset.pageY = touch.pageY;\n\n    startTime = new Date().getTime();\n\n    if (easingLoop !== null) {\n      clearInterval(easingLoop);\n    }\n  }\n\n  function shouldBeConsumedByChild(target, deltaX, deltaY) {\n    if (!element.contains(target)) {\n      return false;\n    }\n\n    var cursor = target;\n\n    while (cursor && cursor !== element) {\n      if (cursor.classList.contains(cls.element.consuming)) {\n        return true;\n      }\n\n      var style = get(cursor);\n\n      // if deltaY && vertical scrollable\n      if (deltaY && style.overflowY.match(/(scroll|auto)/)) {\n        var maxScrollTop = cursor.scrollHeight - cursor.clientHeight;\n        if (maxScrollTop > 0) {\n          if (\n            (cursor.scrollTop > 0 && deltaY < 0) ||\n            (cursor.scrollTop < maxScrollTop && deltaY > 0)\n          ) {\n            return true;\n          }\n        }\n      }\n      // if deltaX && horizontal scrollable\n      if (deltaX && style.overflowX.match(/(scroll|auto)/)) {\n        var maxScrollLeft = cursor.scrollWidth - cursor.clientWidth;\n        if (maxScrollLeft > 0) {\n          if (\n            (cursor.scrollLeft > 0 && deltaX < 0) ||\n            (cursor.scrollLeft < maxScrollLeft && deltaX > 0)\n          ) {\n            return true;\n          }\n        }\n      }\n\n      cursor = cursor.parentNode;\n    }\n\n    return false;\n  }\n\n  function touchMove(e) {\n    if (shouldHandle(e)) {\n      var touch = getTouch(e);\n\n      var currentOffset = { pageX: touch.pageX, pageY: touch.pageY };\n\n      var differenceX = currentOffset.pageX - startOffset.pageX;\n      var differenceY = currentOffset.pageY - startOffset.pageY;\n\n      if (shouldBeConsumedByChild(e.target, differenceX, differenceY)) {\n        return;\n      }\n\n      applyTouchMove(differenceX, differenceY);\n      startOffset = currentOffset;\n\n      var currentTime = new Date().getTime();\n\n      var timeGap = currentTime - startTime;\n      if (timeGap > 0) {\n        speed.x = differenceX / timeGap;\n        speed.y = differenceY / timeGap;\n        startTime = currentTime;\n      }\n\n      if (shouldPrevent(differenceX, differenceY)) {\n        e.preventDefault();\n      }\n    }\n  }\n  function touchEnd() {\n    if (i.settings.swipeEasing) {\n      clearInterval(easingLoop);\n      easingLoop = setInterval(function() {\n        if (i.isInitialized) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (!speed.x && !speed.y) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (Math.abs(speed.x) < 0.01 && Math.abs(speed.y) < 0.01) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        applyTouchMove(speed.x * 30, speed.y * 30);\n\n        speed.x *= 0.8;\n        speed.y *= 0.8;\n      }, 10);\n    }\n  }\n\n  if (env.supportsTouch) {\n    i.event.bind(element, 'touchstart', touchStart);\n    i.event.bind(element, 'touchmove', touchMove);\n    i.event.bind(element, 'touchend', touchEnd);\n  } else if (env.supportsIePointer) {\n    if (window.PointerEvent) {\n      i.event.bind(element, 'pointerdown', touchStart);\n      i.event.bind(element, 'pointermove', touchMove);\n      i.event.bind(element, 'pointerup', touchEnd);\n    } else if (window.MSPointerEvent) {\n      i.event.bind(element, 'MSPointerDown', touchStart);\n      i.event.bind(element, 'MSPointerMove', touchMove);\n      i.event.bind(element, 'MSPointerUp', touchEnd);\n    }\n  }\n}\n\nvar defaultSettings = function () { return ({\n  handlers: ['click-rail', 'drag-thumb', 'keyboard', 'wheel', 'touch'],\n  maxScrollbarLength: null,\n  minScrollbarLength: null,\n  scrollingThreshold: 1000,\n  scrollXMarginOffset: 0,\n  scrollYMarginOffset: 0,\n  suppressScrollX: false,\n  suppressScrollY: false,\n  swipeEasing: true,\n  useBothWheelAxes: false,\n  wheelPropagation: true,\n  wheelSpeed: 1,\n}); };\n\nvar handlers = {\n  'click-rail': clickRail,\n  'drag-thumb': dragThumb,\n  keyboard: keyboard,\n  wheel: wheel,\n  touch: touch,\n};\n\nvar PerfectScrollbar = function PerfectScrollbar(element, userSettings) {\n  var this$1 = this;\n  if ( userSettings === void 0 ) userSettings = {};\n\n  if (typeof element === 'string') {\n    element = document.querySelector(element);\n  }\n\n  if (!element || !element.nodeName) {\n    throw new Error('no element is specified to initialize PerfectScrollbar');\n  }\n\n  this.element = element;\n\n  element.classList.add(cls.main);\n\n  this.settings = defaultSettings();\n  for (var key in userSettings) {\n    this.settings[key] = userSettings[key];\n  }\n\n  this.containerWidth = null;\n  this.containerHeight = null;\n  this.contentWidth = null;\n  this.contentHeight = null;\n\n  var focus = function () { return element.classList.add(cls.state.focus); };\n  var blur = function () { return element.classList.remove(cls.state.focus); };\n\n  this.isRtl = get(element).direction === 'rtl';\n  if (this.isRtl === true) {\n    element.classList.add(cls.rtl);\n  }\n  this.isNegativeScroll = (function () {\n    var originalScrollLeft = element.scrollLeft;\n    var result = null;\n    element.scrollLeft = -1;\n    result = element.scrollLeft < 0;\n    element.scrollLeft = originalScrollLeft;\n    return result;\n  })();\n  this.negativeScrollAdjustment = this.isNegativeScroll\n    ? element.scrollWidth - element.clientWidth\n    : 0;\n  this.event = new EventManager();\n  this.ownerDocument = element.ownerDocument || document;\n\n  this.scrollbarXRail = div(cls.element.rail('x'));\n  element.appendChild(this.scrollbarXRail);\n  this.scrollbarX = div(cls.element.thumb('x'));\n  this.scrollbarXRail.appendChild(this.scrollbarX);\n  this.scrollbarX.setAttribute('tabindex', 0);\n  this.event.bind(this.scrollbarX, 'focus', focus);\n  this.event.bind(this.scrollbarX, 'blur', blur);\n  this.scrollbarXActive = null;\n  this.scrollbarXWidth = null;\n  this.scrollbarXLeft = null;\n  var railXStyle = get(this.scrollbarXRail);\n  this.scrollbarXBottom = parseInt(railXStyle.bottom, 10);\n  if (isNaN(this.scrollbarXBottom)) {\n    this.isScrollbarXUsingBottom = false;\n    this.scrollbarXTop = toInt(railXStyle.top);\n  } else {\n    this.isScrollbarXUsingBottom = true;\n  }\n  this.railBorderXWidth =\n    toInt(railXStyle.borderLeftWidth) + toInt(railXStyle.borderRightWidth);\n  // Set rail to display:block to calculate margins\n  set(this.scrollbarXRail, { display: 'block' });\n  this.railXMarginWidth =\n    toInt(railXStyle.marginLeft) + toInt(railXStyle.marginRight);\n  set(this.scrollbarXRail, { display: '' });\n  this.railXWidth = null;\n  this.railXRatio = null;\n\n  this.scrollbarYRail = div(cls.element.rail('y'));\n  element.appendChild(this.scrollbarYRail);\n  this.scrollbarY = div(cls.element.thumb('y'));\n  this.scrollbarYRail.appendChild(this.scrollbarY);\n  this.scrollbarY.setAttribute('tabindex', 0);\n  this.event.bind(this.scrollbarY, 'focus', focus);\n  this.event.bind(this.scrollbarY, 'blur', blur);\n  this.scrollbarYActive = null;\n  this.scrollbarYHeight = null;\n  this.scrollbarYTop = null;\n  var railYStyle = get(this.scrollbarYRail);\n  this.scrollbarYRight = parseInt(railYStyle.right, 10);\n  if (isNaN(this.scrollbarYRight)) {\n    this.isScrollbarYUsingRight = false;\n    this.scrollbarYLeft = toInt(railYStyle.left);\n  } else {\n    this.isScrollbarYUsingRight = true;\n  }\n  this.scrollbarYOuterWidth = this.isRtl ? outerWidth(this.scrollbarY) : null;\n  this.railBorderYWidth =\n    toInt(railYStyle.borderTopWidth) + toInt(railYStyle.borderBottomWidth);\n  set(this.scrollbarYRail, { display: 'block' });\n  this.railYMarginHeight =\n    toInt(railYStyle.marginTop) + toInt(railYStyle.marginBottom);\n  set(this.scrollbarYRail, { display: '' });\n  this.railYHeight = null;\n  this.railYRatio = null;\n\n  this.reach = {\n    x:\n      element.scrollLeft <= 0\n        ? 'start'\n        : element.scrollLeft >= this.contentWidth - this.containerWidth\n        ? 'end'\n        : null,\n    y:\n      element.scrollTop <= 0\n        ? 'start'\n        : element.scrollTop >= this.contentHeight - this.containerHeight\n        ? 'end'\n        : null,\n  };\n\n  this.isAlive = true;\n\n  this.settings.handlers.forEach(function (handlerName) { return handlers[handlerName](this$1); });\n\n  this.lastScrollTop = Math.floor(element.scrollTop); // for onScroll only\n  this.lastScrollLeft = element.scrollLeft; // for onScroll only\n  this.event.bind(this.element, 'scroll', function (e) { return this$1.onScroll(e); });\n  updateGeometry(this);\n};\n\nPerfectScrollbar.prototype.update = function update () {\n  if (!this.isAlive) {\n    return;\n  }\n\n  // Recalcuate negative scrollLeft adjustment\n  this.negativeScrollAdjustment = this.isNegativeScroll\n    ? this.element.scrollWidth - this.element.clientWidth\n    : 0;\n\n  // Recalculate rail margins\n  set(this.scrollbarXRail, { display: 'block' });\n  set(this.scrollbarYRail, { display: 'block' });\n  this.railXMarginWidth =\n    toInt(get(this.scrollbarXRail).marginLeft) +\n    toInt(get(this.scrollbarXRail).marginRight);\n  this.railYMarginHeight =\n    toInt(get(this.scrollbarYRail).marginTop) +\n    toInt(get(this.scrollbarYRail).marginBottom);\n\n  // Hide scrollbars not to affect scrollWidth and scrollHeight\n  set(this.scrollbarXRail, { display: 'none' });\n  set(this.scrollbarYRail, { display: 'none' });\n\n  updateGeometry(this);\n\n  processScrollDiff(this, 'top', 0, false, true);\n  processScrollDiff(this, 'left', 0, false, true);\n\n  set(this.scrollbarXRail, { display: '' });\n  set(this.scrollbarYRail, { display: '' });\n};\n\nPerfectScrollbar.prototype.onScroll = function onScroll (e) {\n  if (!this.isAlive) {\n    return;\n  }\n\n  updateGeometry(this);\n  processScrollDiff(this, 'top', this.element.scrollTop - this.lastScrollTop);\n  processScrollDiff(\n    this,\n    'left',\n    this.element.scrollLeft - this.lastScrollLeft\n  );\n\n  this.lastScrollTop = Math.floor(this.element.scrollTop);\n  this.lastScrollLeft = this.element.scrollLeft;\n};\n\nPerfectScrollbar.prototype.destroy = function destroy () {\n  if (!this.isAlive) {\n    return;\n  }\n\n  this.event.unbindAll();\n  remove(this.scrollbarX);\n  remove(this.scrollbarY);\n  remove(this.scrollbarXRail);\n  remove(this.scrollbarYRail);\n  this.removePsClasses();\n\n  // unset elements\n  this.element = null;\n  this.scrollbarX = null;\n  this.scrollbarY = null;\n  this.scrollbarXRail = null;\n  this.scrollbarYRail = null;\n\n  this.isAlive = false;\n};\n\nPerfectScrollbar.prototype.removePsClasses = function removePsClasses () {\n  this.element.className = this.element.className\n    .split(' ')\n    .filter(function (name) { return !name.match(/^ps([-_].+|)$/); })\n    .join(' ');\n};\n\nexport default PerfectScrollbar;\n//# sourceMappingURL=perfect-scrollbar.esm.js.map\n","import {InjectionToken} from '@angular/core';\r\n\r\nexport const SUPPORTS_NATIVE_SCROLLBAR_STYLING = new InjectionToken<boolean>('SUPPORTS_NATIVE_SCROLLBAR_STYLING', {\r\n    providedIn: 'root',\r\n    factory: () => {\r\n        // Detect IE, does not support custom scrollbars\r\n        if (navigator.userAgent.indexOf('MSIE') !== -1\r\n            || navigator.appVersion.indexOf('Trident/') > -1) {\r\n            return false;\r\n        }\r\n\r\n        // Tested Element\r\n        const test = document.createElement('div');\r\n        test.className = '__sb-test';\r\n        test.style.overflow = 'scroll';\r\n        test.style.width = '40px';\r\n\r\n        // Is there another way to style pseudo-elements in JS ?\r\n        const style = document.createElement('style');\r\n        style.innerHTML = '.__sb-test::-webkit-scrollbar { width: 0px; }';\r\n\r\n        // Apply\r\n        test.appendChild(style);\r\n        document.body.appendChild(test);\r\n\r\n        // If css scrollbar is supported, than the scrollWidth should not be impacted\r\n        const result = test.scrollWidth == 40;\r\n\r\n        // Cleaning\r\n        document.body.removeChild(test);\r\n\r\n        return result;\r\n    }\r\n});\r\n","import {AfterViewInit, Directive, ElementRef, Inject, Input, NgZone, OnDestroy, Renderer2} from '@angular/core';\r\nimport PerfectScrollbar from 'perfect-scrollbar';\r\nimport {Subscription, Subject} from 'rxjs';\r\nimport {BreakpointsService} from '../breakpoints.service';\r\nimport {MutationObserverFactory} from '@angular/cdk/observers';\r\nimport {Settings} from '../../config/settings.service';\r\nimport {SUPPORTS_NATIVE_SCROLLBAR_STYLING} from './supports-native-scrollbar-styling';\r\n\r\n@Directive({\r\n    selector: '[customScrollbar]'\r\n})\r\nexport class CustomScrollbarDirective implements AfterViewInit, OnDestroy {\r\n    private subscriptions: Subscription[] = [];\r\n\r\n    /**\r\n     * Minimum length for scrollbar drag handle.\r\n     */\r\n    @Input('customScrollbarMinLength') minLength = 100;\r\n\r\n    /**\r\n     * Whether horizontal scrollbar should be always hidden.\r\n     */\r\n    @Input() suppressX = true;\r\n\r\n    /**\r\n     * scrollTop value set via custom setScrollTop() method.\r\n     * Perfect Scrollbar doesn't preserve scrollTop value on DOM\r\n     * element for some reason, so we need to keep it here.\r\n     */\r\n    private scrollTop = 0;\r\n\r\n    /**\r\n     * Whether custom or native scrollbar is used.\r\n     */\r\n    private native = true;\r\n\r\n    private scrollbar: PerfectScrollbar;\r\n\r\n    private observer: MutationObserver;\r\n\r\n    /**\r\n     * Used for debouncing the emitted values to the observeContent event.\r\n     */\r\n    private debouncer = new Subject<MutationRecord[]>();\r\n\r\n    constructor(\r\n        private el: ElementRef,\r\n        private renderer: Renderer2,\r\n        private breakpoints: BreakpointsService,\r\n        private ngZone: NgZone,\r\n        private mutationObserverFactory: MutationObserverFactory,\r\n        private config: Settings,\r\n        @Inject(SUPPORTS_NATIVE_SCROLLBAR_STYLING) private supportsNativeStyling: boolean,\r\n    ) {}\r\n\r\n    ngAfterViewInit() {\r\n        if (this.suppressX) {\r\n            this.renderer.addClass(this.el.nativeElement, 'scroll-container');\r\n        } else {\r\n            this.renderer.addClass(this.el.nativeElement, 'scroll-container-x');\r\n        }\r\n\r\n        if (this.shouldUseNative()) return;\r\n\r\n        this.scrollbar = new PerfectScrollbar(this.el.nativeElement, {\r\n            minScrollbarLength: this.minLength,\r\n            suppressScrollX: this.suppressX,\r\n            useBothWheelAxes: !this.suppressX,\r\n            wheelSpeed: 2\r\n        });\r\n\r\n        this.native = false;\r\n\r\n        this.bindToContentChange();\r\n    }\r\n\r\n    /**\r\n     * Update custom scrollbar.\r\n     */\r\n    public update() {\r\n        if (this.native) return;\r\n        this.scrollbar.update();\r\n    }\r\n\r\n    /**\r\n     * Scroll container top to given value.\r\n     */\r\n    public setScrollTop(value = 0) {\r\n        this.el.nativeElement.scrollTop = value;\r\n        this.scrollTop = this.el.nativeElement.scrollTop;\r\n        this.update();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.subscriptions.forEach(sub => sub.unsubscribe());\r\n        this.subscriptions = [];\r\n\r\n        if ( ! this.native) {\r\n            this.scrollbar.destroy();\r\n        }\r\n\r\n        // disable observer\r\n        this.debouncer.complete();\r\n        this.observer && this.observer.disconnect();\r\n    }\r\n\r\n    /**\r\n     * Check whether native or custom scrollbar should be used.\r\n     */\r\n    private shouldUseNative(): boolean {\r\n        if (this.config.get('vebto.forceCustomScrollbar')) return false;\r\n        if (/Edge/.test(navigator.userAgent)) return false;\r\n        if (this.breakpoints.isMobile$.value) return true;\r\n        return this.supportsNativeStyling;\r\n    }\r\n\r\n    /**\r\n     * Update custom scrollbar when element content changes.\r\n     */\r\n    private bindToContentChange() {\r\n        this.observer = this.ngZone.runOutsideAngular(() => {\r\n            return this.mutationObserverFactory.create((mutations: MutationRecord[]) => {\r\n                this.debouncer.next(mutations);\r\n            });\r\n        });\r\n\r\n        this.observer.observe(this.el.nativeElement, {\r\n            childList: true,\r\n            subtree: true\r\n        });\r\n\r\n        this.ngZone.runOutsideAngular(() => {\r\n            this.debouncer.subscribe((mutations: MutationRecord[]) => this.update());\r\n        });\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar hostReportError_1 = require(\"./hostReportError\");\nexports.subscribeToPromise = function (promise) { return function (subscriber) {\n    promise.then(function (value) {\n        if (!subscriber.closed) {\n            subscriber.next(value);\n            subscriber.complete();\n        }\n    }, function (err) { return subscriber.error(err); })\n        .then(null, hostReportError_1.hostReportError);\n    return subscriber;\n}; };\n//# sourceMappingURL=subscribeToPromise.js.map","import {ChangeDetectionStrategy, Component, Input} from '@angular/core';\r\nimport {BaseFilePreview} from '../base-file-preview';\r\n\r\n@Component({\r\n    selector: 'default-preview',\r\n    templateUrl: './default-preview.component.html',\r\n    styleUrls: ['./default-preview.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class DefaultPreviewComponent extends BaseFilePreview {\r\n    @Input() message: string;\r\n\r\n    public getMessage() {\r\n        return this.message || 'No file preview available.';\r\n    }\r\n}\r\n","<div class=\"panel preview-object\">\r\n    <div class=\"message\" trans>{{getMessage()}}</div>\r\n    <button mat-raised-button color=\"accent\" (click)=\"download.emit()\" trans>Download</button>\r\n</div>","import {AfterViewInit, Component, Inject, ViewChild, ViewEncapsulation} from '@angular/core';\r\nimport {TicketsService} from '../tickets.service';\r\nimport {Reply} from '../../shared/models/Reply';\r\nimport {TextEditorComponent} from '@common/text-editor/text-editor.component';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport {UploadQueueService} from '@common/uploads/upload-queue/upload-queue.service';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\n\r\ninterface UpdateReplyModalData {\r\n    reply: Reply;\r\n}\r\n\r\ninterface UpdateReplyModalErrors {\r\n    body?: string;\r\n    attachments?: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'update-reply-modal',\r\n    templateUrl: './update-reply-modal.component.html',\r\n    styleUrls: ['./update-reply-modal.component.scss'],\r\n    providers: [UploadQueueService],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class UpdateReplyModalComponent implements AfterViewInit {\r\n    @ViewChild(TextEditorComponent, { static: true }) textEditor: TextEditorComponent;\r\n\r\n    private reply: Reply;\r\n    public attachments: FileEntry[] = [];\r\n    public errors: UpdateReplyModalErrors = {};\r\n\r\n    constructor(\r\n        private dialogRef: MatDialogRef<UpdateReplyModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: UpdateReplyModalData,\r\n        private tickets: TicketsService,\r\n        private uploadQueue: UploadQueueService,\r\n    ) {\r\n        this.hydrate();\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        this.textEditor.focus();\r\n        this.textEditor.setContents(this.reply.body);\r\n    }\r\n\r\n    private hydrate() {\r\n        this.reply = Object.assign({}, this.data.reply);\r\n        this.attachments = this.reply.uploads.slice();\r\n    }\r\n\r\n    public close(reply?: Reply) {\r\n        this.dialogRef.close(reply);\r\n        this.textEditor.destroyEditor();\r\n    }\r\n\r\n    public confirm() {\r\n        const payload = {\r\n            body: this.textEditor.getContents(),\r\n            uploads: this.attachments.map(attachment => attachment.id)\r\n        };\r\n\r\n        this.tickets.updateReply(this.reply.id, payload).subscribe(response => {\r\n            this.close(response.data);\r\n        }, errorResponse => this.errors = errorResponse.messages);\r\n    }\r\n\r\n    public uploadFiles(files: UploadedFile[]) {\r\n        this.uploadQueue.start(files).subscribe(response => {\r\n            this.attachments = [...this.attachments, response.fileEntry];\r\n        });\r\n    }\r\n\r\n    public removeAttachment(entry: FileEntry) {\r\n        for (let i = 0; i < this.attachments.length; i++) {\r\n            if (this.attachments[i].id === entry.id) {\r\n                this.attachments.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","<div class=\"modal-header\">\r\n    <h2 mat-dialog-title trans>Update Reply</h2>\r\n    <button type=\"button\" (click)=\"close()\" class=\"close-button\" mat-icon-button tabindex=\"-1\">\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<mat-dialog-content class=\"many-inputs\">\r\n    <div class=\"input-container\">\r\n        <text-editor inlineUploadPrefix=\"ticket_images\" [minHeight]=\"300\" (onFileUpload)=\"uploadFiles($event)\"></text-editor>\r\n        <upload-progress-bar></upload-progress-bar>\r\n\r\n        <div class=\"error\" *ngIf=\"errors.body\">{{errors.body}}</div>\r\n        <div class=\"error\" *ngIf=\"errors.attachments\">{{errors.attachments}}</div>\r\n\r\n        <reply-attachment-list [attachments]=\"attachments\" *ngIf=\"attachments.length\"\r\n                               (detached)=\"removeAttachment($event)\"></reply-attachment-list>\r\n    </div>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions>\r\n    <button (click)=\"close()\" type=\"button\" class=\"cancel-button\" mat-button trans>Cancel</button>\r\n    <button type=\"submit\" class=\"submit-button\" mat-raised-button color=\"accent\" (click)=\"confirm()\" trans>Update</button>\r\n</mat-dialog-actions>\r\n","import {Injectable} from '@angular/core';\r\nimport {Observable} from 'rxjs';\r\nimport {Upload} from '../shared/models/Upload';\r\nimport {AppHttpClient} from '@common/core/http/app-http-client.service';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class TicketAttachmentsService {\r\n    constructor(private httpClient: AppHttpClient) {}\r\n\r\n    public attach(conversationId: number, attachments: Upload[] = [], draft: string = null) {\r\n        const payload: any = { ids: [] };\r\n\r\n        payload.ids = attachments.map(attachment => attachment.id);\r\n\r\n        if (draft) payload.body = draft;\r\n\r\n        return this.httpClient.post('tickets/' + conversationId + '/attachments', payload);\r\n    }\r\n\r\n    public detach(draftId: number, uploadId: number): Observable<{data: number}> {\r\n        return this.httpClient.post('drafts/' + draftId + '/uploads/' + uploadId + '/detach');\r\n    }\r\n}\r\n","<div class=\"title-container\">\r\n    <h2 class=\"ticket-subject\">{{conversation.get().subject}}</h2>\r\n    <div class=\"tags\">\r\n        <ng-template ngFor let-tag [ngForOf]=\"conversation.get().tags\">\r\n            <div class=\"tag-label\" *ngIf=\"tag.type !== 'status'\">\r\n                <span class=\"tag-name\">{{tag.name}}</span>\r\n                <button class=\"no-style remove-tag-button\" type=\"button\" (click)=\"removeTag(tag)\" title=\"Remove Tag\" *ngIf=\"currentUser.hasPermission('tickets.update')\">\r\n                    <mat-icon svgIcon=\"close\"></mat-icon>\r\n                </button>\r\n            </div>\r\n        </ng-template>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"title-meta\">\r\n    <div class=\"ticket-created-at-date\">{{conversation.get()['created_at_formatted']}} ({{conversation.get()['created_at_month']}})</div>\r\n    <div class=\"actions\">\r\n        <button class=\"button reply-button\" (click)=\"conversation.openEditor()\" [matTooltip]=\"'Reply (r)' | trans\"><mat-icon svgIcon=\"reply\"></mat-icon></button>\r\n    </div>\r\n</div>","import {Component, ViewEncapsulation} from '@angular/core';\r\nimport {Conversation} from '../conversation.service';\r\nimport {Tag} from '../../shared/models/Tag';\r\nimport {TicketsService} from '../../ticketing/tickets.service';\r\nimport {MailboxTagsService} from '../../ticketing/mailbox-tags.service';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\n\r\n@Component({\r\n    selector: 'conversation-header',\r\n    templateUrl: './conversation-header.component.html',\r\n    styleUrls: ['./conversation-header.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationHeaderComponent {\r\n    constructor(\r\n        private tickets: TicketsService,\r\n        public currentUser: CurrentUser,\r\n        private mailboxTags: MailboxTagsService,\r\n        public conversation: Conversation,\r\n    ) {}\r\n\r\n    /**\r\n     * Remove specified tag from current ticket.\r\n     */\r\n    public removeTag(tagToRemove: Tag) {\r\n        this.tickets.removeTag(tagToRemove, [this.conversation.get().id]).subscribe(() => {\r\n            this.conversation.get().tags = this.conversation.get().tags.filter(tag => tag.id !== tagToRemove.id);\r\n            this.mailboxTags.refresh();\r\n        });\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar InnerSubscriber_1 = require(\"../InnerSubscriber\");\nvar subscribeTo_1 = require(\"./subscribeTo\");\nvar Observable_1 = require(\"../Observable\");\nfunction subscribeToResult(outerSubscriber, result, outerValue, outerIndex, innerSubscriber) {\n    if (innerSubscriber === void 0) { innerSubscriber = new InnerSubscriber_1.InnerSubscriber(outerSubscriber, outerValue, outerIndex); }\n    if (innerSubscriber.closed) {\n        return undefined;\n    }\n    if (result instanceof Observable_1.Observable) {\n        return result.subscribe(innerSubscriber);\n    }\n    return subscribeTo_1.subscribeTo(result)(innerSubscriber);\n}\nexports.subscribeToResult = subscribeToResult;\n//# sourceMappingURL=subscribeToResult.js.map","import {User} from './User';\nimport {FileEntry} from '@common/uploads/types/file-entry';\n\nexport class CannedReply {\n    id: number;\n    name: string;\n    body: string;\n    user_id: number;\n    shared = false;\n    created_at?: string;\n    updated_at?: string;\n    uploads?: FileEntry[];\n    user?: User;\n\n    constructor(params: Object = {}) {\n        for (const name in params) {\n            this[name] = params[name];\n        }\n    }\n}\n","import {Injectable} from '@angular/core';\r\nimport {TicketsService} from '../ticketing/tickets.service';\r\nimport {MailboxTagsService} from '../ticketing/mailbox-tags.service';\r\nimport {Router} from '@angular/router';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {Settings} from '@common/core/config/settings.service';\r\nimport {LocalStorage} from '@common/core/services/local-storage.service';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class AfterReplyAction {\r\n    public defaultAction: string;\r\n    private activeTicketId: number;\r\n\r\n    constructor(\r\n        private router: Router,\r\n        private toast: Toast,\r\n        private tickets: TicketsService,\r\n        private settings: Settings,\r\n        private mailboxTags: MailboxTagsService,\r\n        private localStorage: LocalStorage,\r\n    ) {\r\n        this.defaultAction = this.settings.get('replies.after_reply_action', 'next_active_ticket');\r\n    }\r\n\r\n    public perform() {\r\n        // we're currently in help center tickets list\r\n        if (this.router.url.indexOf('help-center') > -1) {\r\n            this.navigateToCustomerTicketsList();\r\n            return;\r\n        }\r\n\r\n        switch (this.get()) {\r\n            case 'next_active_ticket':\r\n                this.navigateToNextActiveTicket();\r\n                break;\r\n            case 'back_to_folder':\r\n                this.navigateToAgentTicketsList();\r\n                break;\r\n        }\r\n\r\n        this.mailboxTags.refresh();\r\n    }\r\n\r\n    /**\r\n     * Get currently active after redirect action.\r\n     */\r\n    public get() {\r\n        return this.localStorage.get('after_reply_action', this.defaultAction);\r\n    }\r\n\r\n    /**\r\n     * Change default action that is applied after reply submit.\r\n     */\r\n    public set(value: string = null) {\r\n        this.defaultAction = value;\r\n        this.localStorage.set('after_reply_action', value);\r\n    }\r\n\r\n    /**\r\n     * Set currently active ticket id.\r\n     */\r\n    public setTicketId(id: number) {\r\n        this.activeTicketId = id;\r\n    }\r\n\r\n    /**\r\n     * Navigate to next active ticket belonging to currently active tag.\r\n     */\r\n    private navigateToNextActiveTicket() {\r\n        const tagId = this.mailboxTags.getActiveTagId();\r\n        this.tickets.getLatestActiveTicket(tagId).subscribe(ticket => {\r\n            if (ticket && ticket.id !== this.activeTicketId) {\r\n                this.router.navigate(['/mailbox/tickets/tag/', tagId, 'ticket', ticket.id]);\r\n            } else {\r\n                this.navigateToAgentTicketsList();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Navigate back to tickets list for currently active tag.\r\n     */\r\n    private navigateToAgentTicketsList() {\r\n        this.router.navigate(['/mailbox/tickets/tag/' + this.mailboxTags.getActiveTagId()]);\r\n    }\r\n\r\n    /**\r\n     * Navigate back to customers ticket list.\r\n     */\r\n    public navigateToCustomerTicketsList(message?: string) {\r\n        this.router.navigate(['/help-center/tickets']);\r\n        this.toast.open(message || 'Your reply was submitted successfully.');\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar subscribeTo_1 = require(\"../util/subscribeTo\");\nvar scheduled_1 = require(\"../scheduled/scheduled\");\nfunction from(input, scheduler) {\n    if (!scheduler) {\n        if (input instanceof Observable_1.Observable) {\n            return input;\n        }\n        return new Observable_1.Observable(subscribeTo_1.subscribeTo(input));\n    }\n    else {\n        return scheduled_1.scheduled(input, scheduler);\n    }\n}\nexports.from = from;\n//# sourceMappingURL=from.js.map","import {NgModule} from '@angular/core';\r\nimport {CustomScrollbarDirective} from './custom-scrollbar.directive';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        CustomScrollbarDirective\r\n    ],\r\n    exports: [\r\n        CustomScrollbarDirective,\r\n    ]\r\n})\r\nexport class CustomScrollbarModule {\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {Resolve, ActivatedRouteSnapshot, Router} from '@angular/router';\r\nimport {HttpCacheClient} from '@common/core/http/http-cache-client';\r\nimport {catchError, mergeMap} from 'rxjs/operators';\r\nimport {EMPTY, Observable, of} from 'rxjs';\r\nimport {Tag} from '../shared/models/Tag';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class NewTicketCategoriesResolve implements Resolve<Tag[]> {\r\n    constructor(\r\n        private router: Router,\r\n        private http: HttpCacheClient,\r\n    ) {}\r\n\r\n    resolve(route: ActivatedRouteSnapshot): Observable<Tag[]> {\r\n        return this.http.get('new-ticket/categories')\r\n            .pipe(\r\n                catchError(() => {\r\n                    this.router.navigateByUrl('/');\r\n                    return EMPTY;\r\n                }),\r\n                mergeMap((response: {tags: Tag[]}) => {\r\n                    return of(response.tags);\r\n                })\r\n            );\r\n    }\r\n}\r\n","import {Inject, LOCALE_ID, Pipe, PipeTransform} from '@angular/core';\r\nimport {DatePipe} from '@angular/common';\r\nimport {Settings} from '../../config/settings.service';\r\n\r\n@Pipe({\r\n    name: 'formattedDate'\r\n})\r\nexport class FormattedDatePipe implements PipeTransform {\r\n    private readonly format: string;\r\n    private angularPipe: DatePipe;\r\n\r\n    /**\r\n     * FormattedDatePipe Constructor.\r\n     */\r\n    constructor(private settings: Settings, @Inject(LOCALE_ID) private _locale: string) {\r\n        this.format = this.settings.get('dates.format', 'yyyy-MM-dd');\r\n        this.angularPipe = new DatePipe(_locale);\r\n    }\r\n\r\n    transform(value: any, format?: string, timezone?: string, locale?: string): string | null {\r\n        // iOS does not support YYYY-MM-DD\r\n        value = (value && typeof value === 'string' ) ? value.replace(/-/g, '/') : value;\r\n        return this.angularPipe.transform(value, format || this.format, timezone, locale);\r\n    }\r\n}\r\n","import { InjectionToken } from '@angular/core';\r\n\r\nexport const CURRENT_PREVIEW_FILE = new InjectionToken<any>('CURRENT_PREVIEW_FILE');\r\n","import {Injectable} from '@angular/core';\r\nimport {NavigationEnd, Router} from '@angular/router';\r\nimport {filter} from 'rxjs/operators';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class RouterHistory {\r\n\r\n    /**\r\n     * Application route history.\r\n     */\r\n    private history: {url: string, queryParams?: Object}[] = [];\r\n\r\n    /**\r\n     * Maximum number of history items.\r\n     */\r\n    private  limit = 15;\r\n\r\n    /**\r\n     * RouteHistory Constructor.\r\n     */\r\n    constructor(private router: Router) {}\r\n\r\n    /**\r\n     * get history item at specified index or first item.\r\n     */\r\n    public get(index = 0) {\r\n        return this.history[index] || null;\r\n    }\r\n\r\n    /**\r\n     * Get previous history item.\r\n     */\r\n    public getPrevious() {\r\n        return this.get(1);\r\n    }\r\n\r\n    /**\r\n     * Navigate to previous url in routing history.\r\n     */\r\n    public back(): Promise<boolean> {\r\n        const item = this.getPrevious();\r\n        if ( ! item) return new Promise(resolve => resolve(false));\r\n\r\n        return this.router.navigate([item.url], {queryParams: item.queryParams})\r\n    }\r\n\r\n    /**\r\n     * Add new route history item from specified uri.\r\n     */\r\n    private addHistoryItem(uri: string) {\r\n        const parts = uri.split('?');\r\n        let queryParams = {};\r\n\r\n        // parse and add query params\r\n        if (parts[1]) {\r\n            queryParams = this.parseQueryParams(parts[1]);\r\n        }\r\n\r\n        // limit history length\r\n        if (this.history.length >= this.limit) {\r\n            this.history.splice(1, this.history.length - 1);\r\n        }\r\n\r\n        this.history.unshift({url: parts[0], queryParams});\r\n    }\r\n\r\n    /**\r\n     * Parse query params string into object.\r\n     */\r\n    private parseQueryParams(rawString: string): Object {\r\n        const params = new URLSearchParams(rawString), queryParams = {};\r\n\r\n        console.log(params);\r\n\r\n        return queryParams;\r\n    }\r\n\r\n    /**\r\n     * Initiate RouteHistory service.\r\n     */\r\n    public init() {\r\n        this.router.events\r\n            .pipe(filter(event => event instanceof NavigationEnd))\r\n            .subscribe((e: NavigationEnd) => {\r\n                this.addHistoryItem(e.urlAfterRedirects);\r\n            });\r\n    }\r\n}\r\n","import {Component, Injector, Input, OnDestroy, OnInit, ViewChild, ViewEncapsulation} from '@angular/core';\r\nimport {Conversation} from '../conversation.service';\r\nimport {Tag} from '../../shared/models/Tag';\r\nimport {Reply} from '../../shared/models/Reply';\r\nimport {TicketsService} from '../../ticketing/tickets.service';\r\nimport {MailboxTagsService} from '../../ticketing/mailbox-tags.service';\r\nimport {AddNoteModalComponent} from '../../ticketing/add-note-modal/add-note-modal.component';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {AssignTicketDropdownComponent} from '../../ticketing/assign-ticket-dropdown/assign-ticket-dropdown.component';\r\nimport {AddTagDropdownComponent} from '../../ticketing/add-tag-dropdown/add-tag-dropdown.component';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {BrowserEvents} from '@common/core/services/browser-events.service';\r\nimport {Modal} from '@common/core/ui/dialogs/modal.service';\r\nimport {MatMenuTrigger} from '@angular/material/menu';\r\nimport {RouterHistory} from '../../shared/router-history.service';\r\nimport {A, B, C, N, O, P, S, T} from '@angular/cdk/keycodes';\r\n\r\n@Component({\r\n    selector: 'conversation-toolbar',\r\n    templateUrl: './conversation-toolbar.component.html',\r\n    styleUrls: ['./conversation-toolbar.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationToolbarComponent implements OnInit, OnDestroy {\r\n    @ViewChild(AssignTicketDropdownComponent, { static: false }) assignTicketDropdown: AssignTicketDropdownComponent;\r\n    @ViewChild(AddTagDropdownComponent, { static: false }) addTagDropdown: AddTagDropdownComponent;\r\n    @ViewChild('ticketStatusMenuTrigger', { read: MatMenuTrigger, static: false }) ticketStatusTrigger: MatMenuTrigger;\r\n\r\n    @Input() hideBackButton = false;\r\n\r\n    private subscriptions = [];\r\n\r\n    constructor(\r\n        private router: Router,\r\n        public injector: Injector,\r\n        private modals: Modal,\r\n        private route: ActivatedRoute,\r\n        public currentUser: CurrentUser,\r\n        private tickets: TicketsService,\r\n        public conversation: Conversation,\r\n        private browserEvents: BrowserEvents,\r\n        public mailboxTags: MailboxTagsService,\r\n        private routerHistory: RouterHistory,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.initKeybinds();\r\n    }\r\n\r\n    public changeTicketStatus(status: Tag) {\r\n        if ( ! status) return;\r\n        this.tickets.changeTicketStatus(this.conversation.get().id, status.name).subscribe(() => {\r\n            this.conversation.performAfterReplyAction();\r\n            this.conversation.setStatus(status);\r\n        });\r\n    }\r\n\r\n    public showNoteModal() {\r\n        this.modals.open(\r\n            AddNoteModalComponent,\r\n            {ticketId: this.conversation.get().id},\r\n            {panelClass: 'add-note-modal-container'}\r\n        ).afterClosed().subscribe(note => {\r\n            if ( ! note) return;\r\n            this.addNewNote(note);\r\n        });\r\n    }\r\n\r\n    public addTag(tag: Tag) {\r\n        this.conversation.addTag(tag);\r\n        this.refreshMailboxTags();\r\n    }\r\n\r\n    public addNewNote(note: Reply) {\r\n        if ( ! note) return;\r\n        this.conversation.replies.add(note);\r\n    }\r\n\r\n    public navigateToTicketsList() {\r\n        if (this.routerHistory.getPrevious()) {\r\n            this.routerHistory.back();\r\n        } else {\r\n            this.router.navigate(['../../'], {relativeTo: this.route});\r\n        }\r\n    }\r\n\r\n    public refreshMailboxTags() {\r\n        this.mailboxTags.refresh();\r\n    }\r\n\r\n    private initKeybinds() {\r\n        const sub = this.browserEvents.globalKeyDown$.subscribe(e => {\r\n            let handled = true;\r\n\r\n            // if any modals are open or user is currently typing, bail\r\n            if (this.modals.anyDialogOpen() || BrowserEvents.userIsTyping() || e.ctrlKey) return;\r\n\r\n            switch (e.keyCode) {\r\n                // main toolbar actions\r\n                case B:\r\n                    this.closeAllMenus();\r\n                    this.navigateToTicketsList();\r\n                    break;\r\n                case A:\r\n                    this.assignTicketDropdown.open();\r\n                    break;\r\n                case N:\r\n                    this.closeAllMenus();\r\n                    this.showNoteModal();\r\n                    break;\r\n                case T:\r\n                    this.addTagDropdown.open();\r\n                    break;\r\n                case S:\r\n                    if (this.ticketStatusTrigger.menuOpen) {\r\n                        this.handleTicketStatusChangeKeybind('spam');\r\n                    } else {\r\n                        this.ticketStatusTrigger.openMenu();\r\n                    }\r\n                    break;\r\n\r\n                // change ticket status\r\n                case O:\r\n                    this.handleTicketStatusChangeKeybind('open');\r\n                    break;\r\n                case C:\r\n                    this.handleTicketStatusChangeKeybind('closed');\r\n                    break;\r\n                case P:\r\n                    this.handleTicketStatusChangeKeybind('pending');\r\n                    break;\r\n                default:\r\n                    handled = false;\r\n            }\r\n\r\n            if (handled) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n\r\n        this.subscriptions.push(sub);\r\n    }\r\n\r\n    private closeAllMenus() {\r\n        this.addTagDropdown.close();\r\n        this.assignTicketDropdown.close();\r\n        this.ticketStatusTrigger.closeMenu();\r\n    }\r\n\r\n    /**\r\n     * Change ticket status so specified one and close dropdown.\r\n     */\r\n    private handleTicketStatusChangeKeybind(status: string) {\r\n        if ( ! this.ticketStatusTrigger.menuOpen) return;\r\n        this.changeTicketStatus(this.mailboxTags.getTagByIdOrName(status));\r\n        this.ticketStatusTrigger.closeMenu();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.subscriptions.forEach(subscription => {\r\n            if (subscription) subscription.unsubscribe();\r\n        });\r\n    }\r\n}\r\n","<div class=\"left toolbar-actions\">\r\n    <ng-container *ngIf=\"currentUser.hasPermissions(['tickets.update', 'replies.create'])\">\r\n        <button class=\"no-style action back-button\" (click)=\"navigateToTicketsList()\" *ngIf=\"!hideBackButton\" [matTooltip]=\"'Back (b)' | trans\">\r\n            <mat-icon svgIcon=\"return-custom\"></mat-icon>\r\n        </button>\r\n\r\n        <assign-ticket-dropdown [ticket]=\"conversation.get()\" (assigned)=\"refreshMailboxTags()\" class=\"action\" [matTooltip]=\"'Assign (a)' | trans\"></assign-ticket-dropdown>\r\n\r\n        <button class=\"action no-style add-note-button\" (click)=\"showNoteModal()\" [matTooltip]=\"'Note (n)' | trans\">\r\n            <mat-icon svgIcon=\"note-custom\"></mat-icon>\r\n        </button>\r\n\r\n        <add-tag-dropdown class=\"action\" [ticketIds]=\"[conversation.get().id]\" (tagAdded)=\"addTag($event)\" [matTooltip]=\"'Tag (t)' | trans\"></add-tag-dropdown>\r\n\r\n        <button class=\"no-style change-ticket-status-button action\" [matMenuTriggerFor]=\"ticketStatusMenu\" [matTooltip]=\"'Status (s)' | trans\" #ticketStatusMenuTrigger>\r\n            <mat-icon svgIcon=\"flag-custom\"></mat-icon>\r\n        </button>\r\n        <mat-menu #ticketStatusMenu=\"matMenu\" [overlapTrigger]=\"false\" class=\"ticket-status-menu\">\r\n            <button mat-menu-item\r\n                    *ngFor=\"let tag of mailboxTags.getStatusTags(true)\"\r\n                    (click)=\"changeTicketStatus(tag)\"\r\n                    [class.active]=\"conversation.status?.name === tag.name\"\r\n                    [ngClass]=\"tag.name\">\r\n                {{tag.display_name || tag.name}}\r\n            </button>\r\n        </mat-menu>\r\n\r\n        <ng-content></ng-content>\r\n    </ng-container>\r\n</div>\r\n<div class=\"right ticket-info\">\r\n    <div class=\"ticket-number\">#{{conversation.get().id}}</div>\r\n    <div class=\"ticket-status\" [ngClass]=\"conversation.getStatus().name\">{{conversation.getStatus().display_name}}</div>\r\n</div>","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FormattedDatePipe} from '@common/core/ui/format-pipes/formatted-date.pipe';\nimport {FormattedFileSizePipe} from '@common/uploads/formatted-file-size.pipe';\n\n\n@NgModule({\n    declarations: [\n        FormattedDatePipe,\n        FormattedFileSizePipe,\n    ],\n    imports: [\n        CommonModule\n    ],\n    exports: [\n        FormattedDatePipe,\n        FormattedFileSizePipe,\n    ]\n})\nexport class FormatPipesModule {\n}\n","import {Component, Inject, ViewEncapsulation} from '@angular/core';\r\nimport {Reply} from '../../shared/models/Reply';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport {Settings} from '@common/core/config/settings.service';\r\n\r\ninterface ConfirmReplyDeleteModalComponentData  {\r\n    reply: Reply;\r\n}\r\n\r\n@Component({\r\n    selector: 'confirm-reply-delete-modal',\r\n    templateUrl: './confirm-reply-delete-modal.component.html',\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConfirmReplyDeleteModalComponent {\r\n    public type: string;\r\n\r\n    constructor(\r\n        private dialogRef: MatDialogRef<ConfirmReplyDeleteModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: ConfirmReplyDeleteModalComponentData,\r\n        public settings: Settings,\r\n    ) {\r\n        this.type = this.getDisplayType(data.reply.type);\r\n    }\r\n\r\n    public close(confirmed = false) {\r\n        this.dialogRef.close(confirmed);\r\n    }\r\n\r\n    public confirm() {\r\n        this.close(true);\r\n    }\r\n\r\n    private getDisplayType(type: string): string {\r\n        switch (type) {\r\n            case 'replies':\r\n                return 'reply';\r\n            case 'notes':\r\n                return 'note';\r\n            case 'drafts':\r\n                return 'draft';\r\n        }\r\n    }\r\n}\r\n","<div class=\"modal-header\" style=\"margin: 0\">\r\n    <h2 mat-dialog-title trans>Delete {{type}}</h2>\r\n    <button type=\"button\" mat-icon-button (click)=\"close()\" class=\"close-button\" tabindex=\"-1\">\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<mat-dialog-content>\r\n    <p>\r\n        <span trans>Are you sure you want to delete this</span>&ngsp;\r\n        <span>{{type | trans}}?</span>\r\n    </p>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions>\r\n    <button (click)=\"close()\" mat-button type=\"button\" class=\"cancel-button\" trans>Close</button>\r\n    <button type=\"submit\" mat-raised-button [color]=\"settings.get('vebto.auth.color')\" class=\"submit-button\" (click)=\"confirm()\" trans>Delete</button>\r\n</mat-dialog-actions>\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArray = (function () { return Array.isArray || (function (x) { return x && typeof x.length === 'number'; }); })();\n//# sourceMappingURL=isArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nexports.config = {\n    Promise: undefined,\n    set useDeprecatedSynchronousErrorHandling(value) {\n        if (value) {\n            var error = new Error();\n            console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n        }\n        else if (_enable_super_gross_mode_that_will_cause_bad_things) {\n            console.log('RxJS: Back to a better error behavior. Thank you. <3');\n        }\n        _enable_super_gross_mode_that_will_cause_bad_things = value;\n    },\n    get useDeprecatedSynchronousErrorHandling() {\n        return _enable_super_gross_mode_that_will_cause_bad_things;\n    },\n};\n//# sourceMappingURL=config.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar Subscription_1 = require(\"../Subscription\");\nfunction schedulePromise(input, scheduler) {\n    return new Observable_1.Observable(function (subscriber) {\n        var sub = new Subscription_1.Subscription();\n        sub.add(scheduler.schedule(function () { return input.then(function (value) {\n            sub.add(scheduler.schedule(function () {\n                subscriber.next(value);\n                sub.add(scheduler.schedule(function () { return subscriber.complete(); }));\n            }));\n        }, function (err) {\n            sub.add(scheduler.schedule(function () { return subscriber.error(err); }));\n        }); }));\n        return sub;\n    });\n}\nexports.schedulePromise = schedulePromise;\n//# sourceMappingURL=schedulePromise.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\nexports.isScheduler = isScheduler;\n//# sourceMappingURL=isScheduler.js.map","<ng-container *ngIf=\"previewFiles.getPortal() | async as portal\">\r\n    <ng-template [cdkPortalOutlet]=\"portal\" (attached)=\"listenForDownloadClick($event)\"></ng-template>\r\n</ng-container>\r\n","import {ChangeDetectionStrategy, Component, ComponentRef, Input, OnChanges, OnDestroy} from '@angular/core';\r\nimport {FileEntry} from '../../uploads/types/file-entry';\r\nimport {PreviewFilesService} from '../preview-files.service';\r\nimport {BaseFilePreview} from '../base-file-preview';\r\nimport {Subscription} from 'rxjs';\r\n\r\n@Component({\r\n    selector: 'preview-container',\r\n    templateUrl: './preview-container.component.html',\r\n    styleUrls: ['./preview-container.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class PreviewContainerComponent implements OnChanges, OnDestroy {\r\n    @Input() files: FileEntry[];\r\n    @Input() activeFile: number;\r\n    private downloadSub: Subscription;\r\n\r\n    constructor(public previewFiles: PreviewFilesService) {}\r\n\r\n    ngOnChanges(changes) {\r\n        this.previewFiles.set(this.files, this.activeFile);\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.previewFiles.destroy();\r\n        if (this.downloadSub) this.downloadSub.unsubscribe();\r\n    }\r\n\r\n    public listenForDownloadClick(comp: ComponentRef<BaseFilePreview>) {\r\n        if (this.downloadSub) this.downloadSub.unsubscribe();\r\n        this.downloadSub = comp.instance.download.subscribe(() => {\r\n            this.previewFiles.download.next();\r\n        });\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar observable_1 = require(\"../symbol/observable\");\nexports.subscribeToObservable = function (obj) { return function (subscriber) {\n    var obs = obj[observable_1.observable]();\n    if (typeof obs.subscribe !== 'function') {\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    }\n    else {\n        return obs.subscribe(subscriber);\n    }\n}; };\n//# sourceMappingURL=subscribeToObservable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rxSubscriber = (function () {\n    return typeof Symbol === 'function'\n        ? Symbol('rxSubscriber')\n        : '@@rxSubscriber_' + Math.random();\n})();\nexports.$$rxSubscriber = exports.rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map","import { Input, ElementRef, OnInit, OnDestroy, NgZone, Directive } from '@angular/core';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\n@Directive()\nexport abstract class InfiniteScroll implements OnInit, OnDestroy {\r\n    protected scrollSub: Subscription;\r\n    protected el: ElementRef<HTMLElement>;\r\n    protected abstract zone: NgZone;\r\n\r\n    @Input() threshold: number | string = 50;\r\n\r\n    ngOnInit() {\r\n        this.zone.runOutsideAngular(() => {\r\n            this.scrollSub = fromEvent(this.getScrollContainer(), 'scroll', {capture: true, passive: true})\r\n                .pipe(debounceTime(20))\r\n                .subscribe((e: Event) => this.onScroll(e.target as HTMLElement));\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.scrollSub && this.scrollSub.unsubscribe();\r\n    }\r\n\r\n    protected getScrollContainer() {\r\n        return this.el ? this.el.nativeElement : document;\r\n    }\r\n\r\n    protected onScroll(target: HTMLElement) {\r\n        if ( ! target || (this.el && target !== this.el.nativeElement) || ! this.canLoadMore() || this.isLoading()) return;\r\n\r\n        const offset = parseInt(this.threshold as string);\r\n\r\n        const currentScroll = this.el ?\r\n            target.scrollTop + target.offsetHeight :\r\n            window.scrollY + window.innerHeight;\r\n\r\n        const heightWithoutOffset = this.el ?\r\n            target.scrollHeight - offset :\r\n            document.documentElement.scrollHeight - offset;\r\n\r\n        if (currentScroll >= heightWithoutOffset) {\r\n            this.zone.run(() => {\r\n                this.loadMoreItems();\r\n            });\r\n        }\r\n    }\r\n\r\n    protected abstract loadMoreItems();\r\n    protected abstract canLoadMore(): boolean;\r\n    protected abstract isLoading(): boolean;\r\n}\r\n","import {Directive, ElementRef, NgZone} from '@angular/core';\r\nimport {InfiniteScroll} from '@common/core/ui/infinite-scroll/infinite.scroll';\r\nimport {Conversation} from '../conversation/conversation.service';\r\n\r\n@Directive({\r\n    selector: '[conversationInfiniteScroll]'\r\n})\r\nexport class ConversationInfiniteScrollDirective extends InfiniteScroll {\r\n    constructor(\r\n        protected el: ElementRef,\r\n        private conversation: Conversation,\r\n        protected zone: NgZone,\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    protected getScrollContainer() {\r\n        return document;\r\n    }\r\n\r\n    protected loadMoreItems() {\r\n        this.conversation.replies.loadMore();\r\n    }\r\n\r\n    protected isLoading(): boolean {\r\n        return this.conversation.replies.isLoading;\r\n    }\r\n\r\n    protected canLoadMore(): boolean {\r\n        return this.conversation.replies.canLoadMore();\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar iterator_1 = require(\"../symbol/iterator\");\nexports.subscribeToIterable = function (iterable) { return function (subscriber) {\n    var iterator = iterable[iterator_1.iterator]();\n    do {\n        var item = iterator.next();\n        if (item.done) {\n            subscriber.complete();\n            break;\n        }\n        subscriber.next(item.value);\n        if (subscriber.closed) {\n            break;\n        }\n    } while (true);\n    if (typeof iterator.return === 'function') {\n        subscriber.add(function () {\n            if (iterator.return) {\n                iterator.return();\n            }\n        });\n    }\n    return subscriber;\n}; };\n//# sourceMappingURL=subscribeToIterable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isFunction(x) {\n    return typeof x === 'function';\n}\nexports.isFunction = isFunction;\n//# sourceMappingURL=isFunction.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nfunction map(project, thisArg) {\n    return function mapOperation(source) {\n        if (typeof project !== 'function') {\n            throw new TypeError('argument is not a function. Are you looking for `mapTo()`?');\n        }\n        return source.lift(new MapOperator(project, thisArg));\n    };\n}\nexports.map = map;\nvar MapOperator = (function () {\n    function MapOperator(project, thisArg) {\n        this.project = project;\n        this.thisArg = thisArg;\n    }\n    MapOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new MapSubscriber(subscriber, this.project, this.thisArg));\n    };\n    return MapOperator;\n}());\nexports.MapOperator = MapOperator;\nvar MapSubscriber = (function (_super) {\n    __extends(MapSubscriber, _super);\n    function MapSubscriber(destination, project, thisArg) {\n        var _this = _super.call(this, destination) || this;\n        _this.project = project;\n        _this.count = 0;\n        _this.thisArg = thisArg || _this;\n        return _this;\n    }\n    MapSubscriber.prototype._next = function (value) {\n        var result;\n        try {\n            result = this.project.call(this.thisArg, value, this.count++);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return MapSubscriber;\n}(Subscriber_1.Subscriber));\n//# sourceMappingURL=map.js.map","import {Component, OnDestroy, OnInit, ViewChild, ViewEncapsulation} from '@angular/core';\r\nimport {Conversation} from '../conversation.service';\r\nimport {MailboxTagsService} from '../../ticketing/mailbox-tags.service';\r\nimport {ConfirmReplyDeleteModalComponent} from '../confirm-reply-delete-modal/confirm-reply-delete-modal.component';\r\nimport {TextEditorComponent} from '@common/text-editor/text-editor.component';\r\nimport {Subscription} from 'rxjs';\r\nimport {CurrentUser} from '@common/auth/current-user';\r\nimport {BrowserEvents} from '@common/core/services/browser-events.service';\r\nimport {Modal} from '@common/core/ui/dialogs/modal.service';\r\nimport {CannedReply} from '../../shared/models/CannedReply';\r\nimport {DraftPayload} from '../../ticketing/tickets.service';\r\nimport {Article} from '../../shared/models/Article';\r\nimport {HcUrls} from '../../help-center/shared/hc-urls.service';\r\nimport {Settings} from '@common/core/config/settings.service';\r\nimport {SuggestedArticlesDropdownComponent} from '../../help-center/suggested-articles-dropdown/suggested-articles-dropdown.component';\r\nimport {R, SLASH} from '@angular/cdk/keycodes';\r\nimport {Tag} from '../../shared/models/Tag';\r\nimport {TinymceTextEditor} from '@common/text-editor/editors/tinymce-text-editor.service';\r\n\r\n@Component({\r\n    selector: 'conversation-text-editor',\r\n    templateUrl: './conversation-text-editor.component.html',\r\n    styleUrls: ['./conversation-text-editor.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ConversationTextEditorComponent implements OnInit, OnDestroy {\r\n    @ViewChild('textEditor', { static: true }) textEditor: TextEditorComponent;\r\n    @ViewChild(SuggestedArticlesDropdownComponent, { static: false }) articleDropdown: SuggestedArticlesDropdownComponent;\r\n\r\n    public selectedStatus = new Tag();\r\n    private subscriptions: Subscription[] = [];\r\n\r\n    constructor(\r\n        private modal: Modal,\r\n        public currentUser: CurrentUser,\r\n        public conversation: Conversation,\r\n        private browserEvents: BrowserEvents,\r\n        public mailboxTags: MailboxTagsService,\r\n        private hcUrls: HcUrls,\r\n        private settings: Settings,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.setSelectedStatus();\r\n        this.initKeybinds();\r\n        this.conversation.setEditor(this.textEditor);\r\n    }\r\n\r\n    public submitReply() {\r\n        const payload = {body: this.textEditor.getContents(), status: this.selectedStatus};\r\n        this.conversation.submitReply(payload).subscribe(() => {\r\n            this.closeEditor();\r\n        }, () => {});\r\n    }\r\n\r\n    public saveDraft(params: DraftPayload = {}) {\r\n        return this.conversation.draft.save(params);\r\n    }\r\n\r\n    public closeEditor() {\r\n        this.conversation.closeEditor();\r\n        this.conversation.draft.reset();\r\n        this.textEditor.reset();\r\n    }\r\n\r\n    public saveDraftAndAddToReplies() {\r\n        if ( ! this.conversation.draft.isEmpty()) {\r\n            this.saveDraft().subscribe(response => {\r\n                this.conversation.replies.add(response.data);\r\n                this.closeEditor();\r\n            });\r\n        } else {\r\n            this.closeEditor();\r\n        }\r\n    }\r\n\r\n    public maybeDeleteDraft() {\r\n        // TODO: refactor to use async/wait and remove duplicated stuff\r\n        const draft = this.conversation.draft.get();\r\n\r\n        if (draft.id) {\r\n            this.modal.show(ConfirmReplyDeleteModalComponent, {reply: draft}).afterClosed()\r\n                .subscribe(confirmed => {\r\n                    if ( ! confirmed) return;\r\n                    this.conversation.draft.delete();\r\n                    this.closeEditor();\r\n                });\r\n        } else {\r\n            this.closeEditor();\r\n        }\r\n    }\r\n\r\n    public applyCannedReply(reply: CannedReply) {\r\n        this.textEditor.insertContents(reply.body);\r\n        setTimeout(() => {\r\n            this.saveDraft({uploads: reply.uploads.map(upload => upload.id)});\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set the status that should be applied to ticket after submitting reply.\r\n     */\r\n    private setSelectedStatus() {\r\n        let tag: Tag;\r\n\r\n        // if current user is customer open ticket when they reply,\r\n        // otherwise set default tag to \"closed\"\r\n        if ( ! this.currentUser.hasPermission('tickets.update')) {\r\n            tag = this.mailboxTags.getTagByIdOrName('open');\r\n        } else {\r\n            tag = this.mailboxTags.getTagByIdOrName('closed');\r\n        }\r\n\r\n        this.selectedStatus = tag;\r\n    }\r\n\r\n    /**\r\n     * Init keybinds for conversation text editor.\r\n     */\r\n    private initKeybinds() {\r\n        const sub = this.browserEvents.globalKeyDown$.subscribe(e => {\r\n\r\n            // if any modals are open or user is currently typing, bail\r\n            if (this.modal.anyDialogOpen() || BrowserEvents.userIsTyping()) return;\r\n\r\n            // open text editor\r\n            if (e.keyCode === R) {\r\n                this.conversation.openEditor();\r\n            }\r\n\r\n            if (e.keyCode === SLASH && e.ctrlKey) {\r\n                this.articleDropdown.focus();\r\n            }\r\n        });\r\n        this.subscriptions.push(sub);\r\n\r\n        (this.textEditor.editor as TinymceTextEditor).waitForEditor().then((editor: any) => {\r\n            editor.shortcuts.add('ctrl+191', 'Search docs', () => {\r\n                this.articleDropdown.focus();\r\n            });\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.saveDraft();\r\n        this.closeEditor();\r\n\r\n        this.subscriptions.forEach(subscription => {\r\n            subscription && subscription.unsubscribe();\r\n        });\r\n    }\r\n\r\n    public insertArticleLink(article: Article) {\r\n        const uri = this.hcUrls.article(article).join('/');\r\n        this.textEditor.insertLink({\r\n            target: 'blank',\r\n            href: this.settings.getBaseUrl() + uri,\r\n            text: article.title\r\n        });\r\n    }\r\n}\r\n","<section class=\"text-editor-container\" [class.hidden]=\"!conversation.isEditorOpen()\">\r\n    <suggested-articles-dropdown placeholder=\"Search docs... (ctrl + /)\" (articleSelected)=\"insertArticleLink($event)\" [category]=\"conversation.getCategory()\" *ngIf=\"currentUser.hasPermission('tickets.update')\"></suggested-articles-dropdown>\r\n    <reply-attachment-list [attachments]=\"conversation.draft.get().uploads\" (detached)=\"conversation.draft.detachUpload($event)\"></reply-attachment-list>\r\n    <upload-progress-bar></upload-progress-bar>\r\n    <text-editor inlineUploadPrefix=\"ticket_images\" (onChange)=\"conversation.draft.setBody($event)\" (onFileUpload)=\"conversation.draft.uploadFiles($event)\" (onCtrlEnter)=\"submitReply()\" #textEditor>\r\n\r\n        <div class=\"header-actions\" customButtons *ngIf=\"currentUser.hasPermission('canned_replies.view')\">\r\n            <canned-replies-dropdown (onReplySelect)=\"applyCannedReply($event)\"></canned-replies-dropdown>\r\n        </div>\r\n\r\n        <div class=\"header-actions last right\" header>\r\n            <button type=\"button\" class=\"no-style editor-button save-draft-button\" [class.success]=\"conversation.draft.get().id\" (click)=\"saveDraftAndAddToReplies()\" [matTooltip]=\"'Save Draft' | trans\">\r\n                <mat-icon svgIcon=\"check-circle\"></mat-icon>\r\n            </button>\r\n            <button type=\"button\" class=\"no-style editor-button delete-draft-button\" (click)=\"maybeDeleteDraft()\" [matTooltip]=\"'Discard (Esc)' | trans\"><mat-icon svgIcon=\"delete\"></mat-icon></button>\r\n        </div>\r\n\r\n        <div class=\"editor-footer\" footer>\r\n            <div class=\"right\">\r\n                <ng-container *ngIf=\"currentUser.hasPermission('tickets.update')\">\r\n                    <button type=\"button\" class=\"change-status-button\" mat-button [matMenuTriggerFor]=\"statusMenu\">\r\n                        <span>{{selectedStatus.display_name | trans}}</span>\r\n                        <mat-icon svgIcon=\"keyboard-arrow-down\" class=\"dropdown-icon\"></mat-icon>\r\n                    </button>\r\n\r\n                    <mat-menu #statusMenu=\"matMenu\" [overlapTrigger]=\"false\" class=\"status-menu\">\r\n                        <button mat-menu-item [ngClass]=\"tag.name\" *ngFor=\"let tag of mailboxTags.getStatusTags(true)\" (click)=\"selectedStatus = tag\" trans>{{tag.display_name}}</button>\r\n                    </mat-menu>\r\n                </ng-container>\r\n\r\n                <button type=\"button\" mat-flat-button color=\"accent\" class=\"submit-button\" (click)=\"submitReply()\" [disabled]=\"conversation.replySaving\">\r\n                    <span *ngIf=\"!conversation.replySaving\" trans>Send Reply</span>\r\n                    <span *ngIf=\"conversation.replySaving\" trans>Sending...</span>\r\n                </button>\r\n\r\n                <ng-container *ngIf=\"currentUser.hasPermission('settings.update')\">\r\n                    <button mat-flat-button color=\"accent\" class=\"dropdown-left submit-button-addon\" [disabled]=\"conversation.replySaving\" [matMenuTriggerFor]=\"defaultRedirectMenu\">\r\n                        <mat-icon svgIcon=\"arrow-drop-down\" class=\"caret align-middle\"></mat-icon>\r\n                    </button>\r\n\r\n                    <mat-menu #defaultRedirectMenu=\"matMenu\" class=\"default-redirect-menu\" [overlapTrigger]=\"false\">\r\n                        <button mat-menu-item class=\"stay-on-page\" [class.selected]=\"conversation.afterReplyAction.get() === 'stay_on_page'\" (click)=\"conversation.afterReplyAction.set('stay_on_page')\" trans>Send and stay on page</button>\r\n                        <button mat-menu-item class=\"next-active-ticket\" [class.selected]=\"conversation.afterReplyAction.get() === 'next_active_ticket'\" (click)=\"conversation.afterReplyAction.set('next_active_ticket')\" trans>Send and next ticket</button>\r\n                        <button mat-menu-item class=\"back_to_folder\" [class.selected]=\"conversation.afterReplyAction.get() === 'back_to_folder'\" (click)=\"conversation.afterReplyAction.set('back_to_folder')\" trans>Send and back to folder</button>\r\n                    </mat-menu>\r\n                </ng-container>\r\n\r\n            </div>\r\n        </div>\r\n    </text-editor>\r\n</section>\r\n","import {Component, ViewChild, OnInit, ViewEncapsulation, Inject} from '@angular/core';\r\nimport {TicketsService} from '../tickets.service';\r\nimport {Conversation} from '../../conversation/conversation.service';\r\nimport {TextEditorComponent} from '@common/text-editor/text-editor.component';\r\nimport {UploadsApiService} from '@common/uploads/uploads-api.service';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport {Reply} from '../../shared/models/Reply';\r\nimport {UploadedFile} from '@common/uploads/uploaded-file';\r\nimport {UploadQueueService} from '@common/uploads/upload-queue/upload-queue.service';\r\nimport {FileEntry} from '@common/uploads/types/file-entry';\r\nimport {finalize} from 'rxjs/operators';\r\n\r\ninterface AddNoteModalData {\r\n    ticketId: number;\r\n}\r\n\r\ninterface AddNoteModalErrors {\r\n    body?: string;\r\n    attachments?: string;\r\n    file?: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'add-note-modal',\r\n    templateUrl: './add-note-modal.component.html',\r\n    styleUrls: ['./add-note-modal.component.scss'],\r\n    providers: [Conversation, UploadQueueService],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class AddNoteModalComponent implements OnInit {\r\n    @ViewChild('textEditor', { static: true }) textEditor: TextEditorComponent;\r\n\r\n    public errors: AddNoteModalErrors = {};\r\n    public attachments: FileEntry[] = [];\r\n    public loading = false;\r\n\r\n    constructor(\r\n        private dialogRef: MatDialogRef<AddNoteModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: AddNoteModalData,\r\n        private ticketService: TicketsService,\r\n        private uploads: UploadsApiService,\r\n        private uploadQueue: UploadQueueService,\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.textEditor.focus();\r\n    }\r\n\r\n    public close(note?: Reply) {\r\n        this.textEditor.destroyEditor();\r\n        this.dialogRef.close(note);\r\n    }\r\n\r\n    public confirm() {\r\n        this.loading = true;\r\n        const payload = {\r\n            body: this.textEditor.getContents(),\r\n            uploads: this.attachments.map(attachment => attachment.id)\r\n        };\r\n        this.ticketService.addNote(this.data.ticketId, payload)\r\n            .pipe(finalize(() => this.loading = false))\r\n            .subscribe(response => {\r\n                this.close(response.data);\r\n            }, errorResponse => this.errors = errorResponse.messages);\r\n    }\r\n\r\n    public uploadFiles(files: UploadedFile[]) {\r\n        this.uploadQueue.start(files).subscribe(response => {\r\n            this.attachments = [...this.attachments, response.fileEntry];\r\n        });\r\n    }\r\n\r\n    public removeAttachment(entry: FileEntry) {\r\n        for (let i = 0; i < this.attachments.length; i++) {\r\n            if (this.attachments[i].id === entry.id) {\r\n                this.attachments.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","<div class=\"modal-header\">\r\n    <h2 mat-dialog-title trans>Add Note</h2>\r\n    <button type=\"button\" mat-icon-button (click)=\"close()\" class=\"close-button\" tabindex=\"-1\">\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<form ngNativeValidate (ngSubmit)=\"confirm()\">\r\n    <mat-dialog-content class=\"many-inputs\">\r\n        <div class=\"input-container\">\r\n            <text-editor inlineUploadPrefix=\"ticket_images\" class=\"text-editor\" [minHeight]=\"300\" (onFileUpload)=\"uploadFiles($event)\" #textEditor></text-editor>\r\n            <upload-progress-bar></upload-progress-bar>\r\n\r\n            <div class=\"error\" *ngIf=\"errors.body\">{{errors.body}}</div>\r\n            <div class=\"error\" *ngIf=\"errors.file\">{{errors.file}}</div>\r\n            <div class=\"error\" *ngIf=\"errors.attachments\">{{errors.attachments}}</div>\r\n\r\n            <reply-attachment-list [attachments]=\"attachments\" *ngIf=\"attachments.length\" (detached)=\"removeAttachment($event)\"></reply-attachment-list>\r\n        </div>\r\n    </mat-dialog-content>\r\n\r\n    <mat-dialog-actions>\r\n        <button (click)=\"close()\" type=\"button\" mat-button class=\"cancel-button\" trans>Cancel</button>\r\n        <button type=\"submit\" mat-raised-button color=\"accent\" class=\"submit-button\" [disabled]=\"loading\" trans>Add Note</button>\r\n    </mat-dialog-actions>\r\n</form>\r\n","import { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nexport const defaultThrottleConfig = {\n    leading: true,\n    trailing: false\n};\nexport function throttle(durationSelector, config = defaultThrottleConfig) {\n    return (source) => source.lift(new ThrottleOperator(durationSelector, config.leading, config.trailing));\n}\nclass ThrottleOperator {\n    constructor(durationSelector, leading, trailing) {\n        this.durationSelector = durationSelector;\n        this.leading = leading;\n        this.trailing = trailing;\n    }\n    call(subscriber, source) {\n        return source.subscribe(new ThrottleSubscriber(subscriber, this.durationSelector, this.leading, this.trailing));\n    }\n}\nclass ThrottleSubscriber extends OuterSubscriber {\n    constructor(destination, durationSelector, _leading, _trailing) {\n        super(destination);\n        this.destination = destination;\n        this.durationSelector = durationSelector;\n        this._leading = _leading;\n        this._trailing = _trailing;\n        this._hasValue = false;\n    }\n    _next(value) {\n        this._hasValue = true;\n        this._sendValue = value;\n        if (!this._throttled) {\n            if (this._leading) {\n                this.send();\n            }\n            else {\n                this.throttle(value);\n            }\n        }\n    }\n    send() {\n        const { _hasValue, _sendValue } = this;\n        if (_hasValue) {\n            this.destination.next(_sendValue);\n            this.throttle(_sendValue);\n        }\n        this._hasValue = false;\n        this._sendValue = null;\n    }\n    throttle(value) {\n        const duration = this.tryDurationSelector(value);\n        if (!!duration) {\n            this.add(this._throttled = subscribeToResult(this, duration));\n        }\n    }\n    tryDurationSelector(value) {\n        try {\n            return this.durationSelector(value);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return null;\n        }\n    }\n    throttlingDone() {\n        const { _throttled, _trailing } = this;\n        if (_throttled) {\n            _throttled.unsubscribe();\n        }\n        this._throttled = null;\n        if (_trailing) {\n            this.send();\n        }\n    }\n    notifyNext(outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.throttlingDone();\n    }\n    notifyComplete() {\n        this.throttlingDone();\n    }\n}\n//# sourceMappingURL=throttle.js.map","import { Subscriber } from '../Subscriber';\nimport { async } from '../scheduler/async';\nimport { defaultThrottleConfig } from './throttle';\nexport function throttleTime(duration, scheduler = async, config = defaultThrottleConfig) {\n    return (source) => source.lift(new ThrottleTimeOperator(duration, scheduler, config.leading, config.trailing));\n}\nclass ThrottleTimeOperator {\n    constructor(duration, scheduler, leading, trailing) {\n        this.duration = duration;\n        this.scheduler = scheduler;\n        this.leading = leading;\n        this.trailing = trailing;\n    }\n    call(subscriber, source) {\n        return source.subscribe(new ThrottleTimeSubscriber(subscriber, this.duration, this.scheduler, this.leading, this.trailing));\n    }\n}\nclass ThrottleTimeSubscriber extends Subscriber {\n    constructor(destination, duration, scheduler, leading, trailing) {\n        super(destination);\n        this.duration = duration;\n        this.scheduler = scheduler;\n        this.leading = leading;\n        this.trailing = trailing;\n        this._hasTrailingValue = false;\n        this._trailingValue = null;\n    }\n    _next(value) {\n        if (this.throttled) {\n            if (this.trailing) {\n                this._trailingValue = value;\n                this._hasTrailingValue = true;\n            }\n        }\n        else {\n            this.add(this.throttled = this.scheduler.schedule(dispatchNext, this.duration, { subscriber: this }));\n            if (this.leading) {\n                this.destination.next(value);\n            }\n            else if (this.trailing) {\n                this._trailingValue = value;\n                this._hasTrailingValue = true;\n            }\n        }\n    }\n    _complete() {\n        if (this._hasTrailingValue) {\n            this.destination.next(this._trailingValue);\n            this.destination.complete();\n        }\n        else {\n            this.destination.complete();\n        }\n    }\n    clearThrottle() {\n        const throttled = this.throttled;\n        if (throttled) {\n            if (this.trailing && this._hasTrailingValue) {\n                this.destination.next(this._trailingValue);\n                this._trailingValue = null;\n                this._hasTrailingValue = false;\n            }\n            throttled.unsubscribe();\n            this.remove(throttled);\n            this.throttled = null;\n        }\n    }\n}\nfunction dispatchNext(arg) {\n    const { subscriber } = arg;\n    subscriber.clearThrottle();\n}\n//# sourceMappingURL=throttleTime.js.map","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, HostBinding, OnDestroy } from '@angular/core';\r\nimport { UploadQueueService } from '../upload-queue/upload-queue.service';\r\nimport { animationFrameScheduler, Subscription } from 'rxjs';\r\nimport { throttleTime } from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'upload-progress-bar',\r\n    templateUrl: './upload-progress-bar.component.html',\r\n    styleUrls: ['./upload-progress-bar.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class UploadProgressBarComponent implements OnDestroy {\r\n    @HostBinding('class.hidden') hidden = true;\r\n    private subscription: Subscription;\r\n    public progress: number;\r\n\r\n    constructor(\r\n        private el: ElementRef,\r\n        public uploadQueue: UploadQueueService,\r\n        private cd: ChangeDetectorRef,\r\n    ) {\r\n        this.subscription = this.uploadQueue.totalProgress()\r\n            // material progress bar animation lasts 250ms\r\n            .pipe(throttleTime(260, animationFrameScheduler, {leading: true, trailing: true}))\r\n            .subscribe(progress => {\r\n                this.progress = progress;\r\n                this.hidden = progress === 100 || this.uploadQueue.count$.value.pending === 0;\r\n                this.cd.markForCheck();\r\n            });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.subscription.unsubscribe();\r\n    }\r\n}\r\n\r\n","<mat-progress-bar mode=\"determinate\" [value]=\"progress\" color=\"accent\"></mat-progress-bar>\r\n","import {User} from './User';\r\nimport {Tag} from './Tag';\r\nimport {Reply} from './Reply';\r\n\r\nexport const AGENT_PERMISSION = 'tickets.update';\r\n\r\nexport class Ticket {\r\n    id: number;\r\n    subject: string;\r\n    user_id: number;\r\n    closed_at?: string;\r\n    closed_by?: number;\r\n    assigned_to?: number;\r\n    created_at?: string;\r\n    updated_at?: string;\r\n    updated_at_formatted: string;\r\n    user?: User;\r\n    tags?: Tag[];\r\n    categories?: Tag[];\r\n    replies?: Reply[];\r\n    replies_count?: Reply;\r\n    latest_replies?: Reply[];\r\n    latest_reply?: Reply;\r\n    notes?: Reply[];\r\n\r\n    constructor(params: Object = {}) {\r\n        for (const name in params) {\r\n            this[name] = params[name];\r\n        }\r\n    }\r\n}\r\n","/**\r\n * Download file from specified url.\r\n */\r\nexport function downloadFileFromUrl(url: string, name?: string) {\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    if (name) link.download = name;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n}\r\n","<default-preview *ngIf=\"fileTooLarge$ | async; else textPreview\" message=\"This file is too large to preview.\"></default-preview>\r\n<ng-template #textPreview>\r\n    <div class=\"text-wrapper preview-object\">\r\n        <pre>{{ content$ | async }}</pre>\r\n    </div>\r\n</ng-template>","import {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\r\nimport {BehaviorSubject} from 'rxjs';\r\nimport {BaseFilePreview} from '../base-file-preview';\r\n\r\nconst FIVE_MB = 5242880;\r\n\r\n@Component({\r\n    selector: 'text-preview',\r\n    templateUrl: './text-preview.component.html',\r\n    styleUrls: ['./text-preview.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class TextPreviewComponent extends BaseFilePreview implements OnInit {\r\n    public content$ = new BehaviorSubject('');\r\n    public fileTooLarge$ = new BehaviorSubject(false);\r\n\r\n    ngOnInit() {\r\n        if (this.file.file_size > FIVE_MB) {\r\n            this.fileTooLarge$.next(true);\r\n        } else {\r\n            this.loadFileContents();\r\n        }\r\n    }\r\n\r\n    private loadFileContents() {\r\n        this.getContents()\r\n            .subscribe(content => {\r\n                this.content$.next(content);\r\n            });\r\n    }\r\n}\r\n","<audio #playerEl controls=\"controls\" class=\"preview-object\" [class.hidden]=\"invalidMedia\" controlsList=\"nodownload noremoteplayback\"></audio>\r\n\r\n<default-preview *ngIf=\"invalidMedia\"></default-preview>","import {ChangeDetectionStrategy, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\r\nimport {BaseFilePreview} from '../base-file-preview';\r\n\r\n@Component({\r\n    selector: 'audio-preview',\r\n    templateUrl: './audio-preview.component.html',\r\n    styleUrls: ['./audio-preview.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AudioPreviewComponent extends BaseFilePreview implements OnInit {\r\n    @ViewChild('playerEl', { static: true }) playerEl: ElementRef;\r\n    public invalidMedia = false;\r\n\r\n    ngOnInit() {\r\n        this.invalidMedia = !this.canPlayVideo();\r\n\r\n        if ( ! this.invalidMedia) {\r\n            this.player().src = this.getSrc();\r\n            this.player().play();\r\n        }\r\n    }\r\n\r\n    protected canPlayVideo(): boolean {\r\n        return !!this.player().canPlayType(this.file.mime);\r\n    }\r\n\r\n    protected player() {\r\n        return this.playerEl.nativeElement as HTMLVideoElement|HTMLAudioElement;\r\n    }\r\n}\r\n","<video #playerEl controls=\"controls\" class=\"preview-object\" [class.hidden]=\"invalidMedia\" controlsList=\"nodownload noremoteplayback\"></video>\r\n\r\n<default-preview *ngIf=\"invalidMedia\"></default-preview>","import {ChangeDetectionStrategy, Component} from '@angular/core';\r\nimport {AudioPreviewComponent} from '../audio-preview/audio-preview.component';\r\n\r\n@Component({\r\n    selector: 'video-preview',\r\n    templateUrl: './video-preview.component.html',\r\n    styleUrls: ['./video-preview.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class VideoPreviewComponent extends AudioPreviewComponent {\r\n}\r\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\r\nimport {BaseFilePreview} from '../base-file-preview';\r\n\r\n@Component({\r\n    selector: 'image-preview',\r\n    templateUrl: './image-preview.component.html',\r\n    styleUrls: ['./image-preview.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ImagePreviewComponent extends BaseFilePreview {}\r\n","import {ChangeDetectionStrategy, Component, HostBinding,} from '@angular/core';\r\nimport {BaseFilePreview} from '../base-file-preview';\r\n\r\n@Component({\r\n  selector: 'pdf-preview',\r\n  templateUrl: './pdf-preview.component.html',\r\n  styleUrls: ['./pdf-preview.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class PdfPreviewComponent extends BaseFilePreview {\r\n    @HostBinding('class') className = 'preview-object';\r\n\r\n    public getSrc() {\r\n        return super.getSrc() + '#toolbar=0';\r\n    }\r\n}\r\n","<img [src]=\"getSafeSrc()\" class=\"preview-object\">","<iframe [src]=\"getSafeSrc()\"></iframe>","<ng-container *ngIf=\"!(showDefaultPreview$ | async); else defaultPreview\">\r\n    <iframe class=\"preview-object\" #iframe></iframe>\r\n    <div class=\"pop-out-block\" (click)=\"openInNewWindow()\"></div>\r\n</ng-container>\r\n<ng-template #defaultPreview>\r\n    <default-preview></default-preview>\r\n</ng-template>\r\n<loading-indicator [isVisible]=\"loading$ | async\" class=\"overlay\"></loading-indicator>","import { AfterViewInit, ChangeDetectionStrategy, Component, ElementRef, ViewChild } from '@angular/core';\nimport { BaseFilePreview } from '../base-file-preview';\nimport { BehaviorSubject } from 'rxjs';\nimport { GenericBackendResponse } from '@common/core/types/backend-response';\nimport { isAbsoluteUrl } from '@common/core/utils/is-absolute-url';\n\n@Component({\n    selector: 'google-docs-viewer',\n    templateUrl: './google-docs-viewer.component.html',\n    styleUrls: ['./google-docs-viewer.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GoogleDocsViewerComponent extends BaseFilePreview implements AfterViewInit {\n    @ViewChild('iframe') iframe: ElementRef<HTMLIFrameElement>;\n    public loading$ = new BehaviorSubject(true);\n    public showDefaultPreview$ = new BehaviorSubject(false);\n    private timeoutRef: number;\n\n    ngAfterViewInit() {\n        // google docs viewer only supports file up to 25MB\n        if (this.file.file_size > 25000000) {\n            return this.showDefaultPreview();\n        }\n\n        this.iframe.nativeElement.onload = () => {\n            clearTimeout(this.timeoutRef);\n            this.stopLoading();\n        };\n\n        this.getIframeSrc().then(url => {\n            this.iframe.nativeElement.src = url;\n        }).catch(() => {\n            this.showDefaultPreview();\n        });\n\n        // if google docs preview iframe is not loaded\n        // after 6 seconds, bail and show default preview\n        this.timeoutRef = setTimeout(() => {\n            this.showDefaultPreview();\n        }, 5000);\n    }\n\n    public stopLoading() {\n        this.loading$.next(false);\n    }\n\n    public showDefaultPreview() {\n        this.stopLoading();\n        this.showDefaultPreview$.next(true);\n    }\n\n    public openInNewWindow() {\n        window.open(window.location.href, '_blank');\n    }\n\n    private getIframeSrc(): Promise<string> {\n        return new Promise((resolve, reject) => {\n            let previewUrl = this.getSrc();\n\n            // if we're not trying to preview shareable link we will need to generate\n            // preview token, otherwise google won't be able to access this file\n            if (previewUrl.indexOf('shareable_link') === -1) {\n                this.http.post<GenericBackendResponse<{preview_token: string}>>(`uploads/${this.file.id}/add-preview-token`).subscribe(response => {\n                    previewUrl += `?preview_token=${response.preview_token}`;\n                    resolve(this.getGoogleDocsUrl(previewUrl));\n                }, () => reject);\n            } else {\n                resolve(this.getGoogleDocsUrl(previewUrl));\n            }\n        });\n    }\n\n    private getGoogleDocsUrl(previewUrl: string) {\n        previewUrl = isAbsoluteUrl(previewUrl) ? previewUrl : this.settings.getBaseUrl() + previewUrl;\n        return 'https://docs.google.com/gview?embedded=true&url=' + encodeURIComponent(previewUrl);\n    }\n}\n","import { InjectionToken, Injectable } from '@angular/core';\r\nimport { TextPreviewComponent } from './text-preview/text-preview.component';\r\nimport { VideoPreviewComponent } from './video-preview/video-preview.component';\r\nimport { ImagePreviewComponent } from './image-preview/image-preview.component';\r\nimport { PdfPreviewComponent } from './pdf-preview/pdf-preview.component';\r\nimport { AudioPreviewComponent } from './audio-preview/audio-preview.component';\r\nimport { GoogleDocsViewerComponent } from './google-docs-viewer/google-docs-viewer.component';\r\n\r\nexport const AVAILABLE_PREVIEWS = new InjectionToken<any>('AVAILABLE_PREVIEWS');\r\n\r\n@Injectable()\nexport class DefaultPreviews {\r\n    text = TextPreviewComponent;\r\n    video = VideoPreviewComponent;\r\n    audio = AudioPreviewComponent;\r\n    image = ImagePreviewComponent;\r\n    pdf = PdfPreviewComponent;\r\n    spreadsheet = GoogleDocsViewerComponent;\r\n    powerPoint = GoogleDocsViewerComponent;\r\n    word = GoogleDocsViewerComponent;\r\n}\r\n\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction noop() { }\nexports.noop = noop;\n//# sourceMappingURL=noop.js.map","import {EventEmitter, Injectable} from '@angular/core';\r\nimport {Draft} from './draft.service';\r\nimport {Ticket} from '../shared/models/Ticket';\r\nimport {ConversationReplies} from './conversation-replies.service';\r\nimport {Tag} from '../shared/models/Tag';\r\nimport {TicketsService} from '../ticketing/tickets.service';\r\nimport {AfterReplyAction} from './after-reply-action.service';\r\nimport {Reply} from '../shared/models/Reply';\r\nimport {TextEditorComponent} from '@common/text-editor/text-editor.component';\r\nimport {Toast} from '@common/core/ui/toast.service';\r\nimport {tap} from 'rxjs/operators';\r\nimport {Category} from '../shared/models/Category';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class Conversation {\r\n\r\n    /**\r\n     * Whether conversation is loading currently.\r\n     */\r\n    public isLoading = false;\r\n\r\n    /**\r\n     * Ticket this conversation was created for.\r\n     */\r\n    private model = new Ticket({tags: []});\r\n\r\n    /**\r\n     * Current status of the ticket (on the server).\r\n     */\r\n    public status = new Tag();\r\n\r\n    /**\r\n     * Whether conversation reply is being saved currently.\r\n     */\r\n    public replySaving = false;\r\n\r\n    /**\r\n     * Whether text editor is currently open.\r\n     */\r\n    private editorIsOpen = false;\r\n\r\n    /**\r\n     * Instance of text editor for this conversation.\r\n     */\r\n    private editor: TextEditorComponent;\r\n\r\n    /**\r\n     * Fired after conversation is initiated or reloaded.\r\n     */\r\n    public afterInit = new EventEmitter();\r\n\r\n    /**\r\n     * Conversation service constructor.\r\n     */\r\n    constructor(\r\n        public draft: Draft,\r\n        private toast: Toast,\r\n        private tickets: TicketsService,\r\n        public replies: ConversationReplies,\r\n        public afterReplyAction: AfterReplyAction,\r\n    ) {}\r\n\r\n    public get(): Ticket {\r\n        return this.model;\r\n    }\r\n\r\n    public getStatus() {\r\n        return this.status || new Tag();\r\n    }\r\n\r\n    public getCategory(): Category  {\r\n        const tag = this.model.tags\r\n            .find(t => t.type !== 'status');\r\n        return (tag && tag.categories) ? tag.categories[0] : null;\r\n    }\r\n\r\n    /**\r\n     * Set conversation status.\r\n     */\r\n    public setStatus(tag?: Tag) {\r\n        if ( ! tag) return;\r\n        this.status = tag;\r\n    }\r\n\r\n    /**\r\n     * Open conversation text editor.\r\n     */\r\n    public openEditor() {\r\n        this.editorIsOpen = true;\r\n        this.editor && this.editor.focus();\r\n    }\r\n\r\n    /**\r\n     * Close conversation text editor.\r\n     */\r\n    public closeEditor() {\r\n        this.editorIsOpen = false;\r\n    }\r\n\r\n    /**\r\n     * Check if conversation text editor is open.\r\n     */\r\n    public isEditorOpen() {\r\n        return this.editorIsOpen;\r\n    }\r\n\r\n    /**\r\n     * Set text editor instance on conversation.\r\n     */\r\n    public setEditor(editor: TextEditorComponent) {\r\n        this.editor = editor;\r\n    }\r\n\r\n    /**\r\n     * Set specified draft as active.\r\n     */\r\n    public setDraft(draft: Reply) {\r\n        this.draft.set(draft);\r\n        this.editor.setContents(draft.body);\r\n    }\r\n\r\n    /**\r\n     * Add specified tag to currently active ticket.\r\n     */\r\n    public addTag(newTag: Tag) {\r\n        const exists = this.model.tags.find(tag => newTag.name === tag.name);\r\n        if ( ! exists) this.model.tags.unshift(newTag);\r\n    }\r\n\r\n    /**\r\n     * Submit a reply for current conversation.\r\n     */\r\n    public submitReply(params: {status?: Tag, body?: string} = {}) {\r\n        this.replySaving = true;\r\n\r\n        return this.tickets\r\n            .saveReply(this.model.id, this.draft.getPayload(params))\r\n            .pipe(\r\n                tap(response => {\r\n                    this.replySaving = false;\r\n                    this.draft.delete();\r\n                    this.performAfterReplyAction();\r\n                    this.setStatus(params.status);\r\n                    this.replies.add(response.data);\r\n                }, () => {\r\n                    this.toast.open('There was an issue submitting this reply.');\r\n                    this.replySaving = false;\r\n                    this.isLoading = false;\r\n                })\r\n            );\r\n    }\r\n\r\n    /**\r\n     * Perform after reply action and\r\n     * mark conversation as \"reloading\"\r\n     */\r\n    public performAfterReplyAction() {\r\n        if (this.afterReplyAction.get() && this.afterReplyAction.get() !== 'stay_on_page') {\r\n            this.isLoading = true;\r\n        }\r\n        this.afterReplyAction.perform();\r\n    }\r\n\r\n    /**\r\n     * Init or reset conversation.\r\n     */\r\n    public init(ticket: Ticket) {\r\n        if ( ! ticket) return;\r\n\r\n        this.model = ticket;\r\n        this.status = ticket.tags.find(tag => tag.type === 'status');\r\n        this.replies.init(this.model.replies, this.model.id);\r\n        this.draft.setTicketId(this.model.id);\r\n        this.afterReplyAction.setTicketId(this.model.id);\r\n        this.isLoading = false;\r\n        this.afterInit.emit();\r\n    }\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","import {Component, ViewEncapsulation, ChangeDetectionStrategy, Inject} from '@angular/core';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n\r\ninterface ShowOriginalReplyModalData {\r\n    original: {headers: any, body: {plain: string, html: string}};\r\n}\r\n\r\n@Component({\r\n    selector: 'show-original-reply-modal',\r\n    templateUrl: './show-original-reply-modal.component.html',\r\n    styleUrls: ['./show-original-reply-modal.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ShowOriginalReplyModalComponent {\r\n    public originalEmail: {headers: any, body: {plain: string, html: string}};\r\n    public headerNames: string[] = [];\r\n\r\n    constructor(\r\n        private dialogRef: MatDialogRef<ShowOriginalReplyModalComponent>,\r\n        @Inject(MAT_DIALOG_DATA) public data: ShowOriginalReplyModalData,\r\n    ) {\r\n        this.hydrate();\r\n    }\r\n\r\n    public close() {\r\n        this.dialogRef.close();\r\n    }\r\n\r\n    private hydrate() {\r\n        this.originalEmail = this.data.original;\r\n\r\n        if (this.originalEmail && this.originalEmail.headers) {\r\n            this.headerNames = Object.keys(this.originalEmail.headers);\r\n        }\r\n    }\r\n}\r\n\r\n","<div class=\"modal-header\">\r\n    <h2 mat-dialog-title trans>Original Message</h2>\r\n    <button type=\"button\" (click)=\"close()\" class=\"close-button\" mat-icon-button tabindex=\"-1\">\r\n        <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<mat-dialog-content>\r\n    <div class=\"headers\">\r\n        <div class=\"header\" *ngFor=\"let name of headerNames\">\r\n            <div class=\"name\">{{name}}</div>\r\n            <div class=\"value\">{{originalEmail.headers[name]}}</div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"email-content\">\r\n        <span *ngIf=\"!originalEmail\" trans>Could not find original email for this reply.</span>\r\n        <pre class=\"body-plain\" *ngIf=\"originalEmail && originalEmail.body.plain\">{{originalEmail.body.plain}}</pre>\r\n        <pre class=\"body-html\" *ngIf=\"originalEmail && originalEmail.body.html\">{{originalEmail.body.html}}</pre>\r\n    </div>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions>\r\n    <button type=\"submit\" class=\"submit-button\" mat-raised-button color=\"accent\" (click)=\"close()\" trans>Done</button>\r\n</mat-dialog-actions>","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nfunction canReportError(observer) {\n    while (observer) {\n        var _a = observer, closed_1 = _a.closed, destination = _a.destination, isStopped = _a.isStopped;\n        if (closed_1 || isStopped) {\n            return false;\n        }\n        else if (destination && destination instanceof Subscriber_1.Subscriber) {\n            observer = destination;\n        }\n        else {\n            observer = null;\n        }\n    }\n    return true;\n}\nexports.canReportError = canReportError;\n//# sourceMappingURL=canReportError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isArray_1 = require(\"./util/isArray\");\nvar isObject_1 = require(\"./util/isObject\");\nvar isFunction_1 = require(\"./util/isFunction\");\nvar UnsubscriptionError_1 = require(\"./util/UnsubscriptionError\");\nvar Subscription = (function () {\n    function Subscription(unsubscribe) {\n        this.closed = false;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parentOrParents = _a._parentOrParents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (_parentOrParents instanceof Subscription) {\n            _parentOrParents.remove(this);\n        }\n        else if (_parentOrParents !== null) {\n            for (var index = 0; index < _parentOrParents.length; ++index) {\n                var parent_1 = _parentOrParents[index];\n                parent_1.remove(this);\n            }\n        }\n        if (isFunction_1.isFunction(_unsubscribe)) {\n            try {\n                _unsubscribe.call(this);\n            }\n            catch (e) {\n                errors = e instanceof UnsubscriptionError_1.UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n            }\n        }\n        if (isArray_1.isArray(_subscriptions)) {\n            var index = -1;\n            var len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject_1.isObject(sub)) {\n                    try {\n                        sub.unsubscribe();\n                    }\n                    catch (e) {\n                        errors = errors || [];\n                        if (e instanceof UnsubscriptionError_1.UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n                        }\n                        else {\n                            errors.push(e);\n                        }\n                    }\n                }\n            }\n        }\n        if (errors) {\n            throw new UnsubscriptionError_1.UnsubscriptionError(errors);\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var subscription = teardown;\n        if (!teardown) {\n            return Subscription.EMPTY;\n        }\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (!(subscription instanceof Subscription)) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default: {\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n            }\n        }\n        var _parentOrParents = subscription._parentOrParents;\n        if (_parentOrParents === null) {\n            subscription._parentOrParents = this;\n        }\n        else if (_parentOrParents instanceof Subscription) {\n            if (_parentOrParents === this) {\n                return subscription;\n            }\n            subscription._parentOrParents = [_parentOrParents, this];\n        }\n        else if (_parentOrParents.indexOf(this) === -1) {\n            _parentOrParents.push(this);\n        }\n        else {\n            return subscription;\n        }\n        var subscriptions = this._subscriptions;\n        if (subscriptions === null) {\n            this._subscriptions = [subscription];\n        }\n        else {\n            subscriptions.push(subscription);\n        }\n        return subscription;\n    };\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexports.Subscription = Subscription;\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError_1.UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.observable = (function () { return typeof Symbol === 'function' && Symbol.observable || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar subscribeToArray_1 = require(\"../util/subscribeToArray\");\nvar scheduleArray_1 = require(\"../scheduled/scheduleArray\");\nfunction fromArray(input, scheduler) {\n    if (!scheduler) {\n        return new Observable_1.Observable(subscribeToArray_1.subscribeToArray(input));\n    }\n    else {\n        return scheduleArray_1.scheduleArray(input, scheduler);\n    }\n}\nexports.fromArray = fromArray;\n//# sourceMappingURL=fromArray.js.map"]}